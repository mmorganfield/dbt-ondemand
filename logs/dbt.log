2021-03-29 17:49:51.963467 (MainThread): Running with dbt=0.18.1
2021-03-29 17:49:52.118997 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-03-29 17:49:52.150486 (MainThread): Tracking: tracking
2021-03-29 17:49:52.153786 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d65193dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d65a15c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6519ad90>]}
2021-03-29 17:49:52.154123 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=15
2021-03-29 17:49:52.154571 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-03-29 17:49:52.154891 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-03-29 17:49:52.161980 (Thread-1): Parsing macros/adapters.sql
2021-03-29 17:49:52.192949 (Thread-1): Parsing macros/etc.sql
2021-03-29 17:49:52.194931 (Thread-1): Parsing macros/catalog.sql
2021-03-29 17:49:52.204682 (Thread-1): Parsing macros/materializations/copy.sql
2021-03-29 17:49:52.209967 (Thread-1): Parsing macros/materializations/table.sql
2021-03-29 17:49:52.219623 (Thread-1): Parsing macros/materializations/incremental.sql
2021-03-29 17:49:52.231769 (Thread-1): Parsing macros/materializations/seed.sql
2021-03-29 17:49:52.234428 (Thread-1): Parsing macros/materializations/snapshot.sql
2021-03-29 17:49:52.236185 (Thread-1): Parsing macros/materializations/view.sql
2021-03-29 17:49:52.239602 (Thread-1): Parsing macros/core.sql
2021-03-29 17:49:52.243095 (Thread-1): Parsing macros/materializations/helpers.sql
2021-03-29 17:49:52.251729 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-03-29 17:49:52.265150 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-29 17:49:52.266893 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-03-29 17:49:52.282700 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-29 17:49:52.310875 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-29 17:49:52.315787 (Thread-1): Parsing macros/materializations/view/view.sql
2021-03-29 17:49:52.321994 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-03-29 17:49:52.342309 (Thread-1): Parsing macros/materializations/table/table.sql
2021-03-29 17:49:52.348777 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-03-29 17:49:52.350593 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-03-29 17:49:52.356383 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-03-29 17:49:52.357948 (Thread-1): Parsing macros/etc/query.sql
2021-03-29 17:49:52.358988 (Thread-1): Parsing macros/etc/datetime.sql
2021-03-29 17:49:52.367614 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-03-29 17:49:52.368554 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-03-29 17:49:52.370175 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-03-29 17:49:52.372166 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-03-29 17:49:52.373693 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-03-29 17:49:52.376349 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-03-29 17:49:52.378169 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-03-29 17:49:52.379877 (Thread-1): Parsing macros/adapters/common.sql
2021-03-29 17:49:52.428577 (Thread-1): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - my_new_project

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-29 17:49:52.428959 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d65149e50>]}
2021-03-29 17:49:52.705580 (Thread-1): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 17:49:52.778038 (Thread-2): handling status request
2021-03-29 17:49:52.778707 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d645434c0>]}
2021-03-29 17:49:52.785856 (Thread-2): sending response (<Response 10409 bytes [200 OK]>) to 10.0.19.52
2021-03-29 17:50:14.526184 (Thread-3): Got an acceptable cached parse result
2021-03-29 17:50:14.687360 (Thread-3): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 17:50:14.918348 (Thread-4): handling status request
2021-03-29 17:50:14.918765 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d644ec670>]}
2021-03-29 17:50:14.919693 (Thread-4): sending response (<Response 875 bytes [200 OK]>) to 10.0.2.21
2021-03-29 17:50:20.375909 (Thread-5): Got an acceptable cached parse result
2021-03-29 17:50:20.557912 (Thread-5): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 17:50:20.765189 (Thread-6): handling status request
2021-03-29 17:50:20.765605 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d643b0e20>]}
2021-03-29 17:50:20.766532 (Thread-6): sending response (<Response 875 bytes [200 OK]>) to 10.0.44.172
2021-03-29 18:55:43.519379 (Thread-7): handling ps request
2021-03-29 18:55:43.519950 (Thread-7): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d644b8b80>]}
2021-03-29 18:55:43.522212 (Thread-7): sending response (<Response 105 bytes [200 OK]>) to 10.0.33.43
2021-03-29 18:55:43.528874 (Thread-8): handling status request
2021-03-29 18:55:43.529334 (Thread-8): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d65a55e20>]}
2021-03-29 18:55:43.530585 (Thread-8): sending response (<Response 875 bytes [200 OK]>) to 10.0.44.160
2021-03-29 20:00:31.194934 (Thread-9): handling status request
2021-03-29 20:00:31.196909 (Thread-9): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d65149d90>]}
2021-03-29 20:00:31.198331 (Thread-9): sending response (<Response 875 bytes [200 OK]>) to 10.0.7.56
2021-03-29 20:00:39.312105 (Thread-10): Parsing macros/adapters.sql
2021-03-29 20:00:39.330850 (Thread-10): Parsing macros/etc.sql
2021-03-29 20:00:39.332083 (Thread-10): Parsing macros/catalog.sql
2021-03-29 20:00:39.337857 (Thread-10): Parsing macros/materializations/copy.sql
2021-03-29 20:00:39.342035 (Thread-10): Parsing macros/materializations/table.sql
2021-03-29 20:00:39.351510 (Thread-10): Parsing macros/materializations/incremental.sql
2021-03-29 20:00:39.363398 (Thread-10): Parsing macros/materializations/seed.sql
2021-03-29 20:00:39.365961 (Thread-10): Parsing macros/materializations/snapshot.sql
2021-03-29 20:00:39.367704 (Thread-10): Parsing macros/materializations/view.sql
2021-03-29 20:00:39.371077 (Thread-10): Parsing macros/core.sql
2021-03-29 20:00:39.374897 (Thread-10): Parsing macros/materializations/helpers.sql
2021-03-29 20:00:39.386988 (Thread-10): Parsing macros/materializations/common/merge.sql
2021-03-29 20:00:39.406024 (Thread-10): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-29 20:00:39.408483 (Thread-10): Parsing macros/materializations/snapshot/strategies.sql
2021-03-29 20:00:39.426825 (Thread-10): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-29 20:00:39.463781 (Thread-10): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-29 20:00:39.468666 (Thread-10): Parsing macros/materializations/view/view.sql
2021-03-29 20:00:39.479044 (Thread-10): Parsing macros/materializations/seed/seed.sql
2021-03-29 20:00:39.502379 (Thread-10): Parsing macros/materializations/table/table.sql
2021-03-29 20:00:39.508749 (Thread-10): Parsing macros/materializations/incremental/helpers.sql
2021-03-29 20:00:39.510595 (Thread-10): Parsing macros/materializations/incremental/incremental.sql
2021-03-29 20:00:39.516395 (Thread-10): Parsing macros/etc/is_incremental.sql
2021-03-29 20:00:39.517934 (Thread-10): Parsing macros/etc/query.sql
2021-03-29 20:00:39.518970 (Thread-10): Parsing macros/etc/datetime.sql
2021-03-29 20:00:39.527673 (Thread-10): Parsing macros/etc/get_custom_alias.sql
2021-03-29 20:00:39.528590 (Thread-10): Parsing macros/etc/get_custom_database.sql
2021-03-29 20:00:39.530172 (Thread-10): Parsing macros/etc/get_custom_schema.sql
2021-03-29 20:00:39.532072 (Thread-10): Parsing macros/schema_tests/not_null.sql
2021-03-29 20:00:39.533552 (Thread-10): Parsing macros/schema_tests/accepted_values.sql
2021-03-29 20:00:39.536138 (Thread-10): Parsing macros/schema_tests/relationships.sql
2021-03-29 20:00:39.537942 (Thread-10): Parsing macros/schema_tests/unique.sql
2021-03-29 20:00:39.539660 (Thread-10): Parsing macros/adapters/common.sql
2021-03-29 20:00:39.651293 (Thread-11): handling status request
2021-03-29 20:00:39.652082 (Thread-11): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d640d7340>]}
2021-03-29 20:00:39.653304 (Thread-11): sending response (<Response 185 bytes [200 OK]>) to 10.0.5.67
2021-03-29 20:00:39.855327 (Thread-10): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 20:00:41.065297 (Thread-12): handling status request
2021-03-29 20:00:41.065919 (Thread-12): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d644143d0>]}
2021-03-29 20:00:41.069710 (Thread-12): sending response (<Response 9344 bytes [200 OK]>) to 10.0.45.82
2021-03-29 20:03:30.567059 (Thread-13): handling status request
2021-03-29 20:03:30.567493 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d64414850>]}
2021-03-29 20:03:30.571055 (Thread-13): sending response (<Response 9344 bytes [200 OK]>) to 10.0.46.32
2021-03-29 20:03:33.013997 (Thread-14): handling status request
2021-03-29 20:03:33.014491 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d644142b0>]}
2021-03-29 20:03:33.017983 (Thread-14): sending response (<Response 9344 bytes [200 OK]>) to 10.0.15.28
2021-03-29 20:03:41.134595 (Thread-15): Parsing macros/adapters.sql
2021-03-29 20:03:41.154087 (Thread-15): Parsing macros/etc.sql
2021-03-29 20:03:41.155398 (Thread-15): Parsing macros/catalog.sql
2021-03-29 20:03:41.161281 (Thread-15): Parsing macros/materializations/copy.sql
2021-03-29 20:03:41.166047 (Thread-15): Parsing macros/materializations/table.sql
2021-03-29 20:03:41.180823 (Thread-15): Parsing macros/materializations/incremental.sql
2021-03-29 20:03:41.201895 (Thread-15): Parsing macros/materializations/seed.sql
2021-03-29 20:03:41.206641 (Thread-15): Parsing macros/materializations/snapshot.sql
2021-03-29 20:03:41.209623 (Thread-15): Parsing macros/materializations/view.sql
2021-03-29 20:03:41.216566 (Thread-15): Parsing macros/core.sql
2021-03-29 20:03:41.222138 (Thread-15): Parsing macros/materializations/helpers.sql
2021-03-29 20:03:41.233411 (Thread-15): Parsing macros/materializations/common/merge.sql
2021-03-29 20:03:41.255373 (Thread-15): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-29 20:03:41.258492 (Thread-15): Parsing macros/materializations/snapshot/strategies.sql
2021-03-29 20:03:41.288853 (Thread-15): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-29 20:03:41.332740 (Thread-15): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-29 20:03:41.338125 (Thread-15): Parsing macros/materializations/view/view.sql
2021-03-29 20:03:41.345072 (Thread-15): Parsing macros/materializations/seed/seed.sql
2021-03-29 20:03:41.366889 (Thread-15): Parsing macros/materializations/table/table.sql
2021-03-29 20:03:41.374363 (Thread-15): Parsing macros/materializations/incremental/helpers.sql
2021-03-29 20:03:41.376435 (Thread-15): Parsing macros/materializations/incremental/incremental.sql
2021-03-29 20:03:41.384462 (Thread-15): Parsing macros/etc/is_incremental.sql
2021-03-29 20:03:41.386615 (Thread-15): Parsing macros/etc/query.sql
2021-03-29 20:03:41.388239 (Thread-15): Parsing macros/etc/datetime.sql
2021-03-29 20:03:41.399654 (Thread-15): Parsing macros/etc/get_custom_alias.sql
2021-03-29 20:03:41.400862 (Thread-15): Parsing macros/etc/get_custom_database.sql
2021-03-29 20:03:41.403520 (Thread-15): Parsing macros/etc/get_custom_schema.sql
2021-03-29 20:03:41.405965 (Thread-15): Parsing macros/schema_tests/not_null.sql
2021-03-29 20:03:41.407576 (Thread-15): Parsing macros/schema_tests/accepted_values.sql
2021-03-29 20:03:41.410322 (Thread-15): Parsing macros/schema_tests/relationships.sql
2021-03-29 20:03:41.412288 (Thread-15): Parsing macros/schema_tests/unique.sql
2021-03-29 20:03:41.414048 (Thread-15): Parsing macros/adapters/common.sql
2021-03-29 20:03:41.667160 (Thread-15): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 20:03:42.313942 (Thread-16): handling status request
2021-03-29 20:03:42.314429 (Thread-16): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6446fa90>]}
2021-03-29 20:03:42.317548 (Thread-16): sending response (<Response 9344 bytes [200 OK]>) to 10.0.17.68
2021-03-29 20:56:16.089947 (Thread-17): handling status request
2021-03-29 20:56:16.092079 (Thread-17): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6446fb80>]}
2021-03-29 20:56:16.096982 (Thread-17): sending response (<Response 9344 bytes [200 OK]>) to 10.0.12.103
2021-03-29 20:56:16.714496 (Thread-18): handling status request
2021-03-29 20:56:16.714931 (Thread-18): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d64293970>]}
2021-03-29 20:56:16.717948 (Thread-18): sending response (<Response 9344 bytes [200 OK]>) to 10.0.28.2
2021-03-29 20:56:17.186989 (Thread-19): handling cli_args request
2021-03-29 20:56:17.187427 (Thread-19): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d642934f0>]}
2021-03-29 20:56:18.030980 (Thread-19): sending response (<Response 138 bytes [200 OK]>) to 10.0.20.97
2021-03-29 20:56:18.079700 (MainThread): Partial parsing not enabled
2021-03-29 20:56:18.080875 (MainThread): Parsing macros/adapters.sql
2021-03-29 20:56:18.102657 (MainThread): Parsing macros/etc.sql
2021-03-29 20:56:18.104005 (MainThread): Parsing macros/catalog.sql
2021-03-29 20:56:18.109859 (MainThread): Parsing macros/materializations/copy.sql
2021-03-29 20:56:18.141846 (MainThread): Parsing macros/materializations/table.sql
2021-03-29 20:56:18.151543 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-29 20:56:18.163758 (MainThread): Parsing macros/materializations/seed.sql
2021-03-29 20:56:18.166408 (MainThread): Parsing macros/materializations/snapshot.sql
2021-03-29 20:56:18.168193 (MainThread): Parsing macros/materializations/view.sql
2021-03-29 20:56:18.171706 (MainThread): Parsing macros/core.sql
2021-03-29 20:56:18.175537 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-29 20:56:18.184306 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-29 20:56:18.198328 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-29 20:56:18.200124 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-29 20:56:18.215992 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-29 20:56:18.245719 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-29 20:56:18.250699 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-29 20:56:18.256813 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-29 20:56:18.277212 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-29 20:56:18.283806 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-29 20:56:18.285669 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-29 20:56:18.291761 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-29 20:56:18.293379 (MainThread): Parsing macros/etc/query.sql
2021-03-29 20:56:18.294496 (MainThread): Parsing macros/etc/datetime.sql
2021-03-29 20:56:18.303096 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-29 20:56:18.304092 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-29 20:56:18.305839 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-29 20:56:18.307847 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-29 20:56:18.309417 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-29 20:56:18.312148 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-29 20:56:18.314529 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-29 20:56:18.317086 (MainThread): Parsing macros/adapters/common.sql
2021-03-29 20:56:18.369793 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - my_new_project

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-29 20:56:18.369923 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '11ce2376-64e0-45f5-af96-539680a51624', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe259767b20>]}
2021-03-29 20:56:18.372687 (MainThread): Partial parsing not enabled
2021-03-29 20:56:18.470468 (Thread-20): handling poll request
2021-03-29 20:56:18.470931 (Thread-20): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d64060610>]}
2021-03-29 20:56:18.476499 (Thread-20): sending response (<Response 10714 bytes [200 OK]>) to 10.0.17.36
2021-03-29 20:56:18.539210 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 20:56:18.555911 (MainThread): Found 0 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-29 20:56:18.556293 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-03-29 20:56:19.905899 (Thread-21): handling poll request
2021-03-29 20:56:19.906373 (Thread-21): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d64060fa0>]}
2021-03-29 20:56:19.907679 (Thread-21): sending response (<Response 1483 bytes [200 OK]>) to 10.0.12.103
2021-03-29 20:56:20.322666 (Thread-22): handling status request
2021-03-29 20:56:20.323098 (Thread-22): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d64060e80>]}
2021-03-29 20:56:20.326254 (Thread-22): sending response (<Response 9344 bytes [200 OK]>) to 10.0.17.36
2021-03-29 20:56:54.831282 (Thread-23): handling status request
2021-03-29 20:56:54.831718 (Thread-23): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d64296a60>]}
2021-03-29 20:56:54.834721 (Thread-23): sending response (<Response 9344 bytes [200 OK]>) to 10.0.41.231
2021-03-29 21:00:21.712544 (Thread-24): Got an acceptable cached parse result
2021-03-29 21:00:21.890135 (Thread-24): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 21:00:22.048501 (Thread-25): handling status request
2021-03-29 21:00:22.049136 (Thread-25): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d646db520>]}
2021-03-29 21:00:22.050572 (Thread-25): sending response (<Response 877 bytes [200 OK]>) to 10.0.12.103
2021-03-29 21:00:33.642563 (Thread-26): Got an acceptable cached parse result
2021-03-29 21:00:33.685627 (Thread-26): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-03-29 21:00:33.974925 (Thread-26): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 21:00:34.041037 (Thread-27): handling status request
2021-03-29 21:00:34.041473 (Thread-27): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d646faa30>]}
2021-03-29 21:00:34.042499 (Thread-27): sending response (<Response 1181 bytes [200 OK]>) to 10.0.33.179
2021-03-29 21:01:47.525380 (Thread-28): handling status request
2021-03-29 21:01:47.525999 (Thread-28): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d64055580>]}
2021-03-29 21:01:47.527568 (Thread-28): sending response (<Response 1181 bytes [200 OK]>) to 10.0.44.102
2021-03-29 21:01:48.116917 (Thread-29): handling run_sql request
2021-03-29 21:01:48.117367 (Thread-29): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d640552b0>]}
2021-03-29 21:01:48.119617 (Thread-29): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-03-29 21:01:49.306310 (Thread-29): sending response (<Response 138 bytes [200 OK]>) to 10.0.12.103
2021-03-29 21:01:49.336982 (MainThread): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-03-29 21:01:49.362654 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-29 21:01:49.363299 (Thread-1): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-03-29 21:01:49.363461 (Thread-1): Compiling rpc.my_new_project.request
2021-03-29 21:01:49.446955 (Thread-1): finished collecting timing info
2021-03-29 21:01:49.447414 (Thread-1): Opening a new connection, currently in state init
2021-03-29 21:01:49.448153 (Thread-1): On rpc.my_new_project.request: with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-29 21:01:49.875720 (Thread-30): handling poll request
2021-03-29 21:01:49.876395 (Thread-30): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d64711eb0>]}
2021-03-29 21:01:49.879303 (Thread-30): sending response (<Response 3548 bytes [200 OK]>) to 10.0.7.19
2021-03-29 21:01:50.165788 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('The project raw has not enabled BigQuery.')
2021-03-29 21:01:51.278927 (Thread-1): finished collecting timing info
2021-03-29 21:01:51.279507 (Thread-1): Got an exception: Database Error
  The project raw has not enabled BigQuery.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 The project raw has not enabled BigQuery.

(job ID: fb49953b-29ef-4481-a99b-f07165128c67)

                       -----Query Job SQL Follows-----                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with customers as (
   2:
   3:    select
   4:        id as customer_id,
   5:        first_name,
   6:        last_name
   7:
   8:    from raw.jaffle_shop.customers
   9:
  10:),
  11:
  12:orders as (
  13:
  14:    select
  15:        id as order_id,
  16:        user_id as customer_id,
  17:        order_date,
  18:        status
  19:
  20:    from raw.jaffle_shop.orders
  21:
  22:),
  23:
  24:customer_orders as (
  25:
  26:    select
  27:        customer_id,
  28:
  29:        min(order_date) as first_order_date,
  30:        max(order_date) as most_recent_order_date,
  31:        count(order_id) as number_of_orders
  32:
  33:    from orders
  34:
  35:    group by 1
  36:
  37:),
  38:
  39:
  40:final as (
  41:
  42:    select
  43:        customers.customer_id,
  44:        customers.first_name,
  45:        customers.last_name,
  46:        customer_orders.first_order_date,
  47:        customer_orders.most_recent_order_date,
  48:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  49:
  50:    from customers
  51:
  52:    left join customer_orders using (customer_id)
  53:
  54:)
  55:
  56:select * from final
  57:limit 500
  58:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  The project raw has not enabled BigQuery.
2021-03-29 21:01:51.282872 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  The project raw has not enabled BigQuery.', 'raw_sql': 'with customers as (\n\n    select\n        id as customer_id,\n        first_name,\n        last_name\n\n    from raw.jaffle_shop.customers\n\n),\n\norders as (\n\n    select\n        id as order_id,\n        user_id as customer_id,\n        order_date,\n        status\n\n    from raw.jaffle_shop.orders\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n\n    from customers\n\n    left join customer_orders using (customer_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': 'with customers as (\n\n    select\n        id as customer_id,\n        first_name,\n        last_name\n\n    from raw.jaffle_shop.customers\n\n),\n\norders as (\n\n    select\n        id as order_id,\n        user_id as customer_id,\n        order_date,\n        status\n\n    from raw.jaffle_shop.orders\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n\n    from customers\n\n    left join customer_orders using (customer_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  The project raw has not enabled BigQuery.', 'raw_sql': 'with customers as (\n\n    select\n        id as customer_id,\n        first_name,\n        last_name\n\n    from raw.jaffle_shop.customers\n\n),\n\norders as (\n\n    select\n        id as order_id,\n        user_id as customer_id,\n        order_date,\n        status\n\n    from raw.jaffle_shop.orders\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n\n    from customers\n\n    left join customer_orders using (customer_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': 'with customers as (\n\n    select\n        id as customer_id,\n        first_name,\n        last_name\n\n    from raw.jaffle_shop.customers\n\n),\n\norders as (\n\n    select\n        id as order_id,\n        user_id as customer_id,\n        order_date,\n        status\n\n    from raw.jaffle_shop.orders\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n\n    from customers\n\n    left join customer_orders using (customer_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-29 21:01:51.497544 (Thread-31): handling poll request
2021-03-29 21:01:51.498161 (Thread-31): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d647119d0>]}
2021-03-29 21:01:51.500928 (Thread-31): sending response (<Response 11661 bytes [200 OK]>) to 10.0.20.97
2021-03-29 21:01:53.151443 (Thread-32): handling poll request
2021-03-29 21:01:53.152042 (Thread-32): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d642896d0>]}
2021-03-29 21:01:53.153312 (Thread-32): sending response (<Response 16806 bytes [200 OK]>) to 10.0.47.191
2021-03-29 21:02:48.222050 (Thread-33): handling status request
2021-03-29 21:02:48.222617 (Thread-33): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d646fa580>]}
2021-03-29 21:02:48.223630 (Thread-33): sending response (<Response 1181 bytes [200 OK]>) to 10.0.33.179
2021-03-29 21:02:48.320565 (Thread-34): handling status request
2021-03-29 21:02:48.321188 (Thread-34): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d64649e50>]}
2021-03-29 21:02:48.359963 (Thread-34): sending response (<Response 1181 bytes [200 OK]>) to 10.0.44.102
2021-03-29 21:02:48.752791 (Thread-35): handling cli_args request
2021-03-29 21:02:48.753246 (Thread-35): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6405f940>]}
2021-03-29 21:02:49.739279 (Thread-35): sending response (<Response 138 bytes [200 OK]>) to 10.0.22.169
2021-03-29 21:02:49.803444 (MainThread): Partial parsing not enabled
2021-03-29 21:02:49.804890 (MainThread): Parsing macros/adapters.sql
2021-03-29 21:02:49.829772 (MainThread): Parsing macros/etc.sql
2021-03-29 21:02:49.832045 (MainThread): Parsing macros/catalog.sql
2021-03-29 21:02:49.839800 (MainThread): Parsing macros/materializations/copy.sql
2021-03-29 21:02:49.882606 (MainThread): Parsing macros/materializations/table.sql
2021-03-29 21:02:49.898286 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-29 21:02:49.915033 (MainThread): Parsing macros/materializations/seed.sql
2021-03-29 21:02:49.917972 (MainThread): Parsing macros/materializations/snapshot.sql
2021-03-29 21:02:49.920049 (MainThread): Parsing macros/materializations/view.sql
2021-03-29 21:02:49.923602 (MainThread): Parsing macros/core.sql
2021-03-29 21:02:49.928661 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-29 21:02:49.937576 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-29 21:02:49.951567 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-29 21:02:49.953371 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-29 21:02:49.969408 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-29 21:02:49.998519 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-29 21:02:50.004209 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-29 21:02:50.010469 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-29 21:02:50.030995 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-29 21:02:50.037739 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-29 21:02:50.039685 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-29 21:02:50.045705 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-29 21:02:50.047384 (MainThread): Parsing macros/etc/query.sql
2021-03-29 21:02:50.048519 (MainThread): Parsing macros/etc/datetime.sql
2021-03-29 21:02:50.057474 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-29 21:02:50.058509 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-29 21:02:50.060220 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-29 21:02:50.062207 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-29 21:02:50.063794 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-29 21:02:50.066561 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-29 21:02:50.068563 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-29 21:02:50.070473 (MainThread): Parsing macros/adapters/common.sql
2021-03-29 21:02:50.120946 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - my_new_project

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-29 21:02:50.121086 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '516950b6-2826-4fd9-baff-9784253c08e2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5cb6f04c0>]}
2021-03-29 21:02:50.123981 (MainThread): Partial parsing not enabled
2021-03-29 21:02:50.168750 (Thread-36): handling poll request
2021-03-29 21:02:50.169363 (Thread-36): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6453c040>]}
2021-03-29 21:02:50.175766 (Thread-36): sending response (<Response 10714 bytes [200 OK]>) to 10.0.22.208
2021-03-29 21:02:50.167222 (MainThread): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-03-29 21:02:50.333773 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 21:02:50.352487 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-29 21:02:50.353157 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-03-29 21:02:51.771871 (Thread-37): handling poll request
2021-03-29 21:02:51.772497 (Thread-37): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6453c250>]}
2021-03-29 21:02:51.774506 (Thread-37): sending response (<Response 1788 bytes [200 OK]>) to 10.0.47.191
2021-03-29 21:02:52.746826 (Thread-38): handling status request
2021-03-29 21:02:52.747271 (Thread-38): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6453cdf0>]}
2021-03-29 21:02:52.748339 (Thread-38): sending response (<Response 1181 bytes [200 OK]>) to 10.0.28.2
2021-03-29 21:03:16.135767 (Thread-39): Got an acceptable cached parse result
2021-03-29 21:03:16.169090 (Thread-39): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-03-29 21:03:16.339464 (Thread-39): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 21:03:16.640699 (Thread-40): handling status request
2021-03-29 21:03:16.641123 (Thread-40): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d5f7e7f70>]}
2021-03-29 21:03:16.642112 (Thread-40): sending response (<Response 1181 bytes [200 OK]>) to 10.0.19.42
2021-03-29 21:03:18.990983 (Thread-41): handling status request
2021-03-29 21:03:18.991450 (Thread-41): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d642e18e0>]}
2021-03-29 21:03:18.992473 (Thread-41): sending response (<Response 1181 bytes [200 OK]>) to 10.0.7.19
2021-03-29 21:03:19.146886 (Thread-42): handling status request
2021-03-29 21:03:19.147320 (Thread-42): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d643303d0>]}
2021-03-29 21:03:19.148286 (Thread-42): sending response (<Response 1181 bytes [200 OK]>) to 10.0.33.179
2021-03-29 21:03:19.741983 (Thread-43): handling cli_args request
2021-03-29 21:03:19.742447 (Thread-43): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d64060760>]}
2021-03-29 21:03:19.751341 (Thread-43): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-03-29 21:03:20.608870 (Thread-43): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.231
2021-03-29 21:03:20.659919 (MainThread): Partial parsing not enabled
2021-03-29 21:03:20.661448 (MainThread): Parsing macros/adapters.sql
2021-03-29 21:03:20.684355 (MainThread): Parsing macros/etc.sql
2021-03-29 21:03:20.685788 (MainThread): Parsing macros/catalog.sql
2021-03-29 21:03:20.691788 (MainThread): Parsing macros/materializations/copy.sql
2021-03-29 21:03:20.733085 (MainThread): Parsing macros/materializations/table.sql
2021-03-29 21:03:20.743207 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-29 21:03:20.755833 (MainThread): Parsing macros/materializations/seed.sql
2021-03-29 21:03:20.758659 (MainThread): Parsing macros/materializations/snapshot.sql
2021-03-29 21:03:20.760518 (MainThread): Parsing macros/materializations/view.sql
2021-03-29 21:03:20.764030 (MainThread): Parsing macros/core.sql
2021-03-29 21:03:20.767621 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-29 21:03:20.778121 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-29 21:03:20.792840 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-29 21:03:20.794693 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-29 21:03:20.810836 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-29 21:03:20.838683 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-29 21:03:20.843699 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-29 21:03:20.849959 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-29 21:03:20.871191 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-29 21:03:20.878923 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-29 21:03:20.880969 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-29 21:03:20.887195 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-29 21:03:20.888932 (MainThread): Parsing macros/etc/query.sql
2021-03-29 21:03:20.890160 (MainThread): Parsing macros/etc/datetime.sql
2021-03-29 21:03:20.899057 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-29 21:03:20.900053 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-29 21:03:20.901715 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-29 21:03:20.903877 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-29 21:03:20.905407 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-29 21:03:20.908074 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-29 21:03:20.909957 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-29 21:03:20.911729 (MainThread): Parsing macros/adapters/common.sql
2021-03-29 21:03:20.959329 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - my_new_project

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-29 21:03:20.959466 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd4373797-f8ae-4791-9774-7c52f6eb6288', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e137b34f0>]}
2021-03-29 21:03:20.962072 (MainThread): Partial parsing not enabled
2021-03-29 21:03:21.003942 (MainThread): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-03-29 21:03:21.236794 (Thread-44): handling poll request
2021-03-29 21:03:21.237443 (Thread-44): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d64056af0>]}
2021-03-29 21:03:21.243761 (Thread-44): sending response (<Response 11019 bytes [200 OK]>) to 10.0.3.197
2021-03-29 21:03:21.238444 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 21:03:21.257440 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-29 21:03:21.258032 (MainThread): 
2021-03-29 21:03:21.258390 (MainThread): Acquiring new bigquery connection "master".
2021-03-29 21:03:21.260028 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome".
2021-03-29 21:03:21.260148 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-29 21:03:21.458677 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome_maxm".
2021-03-29 21:03:21.458831 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-29 21:03:21.653934 (MainThread): 21:03:21 | Concurrency: 1 threads (target='default')
2021-03-29 21:03:21.654062 (MainThread): 21:03:21 | 
2021-03-29 21:03:21.656023 (Thread-1): Began running node model.my_new_project.dim_customers
2021-03-29 21:03:21.657009 (Thread-1): 21:03:21 | 1 of 1 START table model maxm.dim_customers.......................... [RUN]
2021-03-29 21:03:21.657242 (Thread-1): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-03-29 21:03:21.657318 (Thread-1): Compiling model.my_new_project.dim_customers
2021-03-29 21:03:21.671728 (Thread-1): Writing injected SQL for node "model.my_new_project.dim_customers"
2021-03-29 21:03:21.702951 (Thread-1): finished collecting timing info
2021-03-29 21:03:21.741023 (Thread-1): Writing runtime SQL for node "model.my_new_project.dim_customers"
2021-03-29 21:03:21.781300 (Thread-1): Opening a new connection, currently in state closed
2021-03-29 21:03:21.781862 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.dim_customers"} */


  create or replace table `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final


  );
    
2021-03-29 21:03:22.361249 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('The project raw has not enabled BigQuery.')
2021-03-29 21:03:22.706383 (Thread-45): handling poll request
2021-03-29 21:03:22.706881 (Thread-45): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d644cf040>]}
2021-03-29 21:03:22.709304 (Thread-45): sending response (<Response 8515 bytes [200 OK]>) to 10.0.22.208
2021-03-29 21:03:23.236742 (Thread-1): finished collecting timing info
2021-03-29 21:03:23.237270 (Thread-1): Database Error in model dim_customers (models/dim_customers.sql)
  The project raw has not enabled BigQuery.
  compiled SQL at target/run/my_new_project/models/dim_customers.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 The project raw has not enabled BigQuery.

(job ID: d22e739d-797e-4c2a-8722-4162a3ed3eec)

                                                           -----Query Job SQL Follows-----                                                           

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.dim_customers"} */
   2:
   3:
   4:  create or replace table `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with customers as (
  10:
  11:    select
  12:        id as customer_id,
  13:        first_name,
  14:        last_name
  15:
  16:    from raw.jaffle_shop.customers
  17:
  18:),
  19:
  20:orders as (
  21:
  22:    select
  23:        id as order_id,
  24:        user_id as customer_id,
  25:        order_date,
  26:        status
  27:
  28:    from raw.jaffle_shop.orders
  29:
  30:),
  31:
  32:customer_orders as (
  33:
  34:    select
  35:        customer_id,
  36:
  37:        min(order_date) as first_order_date,
  38:        max(order_date) as most_recent_order_date,
  39:        count(order_id) as number_of_orders
  40:
  41:    from orders
  42:
  43:    group by 1
  44:
  45:),
  46:
  47:
  48:final as (
  49:
  50:    select
  51:        customers.customer_id,
  52:        customers.first_name,
  53:        customers.last_name,
  54:        customer_orders.first_order_date,
  55:        customer_orders.most_recent_order_date,
  56:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  57:
  58:    from customers
  59:
  60:    left join customer_orders using (customer_id)
  61:
  62:)
  63:
  64:select * from final
  65:
  66:
  67:  );
  68:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_customers (models/dim_customers.sql)
  The project raw has not enabled BigQuery.
  compiled SQL at target/run/my_new_project/models/dim_customers.sql
2021-03-29 21:03:23.239721 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4373797-f8ae-4791-9774-7c52f6eb6288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1364c490>]}
2021-03-29 21:03:23.240826 (Thread-1): 21:03:23 | 1 of 1 ERROR creating table model maxm.dim_customers................. [ERROR in 1.58s]
2021-03-29 21:03:23.240912 (Thread-1): Finished running node model.my_new_project.dim_customers
2021-03-29 21:03:23.242329 (MainThread): Acquiring new bigquery connection "master".
2021-03-29 21:03:23.242574 (MainThread): 21:03:23 | 
2021-03-29 21:03:23.242634 (MainThread): 21:03:23 | Finished running 1 table model in 1.98s.
2021-03-29 21:03:23.242681 (MainThread): Connection 'master' was properly closed.
2021-03-29 21:03:23.242720 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-03-29 21:03:23.264424 (MainThread): 
2021-03-29 21:03:23.264588 (MainThread): Completed with 1 error and 0 warnings:
2021-03-29 21:03:23.264646 (MainThread): 
2021-03-29 21:03:23.264701 (MainThread): Database Error in model dim_customers (models/dim_customers.sql)
2021-03-29 21:03:23.264744 (MainThread):   The project raw has not enabled BigQuery.
2021-03-29 21:03:23.264784 (MainThread):   compiled SQL at target/run/my_new_project/models/dim_customers.sql
2021-03-29 21:03:23.264829 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-03-29 21:03:24.719707 (Thread-46): handling poll request
2021-03-29 21:03:24.720142 (Thread-46): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d644cffa0>]}
2021-03-29 21:03:24.725350 (Thread-46): sending response (<Response 18684 bytes [200 OK]>) to 10.0.41.231
2021-03-29 21:03:25.267279 (Thread-47): handling status request
2021-03-29 21:03:25.267780 (Thread-47): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'f1a4e35c-2213-4d73-9f34-ae334d6c4433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d644cf1f0>]}
2021-03-29 21:03:25.268816 (Thread-47): sending response (<Response 1181 bytes [200 OK]>) to 10.0.7.19
2021-03-29 21:13:51.822061 (MainThread): Running with dbt=0.18.1
2021-03-29 21:13:52.006276 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-03-29 21:13:52.020547 (MainThread): Tracking: tracking
2021-03-29 21:13:52.042906 (Thread-1): Parsing macros/adapters.sql
2021-03-29 21:13:52.063714 (Thread-1): Parsing macros/etc.sql
2021-03-29 21:13:52.065242 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89894f3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89819d7a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89819edcd0>]}
2021-03-29 21:13:52.065662 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=15
2021-03-29 21:13:52.065836 (Thread-1): Parsing macros/catalog.sql
2021-03-29 21:13:52.066229 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-03-29 21:13:52.076364 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-03-29 21:13:52.076780 (Thread-1): Parsing macros/materializations/copy.sql
2021-03-29 21:13:52.081678 (Thread-1): Parsing macros/materializations/table.sql
2021-03-29 21:13:52.098382 (Thread-1): Parsing macros/materializations/incremental.sql
2021-03-29 21:13:52.116540 (Thread-1): Parsing macros/materializations/seed.sql
2021-03-29 21:13:52.119297 (Thread-1): Parsing macros/materializations/snapshot.sql
2021-03-29 21:13:52.121176 (Thread-1): Parsing macros/materializations/view.sql
2021-03-29 21:13:52.124689 (Thread-1): Parsing macros/core.sql
2021-03-29 21:13:52.128252 (Thread-1): Parsing macros/materializations/helpers.sql
2021-03-29 21:13:52.137222 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-03-29 21:13:52.150955 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-29 21:13:52.152778 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-03-29 21:13:52.172286 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-29 21:13:52.201512 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-29 21:13:52.206476 (Thread-1): Parsing macros/materializations/view/view.sql
2021-03-29 21:13:52.212631 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-03-29 21:13:52.232753 (Thread-1): Parsing macros/materializations/table/table.sql
2021-03-29 21:13:52.239297 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-03-29 21:13:52.241166 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-03-29 21:13:52.247088 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-03-29 21:13:52.248719 (Thread-1): Parsing macros/etc/query.sql
2021-03-29 21:13:52.249781 (Thread-1): Parsing macros/etc/datetime.sql
2021-03-29 21:13:52.258772 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-03-29 21:13:52.259714 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-03-29 21:13:52.261357 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-03-29 21:13:52.263295 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-03-29 21:13:52.264823 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-03-29 21:13:52.267455 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-03-29 21:13:52.269365 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-03-29 21:13:52.271102 (Thread-1): Parsing macros/adapters/common.sql
2021-03-29 21:13:52.319227 (Thread-1): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - my_new_project

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-29 21:13:52.319594 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bca1d314-41c3-421e-a269-26efb36b974f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8981a3daf0>]}
2021-03-29 21:13:52.365732 (Thread-1): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-03-29 21:13:52.550025 (Thread-2): handling status request
2021-03-29 21:13:52.557525 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'bca1d314-41c3-421e-a269-26efb36b974f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8980df2b80>]}
2021-03-29 21:13:52.559130 (Thread-2): sending response (<Response 185 bytes [200 OK]>) to 10.0.9.250
2021-03-29 21:13:52.623775 (Thread-1): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 21:13:54.023509 (Thread-3): handling status request
2021-03-29 21:13:54.023936 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'bca1d314-41c3-421e-a269-26efb36b974f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89819d73d0>]}
2021-03-29 21:13:54.027341 (Thread-3): sending response (<Response 10670 bytes [200 OK]>) to 10.0.9.250
2021-03-29 21:14:56.902751 (Thread-4): handling status request
2021-03-29 21:14:56.904787 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'bca1d314-41c3-421e-a269-26efb36b974f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8980fc1c10>]}
2021-03-29 21:14:56.908199 (Thread-4): sending response (<Response 10670 bytes [200 OK]>) to 10.0.1.13
2021-03-29 21:14:56.928944 (Thread-5): handling status request
2021-03-29 21:14:56.929320 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'bca1d314-41c3-421e-a269-26efb36b974f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8980eae0a0>]}
2021-03-29 21:14:56.932883 (Thread-5): sending response (<Response 10670 bytes [200 OK]>) to 10.0.42.133
2021-03-29 21:14:57.425658 (Thread-6): handling cli_args request
2021-03-29 21:14:57.426072 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'bca1d314-41c3-421e-a269-26efb36b974f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8980ea26a0>]}
2021-03-29 21:14:57.438317 (Thread-6): sending response (<Response 307 bytes [200 OK]>) to 10.0.19.42
2021-03-29 21:15:04.759474 (Thread-7): handling status request
2021-03-29 21:15:04.759895 (Thread-7): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'bca1d314-41c3-421e-a269-26efb36b974f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8980ee2f70>]}
2021-03-29 21:15:04.763269 (Thread-7): sending response (<Response 10670 bytes [200 OK]>) to 10.0.22.169
2021-03-29 21:23:22.824491 (MainThread): Running with dbt=0.18.1
2021-03-29 21:23:22.982444 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-03-29 21:23:22.995020 (MainThread): Tracking: tracking
2021-03-29 21:23:23.021030 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c7458e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c74f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c773ac0>]}
2021-03-29 21:23:23.021391 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=15
2021-03-29 21:23:23.021733 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-03-29 21:23:23.022603 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-03-29 21:23:23.024652 (Thread-1): Parsing macros/adapters.sql
2021-03-29 21:23:23.044309 (Thread-1): Parsing macros/etc.sql
2021-03-29 21:23:23.045597 (Thread-1): Parsing macros/catalog.sql
2021-03-29 21:23:23.051491 (Thread-1): Parsing macros/materializations/copy.sql
2021-03-29 21:23:23.055922 (Thread-1): Parsing macros/materializations/table.sql
2021-03-29 21:23:23.065725 (Thread-1): Parsing macros/materializations/incremental.sql
2021-03-29 21:23:23.078774 (Thread-1): Parsing macros/materializations/seed.sql
2021-03-29 21:23:23.081513 (Thread-1): Parsing macros/materializations/snapshot.sql
2021-03-29 21:23:23.083387 (Thread-1): Parsing macros/materializations/view.sql
2021-03-29 21:23:23.088430 (Thread-1): Parsing macros/core.sql
2021-03-29 21:23:23.092602 (Thread-1): Parsing macros/materializations/helpers.sql
2021-03-29 21:23:23.101845 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-03-29 21:23:23.115943 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-29 21:23:23.117809 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-03-29 21:23:23.134022 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-29 21:23:23.162482 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-29 21:23:23.167346 (Thread-1): Parsing macros/materializations/view/view.sql
2021-03-29 21:23:23.173478 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-03-29 21:23:23.194736 (Thread-1): Parsing macros/materializations/table/table.sql
2021-03-29 21:23:23.201236 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-03-29 21:23:23.203047 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-03-29 21:23:23.208906 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-03-29 21:23:23.210493 (Thread-1): Parsing macros/etc/query.sql
2021-03-29 21:23:23.211561 (Thread-1): Parsing macros/etc/datetime.sql
2021-03-29 21:23:23.220175 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-03-29 21:23:23.221134 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-03-29 21:23:23.222766 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-03-29 21:23:23.224736 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-03-29 21:23:23.226237 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-03-29 21:23:23.228888 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-03-29 21:23:23.230752 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-03-29 21:23:23.232504 (Thread-1): Parsing macros/adapters/common.sql
2021-03-29 21:23:23.280878 (Thread-1): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - my_new_project

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-29 21:23:23.281251 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c5075b0>]}
2021-03-29 21:23:23.328101 (Thread-1): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-03-29 21:23:23.506898 (Thread-2): handling status request
2021-03-29 21:23:23.517536 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c4f8460>]}
2021-03-29 21:23:23.519640 (Thread-2): sending response (<Response 185 bytes [200 OK]>) to 10.0.17.36
2021-03-29 21:23:23.584563 (Thread-1): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 21:23:25.020536 (Thread-3): handling status request
2021-03-29 21:23:25.020980 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406d3945e0>]}
2021-03-29 21:23:25.024420 (Thread-3): sending response (<Response 10712 bytes [200 OK]>) to 10.0.4.203
2021-03-29 21:23:46.953664 (Thread-4): handling status request
2021-03-29 21:23:46.955654 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406d394730>]}
2021-03-29 21:23:46.958967 (Thread-4): sending response (<Response 10712 bytes [200 OK]>) to 10.0.22.169
2021-03-29 21:23:47.361094 (Thread-5): handling run_sql request
2021-03-29 21:23:47.361514 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c442d30>]}
2021-03-29 21:23:47.364331 (Thread-5): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-03-29 21:23:48.196243 (Thread-5): sending response (<Response 138 bytes [200 OK]>) to 10.0.28.2
2021-03-29 21:23:48.213026 (MainThread): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-03-29 21:23:48.229398 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-29 21:23:48.229859 (Thread-1): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-03-29 21:23:48.229961 (Thread-1): Compiling rpc.my_new_project.request
2021-03-29 21:23:48.278016 (Thread-1): finished collecting timing info
2021-03-29 21:23:48.278267 (Thread-1): Opening a new connection, currently in state init
2021-03-29 21:23:48.278651 (Thread-1): On rpc.my_new_project.request: create or replace table `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final


  )
limit 500
/* limit added automatically by dbt cloud */
2021-03-29 21:23:48.658437 (Thread-6): handling poll request
2021-03-29 21:23:48.659060 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c44e4f0>]}
2021-03-29 21:23:48.663354 (Thread-6): sending response (<Response 3688 bytes [200 OK]>) to 10.0.47.191
2021-03-29 21:23:48.857492 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('The project raw has not enabled BigQuery.')
2021-03-29 21:23:49.920887 (Thread-1): finished collecting timing info
2021-03-29 21:23:49.921221 (Thread-1): Got an exception: Database Error
  The project raw has not enabled BigQuery.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 The project raw has not enabled BigQuery.

(job ID: 97033798-5ace-42c6-90cf-f7c8ebf19c7c)

                         -----Query Job SQL Follows-----                          

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:create or replace table `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers`
   2:  
   3:  
   4:  OPTIONS()
   5:  as (
   6:    with customers as (
   7:
   8:    select
   9:        id as customer_id,
  10:        first_name,
  11:        last_name
  12:
  13:    from raw.jaffle_shop.customers
  14:
  15:),
  16:
  17:orders as (
  18:
  19:    select
  20:        id as order_id,
  21:        user_id as customer_id,
  22:        order_date,
  23:        status
  24:
  25:    from raw.jaffle_shop.orders
  26:
  27:),
  28:
  29:customer_orders as (
  30:
  31:    select
  32:        customer_id,
  33:
  34:        min(order_date) as first_order_date,
  35:        max(order_date) as most_recent_order_date,
  36:        count(order_id) as number_of_orders
  37:
  38:    from orders
  39:
  40:    group by 1
  41:
  42:),
  43:
  44:
  45:final as (
  46:
  47:    select
  48:        customers.customer_id,
  49:        customers.first_name,
  50:        customers.last_name,
  51:        customer_orders.first_order_date,
  52:        customer_orders.most_recent_order_date,
  53:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  54:
  55:    from customers
  56:
  57:    left join customer_orders using (customer_id)
  58:
  59:)
  60:
  61:select * from final
  62:
  63:
  64:  )
  65:limit 500
  66:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  The project raw has not enabled BigQuery.
2021-03-29 21:23:49.923113 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  The project raw has not enabled BigQuery.', 'raw_sql': 'create or replace table `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers`\n  \n  \n  OPTIONS()\n  as (\n    with customers as (\n\n    select\n        id as customer_id,\n        first_name,\n        last_name\n\n    from raw.jaffle_shop.customers\n\n),\n\norders as (\n\n    select\n        id as order_id,\n        user_id as customer_id,\n        order_date,\n        status\n\n    from raw.jaffle_shop.orders\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n\n    from customers\n\n    left join customer_orders using (customer_id)\n\n)\n\nselect * from final\n\n\n  )\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': 'create or replace table `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers`\n  \n  \n  OPTIONS()\n  as (\n    with customers as (\n\n    select\n        id as customer_id,\n        first_name,\n        last_name\n\n    from raw.jaffle_shop.customers\n\n),\n\norders as (\n\n    select\n        id as order_id,\n        user_id as customer_id,\n        order_date,\n        status\n\n    from raw.jaffle_shop.orders\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n\n    from customers\n\n    left join customer_orders using (customer_id)\n\n)\n\nselect * from final\n\n\n  )\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  The project raw has not enabled BigQuery.', 'raw_sql': 'create or replace table `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers`\n  \n  \n  OPTIONS()\n  as (\n    with customers as (\n\n    select\n        id as customer_id,\n        first_name,\n        last_name\n\n    from raw.jaffle_shop.customers\n\n),\n\norders as (\n\n    select\n        id as order_id,\n        user_id as customer_id,\n        order_date,\n        status\n\n    from raw.jaffle_shop.orders\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n\n    from customers\n\n    left join customer_orders using (customer_id)\n\n)\n\nselect * from final\n\n\n  )\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': 'create or replace table `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers`\n  \n  \n  OPTIONS()\n  as (\n    with customers as (\n\n    select\n        id as customer_id,\n        first_name,\n        last_name\n\n    from raw.jaffle_shop.customers\n\n),\n\norders as (\n\n    select\n        id as order_id,\n        user_id as customer_id,\n        order_date,\n        status\n\n    from raw.jaffle_shop.orders\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n\n    from customers\n\n    left join customer_orders using (customer_id)\n\n)\n\nselect * from final\n\n\n  )\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-29 21:23:50.389427 (Thread-7): handling poll request
2021-03-29 21:23:50.389854 (Thread-7): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c46c310>]}
2021-03-29 21:23:50.390764 (Thread-7): sending response (<Response 17865 bytes [200 OK]>) to 10.0.42.133
2021-03-29 21:24:05.871766 (Thread-8): Got an acceptable cached parse result
2021-03-29 21:24:06.044131 (Thread-8): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 21:24:06.263366 (Thread-9): handling status request
2021-03-29 21:24:06.263798 (Thread-9): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c48a0d0>]}
2021-03-29 21:24:06.264728 (Thread-9): sending response (<Response 875 bytes [200 OK]>) to 10.0.22.169
2021-03-29 21:24:53.812924 (Thread-10): handling status request
2021-03-29 21:24:53.814978 (Thread-10): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c437a00>]}
2021-03-29 21:24:53.815867 (Thread-10): sending response (<Response 875 bytes [200 OK]>) to 10.0.38.35
2021-03-29 21:24:54.322286 (Thread-11): handling run_sql request
2021-03-29 21:24:54.322726 (Thread-11): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c437580>]}
2021-03-29 21:24:55.158657 (Thread-11): sending response (<Response 138 bytes [200 OK]>) to 10.0.9.250
2021-03-29 21:24:55.175514 (MainThread): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-03-29 21:24:55.193227 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-29 21:24:55.193744 (Thread-1): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-03-29 21:24:55.193850 (Thread-1): Compiling rpc.my_new_project.request
2021-03-29 21:24:55.242147 (Thread-1): finished collecting timing info
2021-03-29 21:24:55.242423 (Thread-1): Opening a new connection, currently in state init
2021-03-29 21:24:55.242913 (Thread-1): On rpc.my_new_project.request: with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final


limit 500
/* limit added automatically by dbt cloud */
2021-03-29 21:24:55.656464 (Thread-12): handling poll request
2021-03-29 21:24:55.656967 (Thread-12): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c4888e0>]}
2021-03-29 21:24:55.658978 (Thread-12): sending response (<Response 3552 bytes [200 OK]>) to 10.0.19.42
2021-03-29 21:24:55.963953 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('The project raw has not enabled BigQuery.')
2021-03-29 21:24:57.076249 (Thread-13): handling poll request
2021-03-29 21:24:57.076684 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c4979a0>]}
2021-03-29 21:24:57.077675 (Thread-13): sending response (<Response 712 bytes [200 OK]>) to 10.0.4.203
2021-03-29 21:24:57.272102 (Thread-1): finished collecting timing info
2021-03-29 21:24:57.272443 (Thread-1): Got an exception: Database Error
  The project raw has not enabled BigQuery.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 The project raw has not enabled BigQuery.

(job ID: 8747d432-ac69-4443-888f-02891203b5e1)

                       -----Query Job SQL Follows-----                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with customers as (
   2:
   3:    select
   4:        id as customer_id,
   5:        first_name,
   6:        last_name
   7:
   8:    from raw.jaffle_shop.customers
   9:
  10:),
  11:
  12:orders as (
  13:
  14:    select
  15:        id as order_id,
  16:        user_id as customer_id,
  17:        order_date,
  18:        status
  19:
  20:    from raw.jaffle_shop.orders
  21:
  22:),
  23:
  24:customer_orders as (
  25:
  26:    select
  27:        customer_id,
  28:
  29:        min(order_date) as first_order_date,
  30:        max(order_date) as most_recent_order_date,
  31:        count(order_id) as number_of_orders
  32:
  33:    from orders
  34:
  35:    group by 1
  36:
  37:),
  38:
  39:
  40:final as (
  41:
  42:    select
  43:        customers.customer_id,
  44:        customers.first_name,
  45:        customers.last_name,
  46:        customer_orders.first_order_date,
  47:        customer_orders.most_recent_order_date,
  48:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  49:
  50:    from customers
  51:
  52:    left join customer_orders using (customer_id)
  53:
  54:)
  55:
  56:select * from final
  57:
  58:
  59:limit 500
  60:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  The project raw has not enabled BigQuery.
2021-03-29 21:24:57.274334 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  The project raw has not enabled BigQuery.', 'raw_sql': 'with customers as (\n\n    select\n        id as customer_id,\n        first_name,\n        last_name\n\n    from raw.jaffle_shop.customers\n\n),\n\norders as (\n\n    select\n        id as order_id,\n        user_id as customer_id,\n        order_date,\n        status\n\n    from raw.jaffle_shop.orders\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n\n    from customers\n\n    left join customer_orders using (customer_id)\n\n)\n\nselect * from final\n\n{{ config (\n    materialized="table"\n)}}\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': 'with customers as (\n\n    select\n        id as customer_id,\n        first_name,\n        last_name\n\n    from raw.jaffle_shop.customers\n\n),\n\norders as (\n\n    select\n        id as order_id,\n        user_id as customer_id,\n        order_date,\n        status\n\n    from raw.jaffle_shop.orders\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n\n    from customers\n\n    left join customer_orders using (customer_id)\n\n)\n\nselect * from final\n\n\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  The project raw has not enabled BigQuery.', 'raw_sql': 'with customers as (\n\n    select\n        id as customer_id,\n        first_name,\n        last_name\n\n    from raw.jaffle_shop.customers\n\n),\n\norders as (\n\n    select\n        id as order_id,\n        user_id as customer_id,\n        order_date,\n        status\n\n    from raw.jaffle_shop.orders\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n\n    from customers\n\n    left join customer_orders using (customer_id)\n\n)\n\nselect * from final\n\n{{ config (\n    materialized="table"\n)}}\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': 'with customers as (\n\n    select\n        id as customer_id,\n        first_name,\n        last_name\n\n    from raw.jaffle_shop.customers\n\n),\n\norders as (\n\n    select\n        id as order_id,\n        user_id as customer_id,\n        order_date,\n        status\n\n    from raw.jaffle_shop.orders\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n\n    from customers\n\n    left join customer_orders using (customer_id)\n\n)\n\nselect * from final\n\n\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-29 21:24:58.635561 (Thread-14): handling poll request
2021-03-29 21:24:58.636000 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c4a2340>]}
2021-03-29 21:24:58.636914 (Thread-14): sending response (<Response 16992 bytes [200 OK]>) to 10.0.41.231
2021-03-29 21:26:21.956960 (Thread-15): handling status request
2021-03-29 21:26:21.959443 (Thread-15): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c497970>]}
2021-03-29 21:26:21.960410 (Thread-15): sending response (<Response 875 bytes [200 OK]>) to 10.0.4.203
2021-03-29 21:26:22.416506 (Thread-16): handling run_sql request
2021-03-29 21:26:22.416950 (Thread-16): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c3fc610>]}
2021-03-29 21:26:23.259973 (Thread-16): sending response (<Response 138 bytes [200 OK]>) to 10.0.12.103
2021-03-29 21:26:23.276765 (MainThread): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-03-29 21:26:23.296979 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-29 21:26:23.297422 (Thread-1): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-03-29 21:26:23.297527 (Thread-1): Compiling rpc.my_new_project.request
2021-03-29 21:26:23.340458 (Thread-1): finished collecting timing info
2021-03-29 21:26:23.340702 (Thread-1): Opening a new connection, currently in state init
2021-03-29 21:26:23.341142 (Thread-1): On rpc.my_new_project.request: with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `finl-1067321-eds-thunderdome.maxm.customers`

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `finl-1067321-eds-thunderdome.maxm.orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final


limit 500
/* limit added automatically by dbt cloud */
2021-03-29 21:26:23.694989 (Thread-17): handling poll request
2021-03-29 21:26:23.695472 (Thread-17): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c48ad90>]}
2021-03-29 21:26:23.698136 (Thread-17): sending response (<Response 3592 bytes [200 OK]>) to 10.0.28.2
2021-03-29 21:26:25.150116 (Thread-1): finished collecting timing info
2021-03-29 21:26:25.163910 (Thread-18): handling poll request
2021-03-29 21:26:25.164330 (Thread-18): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c3709a0>]}
2021-03-29 21:26:25.165301 (Thread-18): sending response (<Response 801 bytes [200 OK]>) to 10.0.28.2
2021-03-29 21:26:26.645762 (Thread-19): handling poll request
2021-03-29 21:26:26.646206 (Thread-19): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c4a2910>]}
2021-03-29 21:26:26.650746 (Thread-19): sending response (<Response 12373 bytes [200 OK]>) to 10.0.20.97
2021-03-29 21:35:44.165910 (Thread-20): handling status request
2021-03-29 21:35:44.167917 (Thread-20): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c4a2bb0>]}
2021-03-29 21:35:44.168824 (Thread-20): sending response (<Response 875 bytes [200 OK]>) to 10.0.7.19
2021-03-29 21:35:44.581540 (Thread-21): handling run_sql request
2021-03-29 21:35:44.581999 (Thread-21): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c4a2820>]}
2021-03-29 21:35:45.418707 (Thread-21): sending response (<Response 138 bytes [200 OK]>) to 10.0.4.203
2021-03-29 21:35:45.435781 (MainThread): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-03-29 21:35:45.456258 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-29 21:35:45.456716 (Thread-1): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-03-29 21:35:45.456825 (Thread-1): Compiling rpc.my_new_project.request
2021-03-29 21:35:45.504574 (Thread-1): finished collecting timing info
2021-03-29 21:35:45.504852 (Thread-1): Opening a new connection, currently in state init
2021-03-29 21:35:45.505323 (Thread-1): On rpc.my_new_project.request: 

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `finl-1067321-eds-thunderdome.maxm.customers`

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `finl-1067321-eds-thunderdome.maxm.orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-29 21:35:45.934472 (Thread-22): handling poll request
2021-03-29 21:35:45.935011 (Thread-22): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c48ae20>]}
2021-03-29 21:35:45.936999 (Thread-22): sending response (<Response 3592 bytes [200 OK]>) to 10.0.42.133
2021-03-29 21:35:47.326433 (Thread-1): finished collecting timing info
2021-03-29 21:35:47.488940 (Thread-23): handling poll request
2021-03-29 21:35:47.489395 (Thread-23): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c49fc10>]}
2021-03-29 21:35:47.493647 (Thread-23): sending response (<Response 12781 bytes [200 OK]>) to 10.0.44.102
2021-03-29 21:35:48.416595 (Thread-24): Got an acceptable cached parse result
2021-03-29 21:35:48.449877 (Thread-24): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-03-29 21:35:48.589749 (Thread-24): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 21:35:48.830737 (Thread-25): handling status request
2021-03-29 21:35:48.831196 (Thread-25): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c058370>]}
2021-03-29 21:35:48.832184 (Thread-25): sending response (<Response 1181 bytes [200 OK]>) to 10.0.38.35
2021-03-29 21:35:53.950800 (Thread-26): handling status request
2021-03-29 21:35:53.951244 (Thread-26): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c058310>]}
2021-03-29 21:35:53.952189 (Thread-26): sending response (<Response 1181 bytes [200 OK]>) to 10.0.4.203
2021-03-29 21:35:54.164793 (Thread-27): handling status request
2021-03-29 21:35:54.165209 (Thread-27): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c777a30>]}
2021-03-29 21:35:54.166212 (Thread-27): sending response (<Response 1181 bytes [200 OK]>) to 10.0.20.97
2021-03-29 21:35:54.358452 (Thread-28): handling cli_args request
2021-03-29 21:35:54.358895 (Thread-28): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c084dc0>]}
2021-03-29 21:35:54.370743 (Thread-28): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-03-29 21:35:55.231736 (Thread-28): sending response (<Response 138 bytes [200 OK]>) to 10.0.28.2
2021-03-29 21:35:55.283742 (MainThread): Partial parsing not enabled
2021-03-29 21:35:55.284986 (MainThread): Parsing macros/adapters.sql
2021-03-29 21:35:55.306523 (MainThread): Parsing macros/etc.sql
2021-03-29 21:35:55.308014 (MainThread): Parsing macros/catalog.sql
2021-03-29 21:35:55.314158 (MainThread): Parsing macros/materializations/copy.sql
2021-03-29 21:35:55.349341 (MainThread): Parsing macros/materializations/table.sql
2021-03-29 21:35:55.359374 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-29 21:35:55.371944 (MainThread): Parsing macros/materializations/seed.sql
2021-03-29 21:35:55.374653 (MainThread): Parsing macros/materializations/snapshot.sql
2021-03-29 21:35:55.376502 (MainThread): Parsing macros/materializations/view.sql
2021-03-29 21:35:55.379986 (MainThread): Parsing macros/core.sql
2021-03-29 21:35:55.383682 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-29 21:35:55.392715 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-29 21:35:55.408163 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-29 21:35:55.410029 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-29 21:35:55.426169 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-29 21:35:55.454830 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-29 21:35:55.459934 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-29 21:35:55.466224 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-29 21:35:55.486786 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-29 21:35:55.493954 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-29 21:35:55.496140 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-29 21:35:55.502526 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-29 21:35:55.504275 (MainThread): Parsing macros/etc/query.sql
2021-03-29 21:35:55.505429 (MainThread): Parsing macros/etc/datetime.sql
2021-03-29 21:35:55.514405 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-29 21:35:55.515466 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-29 21:35:55.517160 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-29 21:35:55.519299 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-29 21:35:55.520865 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-29 21:35:55.523667 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-29 21:35:55.525878 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-29 21:35:55.527832 (MainThread): Parsing macros/adapters/common.sql
2021-03-29 21:35:55.577180 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - my_new_project

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-29 21:35:55.577318 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6a382bd6-6791-4b51-82b2-cca3a12268ce', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc224eca0>]}
2021-03-29 21:35:55.580274 (MainThread): Partial parsing not enabled
2021-03-29 21:35:55.622567 (MainThread): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-03-29 21:35:55.653999 (Thread-29): handling poll request
2021-03-29 21:35:55.654439 (Thread-29): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c48af10>]}
2021-03-29 21:35:55.658743 (Thread-29): sending response (<Response 11020 bytes [200 OK]>) to 10.0.1.13
2021-03-29 21:35:55.768383 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 21:35:55.787385 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-29 21:35:55.787879 (MainThread): 
2021-03-29 21:35:55.788148 (MainThread): Acquiring new bigquery connection "master".
2021-03-29 21:35:55.789642 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome".
2021-03-29 21:35:55.789758 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-29 21:35:55.971703 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome_maxm".
2021-03-29 21:35:55.971852 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-29 21:35:56.145046 (MainThread): 21:35:56 | Concurrency: 1 threads (target='default')
2021-03-29 21:35:56.145174 (MainThread): 21:35:56 | 
2021-03-29 21:35:56.147047 (Thread-1): Began running node model.my_new_project.dim_customers
2021-03-29 21:35:56.148050 (Thread-1): 21:35:56 | 1 of 1 START table model maxm.dim_customers.......................... [RUN]
2021-03-29 21:35:56.148284 (Thread-1): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-03-29 21:35:56.148360 (Thread-1): Compiling model.my_new_project.dim_customers
2021-03-29 21:35:56.163323 (Thread-1): Writing injected SQL for node "model.my_new_project.dim_customers"
2021-03-29 21:35:56.180727 (Thread-1): finished collecting timing info
2021-03-29 21:35:56.218022 (Thread-1): Writing runtime SQL for node "model.my_new_project.dim_customers"
2021-03-29 21:35:56.234914 (Thread-1): Opening a new connection, currently in state closed
2021-03-29 21:35:56.235302 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.dim_customers"} */


  create or replace table `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers`
  
  
  OPTIONS()
  as (
    

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `finl-1067321-eds-thunderdome.maxm.customers`

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `finl-1067321-eds-thunderdome.maxm.orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-03-29 21:35:57.137992 (Thread-30): handling poll request
2021-03-29 21:35:57.138417 (Thread-30): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066fb5be0>]}
2021-03-29 21:35:57.140754 (Thread-30): sending response (<Response 8184 bytes [200 OK]>) to 10.0.38.35
2021-03-29 21:35:58.014659 (Thread-1): finished collecting timing info
2021-03-29 21:35:58.015320 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a382bd6-6791-4b51-82b2-cca3a12268ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc194ba30>]}
2021-03-29 21:35:58.016312 (Thread-1): 21:35:58 | 1 of 1 OK created table model maxm.dim_customers..................... [CREATE TABLE (100.0 rows, 4.3 KB processed) in 1.87s]
2021-03-29 21:35:58.016393 (Thread-1): Finished running node model.my_new_project.dim_customers
2021-03-29 21:35:58.017756 (MainThread): Acquiring new bigquery connection "master".
2021-03-29 21:35:58.018006 (MainThread): 21:35:58 | 
2021-03-29 21:35:58.018068 (MainThread): 21:35:58 | Finished running 1 table model in 2.23s.
2021-03-29 21:35:58.018114 (MainThread): Connection 'master' was properly closed.
2021-03-29 21:35:58.018152 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-03-29 21:35:58.050623 (MainThread): 
2021-03-29 21:35:58.050761 (MainThread): Completed successfully
2021-03-29 21:35:58.050836 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-03-29 21:35:58.696528 (Thread-31): handling poll request
2021-03-29 21:35:58.696948 (Thread-31): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066ffc280>]}
2021-03-29 21:35:58.728404 (Thread-31): sending response (<Response 9504 bytes [200 OK]>) to 10.0.44.102
2021-03-29 21:35:59.195231 (Thread-32): handling status request
2021-03-29 21:35:59.195653 (Thread-32): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066ffc2b0>]}
2021-03-29 21:35:59.196689 (Thread-32): sending response (<Response 1181 bytes [200 OK]>) to 10.0.7.19
2021-03-29 21:39:55.250900 (Thread-33): Got an acceptable cached parse result
2021-03-29 21:39:55.416482 (Thread-33): Acquiring new bigquery connection "model.my_new_project.stg_customers".
2021-03-29 21:39:55.558545 (Thread-33): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 21:39:55.574892 (Thread-34): handling status request
2021-03-29 21:39:55.575296 (Thread-34): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c382460>]}
2021-03-29 21:39:55.576263 (Thread-34): sending response (<Response 1181 bytes [200 OK]>) to 10.0.28.2
2021-03-29 21:40:40.459898 (MainThread): Connection 'model.my_new_project.stg_customers' was properly closed.
2021-03-29 21:40:40.511784 (Thread-35): Got an acceptable cached parse result
2021-03-29 21:40:40.546440 (Thread-35): Acquiring new bigquery connection "model.my_new_project.stg_customers".
2021-03-29 21:40:40.695261 (Thread-35): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 21:40:40.970626 (Thread-36): handling status request
2021-03-29 21:40:40.971070 (Thread-36): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c74fa90>]}
2021-03-29 21:40:40.972037 (Thread-36): sending response (<Response 1181 bytes [200 OK]>) to 10.0.12.103
2021-03-29 21:40:52.751392 (MainThread): Connection 'model.my_new_project.stg_customers' was properly closed.
2021-03-29 21:40:52.803794 (Thread-37): Got an acceptable cached parse result
2021-03-29 21:40:52.847400 (Thread-37): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-03-29 21:40:53.012497 (Thread-37): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 21:40:53.202081 (Thread-38): handling status request
2021-03-29 21:40:53.202510 (Thread-38): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c18efd0>]}
2021-03-29 21:40:53.203550 (Thread-38): sending response (<Response 1181 bytes [200 OK]>) to 10.0.44.102
2021-03-29 21:41:10.557366 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-03-29 21:41:10.609203 (Thread-39): Got an acceptable cached parse result
2021-03-29 21:41:10.646931 (Thread-39): Acquiring new bigquery connection "model.my_new_project.sgt_orders".
2021-03-29 21:41:10.900794 (Thread-39): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 21:41:11.277286 (Thread-40): handling status request
2021-03-29 21:41:11.277708 (Thread-40): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c1801c0>]}
2021-03-29 21:41:11.278690 (Thread-40): sending response (<Response 1178 bytes [200 OK]>) to 10.0.22.208
2021-03-29 21:41:14.874466 (MainThread): Connection 'model.my_new_project.sgt_orders' was properly closed.
2021-03-29 21:41:14.927155 (Thread-41): Got an acceptable cached parse result
2021-03-29 21:41:14.967405 (Thread-41): Acquiring new bigquery connection "model.my_new_project.sgt_orders".
2021-03-29 21:41:15.128829 (Thread-41): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 21:41:15.323829 (Thread-42): handling status request
2021-03-29 21:41:15.324255 (Thread-42): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c2630d0>]}
2021-03-29 21:41:15.325239 (Thread-42): sending response (<Response 1178 bytes [200 OK]>) to 10.0.28.2
2021-03-29 21:41:30.100882 (MainThread): Connection 'model.my_new_project.sgt_orders' was properly closed.
2021-03-29 21:41:30.148257 (Thread-43): Got an acceptable cached parse result
2021-03-29 21:41:30.182265 (Thread-43): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-03-29 21:41:30.347023 (Thread-43): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 21:41:30.506501 (Thread-44): handling status request
2021-03-29 21:41:30.507005 (Thread-44): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066fb88b0>]}
2021-03-29 21:41:30.508082 (Thread-44): sending response (<Response 1181 bytes [200 OK]>) to 10.0.22.169
2021-03-29 21:42:53.645061 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-03-29 21:42:53.694009 (Thread-45): Got an acceptable cached parse result
2021-03-29 21:42:53.832531 (Thread-45): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-03-29 21:42:54.199675 (Thread-46): handling status request
2021-03-29 21:42:54.200117 (Thread-46): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066f41940>]}
2021-03-29 21:42:54.201064 (Thread-46): sending response (<Response 959 bytes [200 OK]>) to 10.0.47.191
2021-03-29 21:43:08.858735 (Thread-47): handling status request
2021-03-29 21:43:08.859202 (Thread-47): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c4fa850>]}
2021-03-29 21:43:08.860143 (Thread-47): sending response (<Response 959 bytes [200 OK]>) to 10.0.22.208
2021-03-29 21:43:09.378353 (Thread-48): handling compile_sql request
2021-03-29 21:43:09.378778 (Thread-48): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066f41d00>]}
2021-03-29 21:43:09.379165 (Thread-48): sending response (<Response 737 bytes [200 OK]>) to 10.0.1.13
2021-03-29 21:43:31.975270 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-03-29 21:43:32.020751 (Thread-49): Got an acceptable cached parse result
2021-03-29 21:43:32.463560 (Thread-50): handling status request
2021-03-29 21:43:32.463996 (Thread-50): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066e83100>]}
2021-03-29 21:43:32.464839 (Thread-50): sending response (<Response 655 bytes [200 OK]>) to 10.0.33.179
2021-03-29 21:43:35.297271 (Thread-51): Got an acceptable cached parse result
2021-03-29 21:43:35.637814 (Thread-52): handling status request
2021-03-29 21:43:35.638253 (Thread-52): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c120ac0>]}
2021-03-29 21:43:35.639135 (Thread-52): sending response (<Response 655 bytes [200 OK]>) to 10.0.22.169
2021-03-29 21:44:03.965438 (Thread-53): Got an acceptable cached parse result
2021-03-29 21:44:04.114539 (Thread-53): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-03-29 21:44:04.255564 (Thread-53): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 21:44:04.312289 (Thread-54): handling status request
2021-03-29 21:44:04.312698 (Thread-54): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c3961c0>]}
2021-03-29 21:44:04.313660 (Thread-54): sending response (<Response 1181 bytes [200 OK]>) to 10.0.28.2
2021-03-29 21:44:25.741893 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-03-29 21:44:25.793099 (Thread-55): Got an acceptable cached parse result
2021-03-29 21:44:25.969437 (Thread-55): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 21:44:26.154922 (Thread-56): handling status request
2021-03-29 21:44:26.155350 (Thread-56): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c46f6a0>]}
2021-03-29 21:44:26.156253 (Thread-56): sending response (<Response 877 bytes [200 OK]>) to 10.0.1.13
2021-03-29 21:44:34.519274 (Thread-57): handling status request
2021-03-29 21:44:34.519717 (Thread-57): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c104cd0>]}
2021-03-29 21:44:34.520609 (Thread-57): sending response (<Response 877 bytes [200 OK]>) to 10.0.1.13
2021-03-29 21:44:34.695839 (Thread-58): handling ps request
2021-03-29 21:44:34.696269 (Thread-58): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c15e8e0>]}
2021-03-29 21:44:34.698844 (Thread-58): sending response (<Response 2560 bytes [200 OK]>) to 10.0.19.42
2021-03-29 21:44:35.189609 (Thread-59): handling poll request
2021-03-29 21:44:35.190047 (Thread-59): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c15e8e0>]}
2021-03-29 21:44:35.199330 (Thread-59): sending response (<Response 28126 bytes [200 OK]>) to 10.0.33.179
2021-03-29 21:44:35.888210 (Thread-60): handling status request
2021-03-29 21:44:35.888649 (Thread-60): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066e815e0>]}
2021-03-29 21:44:35.889569 (Thread-60): sending response (<Response 877 bytes [200 OK]>) to 10.0.38.35
2021-03-29 21:44:39.357086 (Thread-61): handling status request
2021-03-29 21:44:39.357541 (Thread-61): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066eebca0>]}
2021-03-29 21:44:39.358449 (Thread-61): sending response (<Response 877 bytes [200 OK]>) to 10.0.19.42
2021-03-29 21:44:39.819726 (Thread-62): handling compile_sql request
2021-03-29 21:44:39.820145 (Thread-62): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c3af3d0>]}
2021-03-29 21:44:40.642478 (Thread-62): sending response (<Response 138 bytes [200 OK]>) to 10.0.4.203
2021-03-29 21:44:40.659309 (MainThread): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-03-29 21:44:40.704045 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-29 21:44:40.704456 (Thread-1): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-03-29 21:44:40.704567 (Thread-1): Compiling rpc.my_new_project.request
2021-03-29 21:44:40.720284 (Thread-1): finished collecting timing info
2021-03-29 21:44:40.720488 (Thread-1): finished collecting timing info
2021-03-29 21:44:41.139461 (Thread-63): handling poll request
2021-03-29 21:44:41.139913 (Thread-63): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066e815b0>]}
2021-03-29 21:44:41.144493 (Thread-63): sending response (<Response 8350 bytes [200 OK]>) to 10.0.47.191
2021-03-29 21:44:44.708934 (Thread-64): handling status request
2021-03-29 21:44:44.709373 (Thread-64): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c3348b0>]}
2021-03-29 21:44:44.710301 (Thread-64): sending response (<Response 877 bytes [200 OK]>) to 10.0.33.179
2021-03-29 21:44:45.179036 (Thread-65): handling run_sql request
2021-03-29 21:44:45.179471 (Thread-65): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c334f10>]}
2021-03-29 21:44:45.998221 (Thread-65): sending response (<Response 138 bytes [200 OK]>) to 10.0.38.35
2021-03-29 21:44:46.014830 (MainThread): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-03-29 21:44:46.062274 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-29 21:44:46.062727 (Thread-1): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-03-29 21:44:46.062855 (Thread-1): Compiling rpc.my_new_project.request
2021-03-29 21:44:46.078997 (Thread-1): finished collecting timing info
2021-03-29 21:44:46.079225 (Thread-1): Opening a new connection, currently in state init
2021-03-29 21:44:46.079595 (Thread-1): On rpc.my_new_project.request: 

with customers as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
),

orders as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`sgt_orders`
),

 customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-29 21:44:46.691111 (Thread-1): Unhandled error while running:


with customers as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
),

orders as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`sgt_orders`
),

 customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-29 21:44:46.691322 (Thread-1): finished collecting timing info
2021-03-29 21:44:46.691586 (Thread-1): Got an exception: Runtime Error
  404 Not found: Table finl-1067321-eds-thunderdome:maxm.stg_customers was not found in location US
  
  (job ID: dcfd5430-c0b7-4f6e-8a6b-8e8cd5dd67cc)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table finl-1067321-eds-thunderdome:maxm.stg_customers was not found in location US

(job ID: dcfd5430-c0b7-4f6e-8a6b-8e8cd5dd67cc)

                       -----Query Job SQL Follows-----                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:
   2:
   3:with customers as (
   4:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
   5:),
   6:
   7:orders as (
   8:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`sgt_orders`
   9:),
  10:
  11: customer_orders as (
  12:
  13:    select
  14:        customer_id,
  15:
  16:        min(order_date) as first_order_date,
  17:        max(order_date) as most_recent_order_date,
  18:        count(order_id) as number_of_orders
  19:
  20:    from orders
  21:
  22:    group by 1
  23:
  24:),
  25:
  26:
  27:final as (
  28:
  29:    select
  30:        customers.customer_id,
  31:        customers.first_name,
  32:        customers.last_name,
  33:        customer_orders.first_order_date,
  34:        customer_orders.most_recent_order_date,
  35:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  36:
  37:    from customers
  38:
  39:    left join customer_orders using (customer_id)
  40:
  41:)
  42:
  43:select * from final
  44:limit 500
  45:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 134, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error
  404 Not found: Table finl-1067321-eds-thunderdome:maxm.stg_customers was not found in location US
  
  (job ID: dcfd5430-c0b7-4f6e-8a6b-8e8cd5dd67cc)
2021-03-29 21:44:46.694326 (Thread-1): Got exception RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 Not found: Table finl-1067321-eds-thunderdome:maxm.stg_customers was not found in location US\n  \n  (job ID: dcfd5430-c0b7-4f6e-8a6b-8e8cd5dd67cc)', 'raw_sql': '{{ config (\n    materialized="table"\n)}}\n\nwith customers as (\n    select * from {{ ref(\'stg_customers\') }}\n),\n\norders as (\n    select * from {{ ref(\'sgt_orders\') }}\n),\n\n customer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n\n    from customers\n\n    left join customer_orders using (customer_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': '\n\nwith customers as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n),\n\norders as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`sgt_orders`\n),\n\n customer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n\n    from customers\n\n    left join customer_orders using (customer_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 Not found: Table finl-1067321-eds-thunderdome:maxm.stg_customers was not found in location US\n  \n  (job ID: dcfd5430-c0b7-4f6e-8a6b-8e8cd5dd67cc)', 'raw_sql': '{{ config (\n    materialized="table"\n)}}\n\nwith customers as (\n    select * from {{ ref(\'stg_customers\') }}\n),\n\norders as (\n    select * from {{ ref(\'sgt_orders\') }}\n),\n\n customer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n\n    from customers\n\n    left join customer_orders using (customer_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': '\n\nwith customers as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n),\n\norders as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`sgt_orders`\n),\n\n customer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n\n    from customers\n\n    left join customer_orders using (customer_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-29 21:44:47.296373 (Thread-66): handling poll request
2021-03-29 21:44:47.296842 (Thread-66): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c334e50>]}
2021-03-29 21:44:47.300168 (Thread-66): sending response (<Response 16995 bytes [200 OK]>) to 10.0.17.36
2021-03-29 21:44:57.747680 (Thread-67): handling status request
2021-03-29 21:44:57.748115 (Thread-67): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066e815b0>]}
2021-03-29 21:44:57.749082 (Thread-67): sending response (<Response 877 bytes [200 OK]>) to 10.0.41.231
2021-03-29 21:44:57.759375 (Thread-68): handling status request
2021-03-29 21:44:57.759685 (Thread-68): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066e81c70>]}
2021-03-29 21:44:57.760470 (Thread-68): sending response (<Response 877 bytes [200 OK]>) to 10.0.33.179
2021-03-29 21:44:58.193551 (Thread-69): handling cli_args request
2021-03-29 21:44:58.193971 (Thread-69): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c334670>]}
2021-03-29 21:44:59.011576 (Thread-69): sending response (<Response 138 bytes [200 OK]>) to 10.0.12.103
2021-03-29 21:44:59.062674 (MainThread): Partial parsing not enabled
2021-03-29 21:44:59.063809 (MainThread): Parsing macros/adapters.sql
2021-03-29 21:44:59.083480 (MainThread): Parsing macros/etc.sql
2021-03-29 21:44:59.084771 (MainThread): Parsing macros/catalog.sql
2021-03-29 21:44:59.090663 (MainThread): Parsing macros/materializations/copy.sql
2021-03-29 21:44:59.120659 (MainThread): Parsing macros/materializations/table.sql
2021-03-29 21:44:59.130446 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-29 21:44:59.142768 (MainThread): Parsing macros/materializations/seed.sql
2021-03-29 21:44:59.145460 (MainThread): Parsing macros/materializations/snapshot.sql
2021-03-29 21:44:59.147287 (MainThread): Parsing macros/materializations/view.sql
2021-03-29 21:44:59.150728 (MainThread): Parsing macros/core.sql
2021-03-29 21:44:59.154304 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-29 21:44:59.163185 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-29 21:44:59.176946 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-29 21:44:59.178716 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-29 21:44:59.194791 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-29 21:44:59.222316 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-29 21:44:59.227163 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-29 21:44:59.233303 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-29 21:44:59.253346 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-29 21:44:59.259833 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-29 21:44:59.261640 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-29 21:44:59.267528 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-29 21:44:59.269125 (MainThread): Parsing macros/etc/query.sql
2021-03-29 21:44:59.270211 (MainThread): Parsing macros/etc/datetime.sql
2021-03-29 21:44:59.278828 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-29 21:44:59.279816 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-29 21:44:59.281478 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-29 21:44:59.283456 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-29 21:44:59.284986 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-29 21:44:59.287639 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-29 21:44:59.289512 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-29 21:44:59.291295 (MainThread): Parsing macros/adapters/common.sql
2021-03-29 21:44:59.338363 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - my_new_project

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-29 21:44:59.338464 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '664efff8-4d65-4486-8b11-9062b5332ec9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb21a34b400>]}
2021-03-29 21:44:59.341352 (MainThread): Partial parsing not enabled
2021-03-29 21:44:59.382458 (MainThread): Acquiring new bigquery connection "model.my_new_project.stg_customers".
2021-03-29 21:44:59.399345 (MainThread): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-03-29 21:44:59.409654 (MainThread): Acquiring new bigquery connection "model.my_new_project.sgt_orders".
2021-03-29 21:44:59.502552 (Thread-70): handling poll request
2021-03-29 21:44:59.502990 (Thread-70): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066eb4250>]}
2021-03-29 21:44:59.507297 (Thread-70): sending response (<Response 11629 bytes [200 OK]>) to 10.0.44.102
2021-03-29 21:44:59.547220 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 21:44:59.567184 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-29 21:44:59.567762 (MainThread): 
2021-03-29 21:44:59.568011 (MainThread): Acquiring new bigquery connection "master".
2021-03-29 21:44:59.571788 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome".
2021-03-29 21:44:59.571906 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-29 21:44:59.736193 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome_maxm".
2021-03-29 21:44:59.736327 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-29 21:44:59.910069 (MainThread): 21:44:59 | Concurrency: 1 threads (target='default')
2021-03-29 21:44:59.910198 (MainThread): 21:44:59 | 
2021-03-29 21:44:59.912438 (Thread-1): Began running node model.my_new_project.sgt_orders
2021-03-29 21:44:59.913424 (Thread-1): 21:44:59 | 1 of 3 START view model maxm.sgt_orders.............................. [RUN]
2021-03-29 21:44:59.913661 (Thread-1): Acquiring new bigquery connection "model.my_new_project.sgt_orders".
2021-03-29 21:44:59.913739 (Thread-1): Compiling model.my_new_project.sgt_orders
2021-03-29 21:44:59.927273 (Thread-1): Writing injected SQL for node "model.my_new_project.sgt_orders"
2021-03-29 21:44:59.937883 (Thread-1): finished collecting timing info
2021-03-29 21:44:59.982854 (Thread-1): Writing runtime SQL for node "model.my_new_project.sgt_orders"
2021-03-29 21:44:59.994570 (Thread-1): Opening a new connection, currently in state closed
2021-03-29 21:44:59.994957 (Thread-1): On model.my_new_project.sgt_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.sgt_orders"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`sgt_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `finl-1067321-eds-thunderdome.maxm.orders`;


2021-03-29 21:45:00.310484 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [14:52]')
2021-03-29 21:45:00.985643 (Thread-71): handling poll request
2021-03-29 21:45:00.986077 (Thread-71): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066eb4bb0>]}
2021-03-29 21:45:00.988464 (Thread-71): sending response (<Response 7666 bytes [200 OK]>) to 10.0.1.13
2021-03-29 21:45:01.495698 (Thread-1): finished collecting timing info
2021-03-29 21:45:01.496224 (Thread-1): Database Error in model sgt_orders (models/sgt_orders.sql)
  Syntax error: Expected ")" but got ";" at [14:52]
  compiled SQL at target/run/my_new_project/models/sgt_orders.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected ")" but got ";" at [14:52]

(job ID: dc54d539-fd3a-4733-aed2-c07dcb5836e2)

                                                         -----Query Job SQL Follows-----                                                          

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.sgt_orders"} */
   2:
   3:
   4:  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`sgt_orders`
   5:  OPTIONS()
   6:  as with orders as (
   7:
   8:    select
   9:        id as order_id,
  10:        user_id as customer_id,
  11:        order_date,
  12:        status
  13:
  14:    from `finl-1067321-eds-thunderdome.maxm.orders`;
  15:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model sgt_orders (models/sgt_orders.sql)
  Syntax error: Expected ")" but got ";" at [14:52]
  compiled SQL at target/run/my_new_project/models/sgt_orders.sql
2021-03-29 21:45:01.498652 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '664efff8-4d65-4486-8b11-9062b5332ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb218a0b700>]}
2021-03-29 21:45:01.499769 (Thread-1): 21:45:01 | 1 of 3 ERROR creating view model maxm.sgt_orders..................... [ERROR in 1.59s]
2021-03-29 21:45:01.499857 (Thread-1): Finished running node model.my_new_project.sgt_orders
2021-03-29 21:45:01.499963 (Thread-1): Began running node model.my_new_project.stg_customers
2021-03-29 21:45:01.500776 (Thread-1): 21:45:01 | 2 of 3 START view model maxm.stg_customers........................... [RUN]
2021-03-29 21:45:01.501006 (Thread-1): Acquiring new bigquery connection "model.my_new_project.stg_customers".
2021-03-29 21:45:01.501081 (Thread-1): Compiling model.my_new_project.stg_customers
2021-03-29 21:45:01.506292 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_customers"
2021-03-29 21:45:01.520752 (Thread-1): finished collecting timing info
2021-03-29 21:45:01.524829 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_customers"
2021-03-29 21:45:01.536739 (Thread-1): Opening a new connection, currently in state closed
2021-03-29 21:45:01.537101 (Thread-1): On model.my_new_project.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.stg_customers"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
  OPTIONS()
  as with customers as (
    
    select 
        id as customer_id,
        first_name,
        last_name

    from `finl-1067321-eds-thunderdome.maxm.customers`
)

select * from customers;


2021-03-29 21:45:02.376401 (Thread-1): finished collecting timing info
2021-03-29 21:45:02.377010 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '664efff8-4d65-4486-8b11-9062b5332ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2181122e0>]}
2021-03-29 21:45:02.377980 (Thread-1): 21:45:02 | 2 of 3 OK created view model maxm.stg_customers...................... [CREATE VIEW in 0.88s]
2021-03-29 21:45:02.378083 (Thread-1): Finished running node model.my_new_project.stg_customers
2021-03-29 21:45:02.379008 (Thread-1): Began running node model.my_new_project.dim_customers
2021-03-29 21:45:02.379190 (Thread-1): 21:45:02 | 3 of 3 SKIP relation maxm.dim_customers.............................. [SKIP]
2021-03-29 21:45:02.379285 (Thread-1): Finished running node model.my_new_project.dim_customers
2021-03-29 21:45:02.380265 (MainThread): Acquiring new bigquery connection "master".
2021-03-29 21:45:02.380520 (MainThread): 21:45:02 | 
2021-03-29 21:45:02.380585 (MainThread): 21:45:02 | Finished running 2 view models, 1 table model in 2.81s.
2021-03-29 21:45:02.380633 (MainThread): Connection 'master' was properly closed.
2021-03-29 21:45:02.380673 (MainThread): Connection 'model.my_new_project.stg_customers' was properly closed.
2021-03-29 21:45:02.423744 (MainThread): 
2021-03-29 21:45:02.423860 (MainThread): Completed with 1 error and 0 warnings:
2021-03-29 21:45:02.423915 (MainThread): 
2021-03-29 21:45:02.423968 (MainThread): Database Error in model sgt_orders (models/sgt_orders.sql)
2021-03-29 21:45:02.424012 (MainThread):   Syntax error: Expected ")" but got ";" at [14:52]
2021-03-29 21:45:02.424051 (MainThread):   compiled SQL at target/run/my_new_project/models/sgt_orders.sql
2021-03-29 21:45:02.424100 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-03-29 21:45:02.466432 (Thread-72): handling poll request
2021-03-29 21:45:02.466882 (Thread-72): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066e815b0>]}
2021-03-29 21:45:02.507285 (Thread-72): sending response (<Response 21160 bytes [200 OK]>) to 10.0.44.102
2021-03-29 21:45:04.005881 (Thread-73): handling poll request
2021-03-29 21:45:04.006320 (Thread-73): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c29deb0>]}
2021-03-29 21:45:04.013719 (Thread-73): sending response (<Response 6719 bytes [200 OK]>) to 10.0.22.169
2021-03-29 21:45:04.446072 (Thread-74): handling status request
2021-03-29 21:45:04.446503 (Thread-74): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c28e610>]}
2021-03-29 21:45:04.447448 (Thread-74): sending response (<Response 877 bytes [200 OK]>) to 10.0.22.169
2021-03-29 21:45:48.885659 (Thread-75): Got an acceptable cached parse result
2021-03-29 21:45:48.923516 (Thread-75): Acquiring new bigquery connection "model.my_new_project.sgt_orders".
2021-03-29 21:45:49.062763 (Thread-75): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 21:45:49.297111 (Thread-76): handling status request
2021-03-29 21:45:49.297526 (Thread-76): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c149bb0>]}
2021-03-29 21:45:49.298540 (Thread-76): sending response (<Response 1178 bytes [200 OK]>) to 10.0.33.179
2021-03-29 21:45:53.697510 (Thread-77): handling status request
2021-03-29 21:45:53.697934 (Thread-77): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066eb30a0>]}
2021-03-29 21:45:53.698905 (Thread-77): sending response (<Response 1178 bytes [200 OK]>) to 10.0.38.35
2021-03-29 21:45:53.893165 (Thread-78): handling status request
2021-03-29 21:45:53.893581 (Thread-78): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066eb3a60>]}
2021-03-29 21:45:53.894536 (Thread-78): sending response (<Response 1178 bytes [200 OK]>) to 10.0.44.102
2021-03-29 21:45:54.396914 (Thread-79): handling cli_args request
2021-03-29 21:45:54.397347 (Thread-79): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066eb4eb0>]}
2021-03-29 21:45:54.406891 (Thread-79): Connection 'model.my_new_project.sgt_orders' was properly closed.
2021-03-29 21:45:55.236336 (Thread-79): sending response (<Response 138 bytes [200 OK]>) to 10.0.12.103
2021-03-29 21:45:55.288195 (MainThread): Partial parsing not enabled
2021-03-29 21:45:55.289407 (MainThread): Parsing macros/adapters.sql
2021-03-29 21:45:55.309960 (MainThread): Parsing macros/etc.sql
2021-03-29 21:45:55.311393 (MainThread): Parsing macros/catalog.sql
2021-03-29 21:45:55.317334 (MainThread): Parsing macros/materializations/copy.sql
2021-03-29 21:45:55.353103 (MainThread): Parsing macros/materializations/table.sql
2021-03-29 21:45:55.362922 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-29 21:45:55.375493 (MainThread): Parsing macros/materializations/seed.sql
2021-03-29 21:45:55.378268 (MainThread): Parsing macros/materializations/snapshot.sql
2021-03-29 21:45:55.380151 (MainThread): Parsing macros/materializations/view.sql
2021-03-29 21:45:55.383685 (MainThread): Parsing macros/core.sql
2021-03-29 21:45:55.387285 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-29 21:45:55.396287 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-29 21:45:55.410478 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-29 21:45:55.412395 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-29 21:45:55.428728 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-29 21:45:55.456406 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-29 21:45:55.461320 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-29 21:45:55.467467 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-29 21:45:55.487686 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-29 21:45:55.494369 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-29 21:45:55.496289 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-29 21:45:55.502288 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-29 21:45:55.504049 (MainThread): Parsing macros/etc/query.sql
2021-03-29 21:45:55.505176 (MainThread): Parsing macros/etc/datetime.sql
2021-03-29 21:45:55.514078 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-29 21:45:55.515278 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-29 21:45:55.516988 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-29 21:45:55.519028 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-29 21:45:55.520660 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-29 21:45:55.524125 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-29 21:45:55.526597 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-29 21:45:55.528991 (MainThread): Parsing macros/adapters/common.sql
2021-03-29 21:45:55.603761 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - my_new_project

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-29 21:45:55.603943 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '29fe9f73-d681-484d-8f05-8f081c277296', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b352c2af0>]}
2021-03-29 21:45:55.606902 (MainThread): Partial parsing not enabled
2021-03-29 21:45:55.656334 (MainThread): Acquiring new bigquery connection "model.my_new_project.stg_customers".
2021-03-29 21:45:55.673389 (MainThread): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-03-29 21:45:55.683591 (MainThread): Acquiring new bigquery connection "model.my_new_project.sgt_orders".
2021-03-29 21:45:55.770980 (Thread-80): handling poll request
2021-03-29 21:45:55.771622 (Thread-80): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c170730>]}
2021-03-29 21:45:55.777863 (Thread-80): sending response (<Response 11629 bytes [200 OK]>) to 10.0.9.250
2021-03-29 21:45:55.819794 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-29 21:45:55.839787 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-29 21:45:55.840396 (MainThread): 
2021-03-29 21:45:55.840664 (MainThread): Acquiring new bigquery connection "master".
2021-03-29 21:45:55.844448 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome".
2021-03-29 21:45:55.844565 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-29 21:45:56.026263 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome_maxm".
2021-03-29 21:45:56.026410 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-29 21:45:56.209691 (MainThread): 21:45:56 | Concurrency: 1 threads (target='default')
2021-03-29 21:45:56.209863 (MainThread): 21:45:56 | 
2021-03-29 21:45:56.212641 (Thread-1): Began running node model.my_new_project.sgt_orders
2021-03-29 21:45:56.213653 (Thread-1): 21:45:56 | 1 of 3 START view model maxm.sgt_orders.............................. [RUN]
2021-03-29 21:45:56.213896 (Thread-1): Acquiring new bigquery connection "model.my_new_project.sgt_orders".
2021-03-29 21:45:56.213975 (Thread-1): Compiling model.my_new_project.sgt_orders
2021-03-29 21:45:56.227366 (Thread-1): Writing injected SQL for node "model.my_new_project.sgt_orders"
2021-03-29 21:45:56.243297 (Thread-1): finished collecting timing info
2021-03-29 21:45:56.273665 (Thread-1): Writing runtime SQL for node "model.my_new_project.sgt_orders"
2021-03-29 21:45:56.292203 (Thread-1): Opening a new connection, currently in state closed
2021-03-29 21:45:56.292575 (Thread-1): On model.my_new_project.sgt_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.sgt_orders"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`sgt_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `finl-1067321-eds-thunderdome.maxm.orders`
)

select * from orders;


2021-03-29 21:45:57.205245 (Thread-81): handling poll request
2021-03-29 21:45:57.205658 (Thread-81): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c1700d0>]}
2021-03-29 21:45:57.208000 (Thread-81): sending response (<Response 7312 bytes [200 OK]>) to 10.0.20.97
2021-03-29 21:45:57.370719 (Thread-1): finished collecting timing info
2021-03-29 21:45:57.371337 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29fe9f73-d681-484d-8f05-8f081c277296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2ffc48e0>]}
2021-03-29 21:45:57.372431 (Thread-1): 21:45:57 | 1 of 3 OK created view model maxm.sgt_orders......................... [CREATE VIEW in 1.16s]
2021-03-29 21:45:57.372515 (Thread-1): Finished running node model.my_new_project.sgt_orders
2021-03-29 21:45:57.372620 (Thread-1): Began running node model.my_new_project.stg_customers
2021-03-29 21:45:57.373409 (Thread-1): 21:45:57 | 2 of 3 START view model maxm.stg_customers........................... [RUN]
2021-03-29 21:45:57.373602 (Thread-1): Acquiring new bigquery connection "model.my_new_project.stg_customers".
2021-03-29 21:45:57.373676 (Thread-1): Compiling model.my_new_project.stg_customers
2021-03-29 21:45:57.379100 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_customers"
2021-03-29 21:45:57.396612 (Thread-1): finished collecting timing info
2021-03-29 21:45:57.401033 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_customers"
2021-03-29 21:45:57.418453 (Thread-1): Opening a new connection, currently in state closed
2021-03-29 21:45:57.418879 (Thread-1): On model.my_new_project.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.stg_customers"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
  OPTIONS()
  as with customers as (
    
    select 
        id as customer_id,
        first_name,
        last_name

    from `finl-1067321-eds-thunderdome.maxm.customers`
)

select * from customers;


2021-03-29 21:45:57.956913 (Thread-1): finished collecting timing info
2021-03-29 21:45:57.957537 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29fe9f73-d681-484d-8f05-8f081c277296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2ffe1ee0>]}
2021-03-29 21:45:57.958660 (Thread-1): 21:45:57 | 2 of 3 OK created view model maxm.stg_customers...................... [CREATE VIEW in 0.58s]
2021-03-29 21:45:57.958744 (Thread-1): Finished running node model.my_new_project.stg_customers
2021-03-29 21:45:57.959505 (Thread-1): Began running node model.my_new_project.dim_customers
2021-03-29 21:45:57.960365 (Thread-1): 21:45:57 | 3 of 3 START table model maxm.dim_customers.......................... [RUN]
2021-03-29 21:45:57.960586 (Thread-1): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-03-29 21:45:57.960662 (Thread-1): Compiling model.my_new_project.dim_customers
2021-03-29 21:45:57.968951 (Thread-1): Writing injected SQL for node "model.my_new_project.dim_customers"
2021-03-29 21:45:57.986256 (Thread-1): finished collecting timing info
2021-03-29 21:45:58.002743 (Thread-1): Opening a new connection, currently in state closed
2021-03-29 21:45:58.199348 (Thread-1): Writing runtime SQL for node "model.my_new_project.dim_customers"
2021-03-29 21:45:58.222428 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.dim_customers"} */


  create or replace table `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers`
  
  
  OPTIONS()
  as (
    

with customers as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
),

orders as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`sgt_orders`
),

 customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-03-29 21:45:58.810617 (Thread-82): handling poll request
2021-03-29 21:45:58.811443 (Thread-82): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066dca0d0>]}
2021-03-29 21:45:58.815083 (Thread-82): sending response (<Response 12484 bytes [200 OK]>) to 10.0.47.191
2021-03-29 21:45:59.944407 (Thread-1): finished collecting timing info
2021-03-29 21:45:59.945308 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29fe9f73-d681-484d-8f05-8f081c277296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2e0dbaf0>]}
2021-03-29 21:45:59.946895 (Thread-1): 21:45:59 | 3 of 3 OK created table model maxm.dim_customers..................... [CREATE TABLE (100.0 rows, 4.3 KB processed) in 1.98s]
2021-03-29 21:45:59.947013 (Thread-1): Finished running node model.my_new_project.dim_customers
2021-03-29 21:45:59.948418 (MainThread): Acquiring new bigquery connection "master".
2021-03-29 21:45:59.948786 (MainThread): 21:45:59 | 
2021-03-29 21:45:59.948883 (MainThread): 21:45:59 | Finished running 2 view models, 1 table model in 4.11s.
2021-03-29 21:45:59.948956 (MainThread): Connection 'master' was properly closed.
2021-03-29 21:45:59.949024 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-03-29 21:45:59.988924 (MainThread): 
2021-03-29 21:45:59.989065 (MainThread): Completed successfully
2021-03-29 21:45:59.989128 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-03-29 21:46:00.377940 (Thread-83): handling poll request
2021-03-29 21:46:00.378361 (Thread-83): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c170520>]}
2021-03-29 21:46:00.387133 (Thread-83): sending response (<Response 13478 bytes [200 OK]>) to 10.0.22.169
2021-03-29 21:46:00.923748 (Thread-84): handling status request
2021-03-29 21:46:00.924165 (Thread-84): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066dc3b80>]}
2021-03-29 21:46:00.925211 (Thread-84): sending response (<Response 1178 bytes [200 OK]>) to 10.0.22.208
2021-03-29 21:46:35.674505 (Thread-85): handling status request
2021-03-29 21:46:35.674999 (Thread-85): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066dc24c0>]}
2021-03-29 21:46:35.675969 (Thread-85): sending response (<Response 1178 bytes [200 OK]>) to 10.0.33.179
2021-03-29 21:46:35.682002 (Thread-86): handling status request
2021-03-29 21:46:35.682290 (Thread-86): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066dc33d0>]}
2021-03-29 21:46:35.683117 (Thread-86): sending response (<Response 1178 bytes [200 OK]>) to 10.0.41.231
2021-03-29 21:46:36.222457 (Thread-87): handling docs.generate request
2021-03-29 21:46:36.222953 (Thread-87): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c4c2880>]}
2021-03-29 21:46:37.052244 (Thread-87): sending response (<Response 138 bytes [200 OK]>) to 10.0.1.13
2021-03-29 21:46:37.073138 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-29 21:46:37.073994 (MainThread): 
2021-03-29 21:46:37.074254 (MainThread): Acquiring new bigquery connection "master".
2021-03-29 21:46:37.081150 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome_maxm".
2021-03-29 21:46:37.081251 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-29 21:46:37.246993 (MainThread): 21:46:37 | Concurrency: 1 threads (target='default')
2021-03-29 21:46:37.247115 (MainThread): 21:46:37 | 
2021-03-29 21:46:37.248995 (Thread-1): Began running node model.my_new_project.sgt_orders
2021-03-29 21:46:37.249163 (Thread-1): Acquiring new bigquery connection "model.my_new_project.sgt_orders".
2021-03-29 21:46:37.249243 (Thread-1): Compiling model.my_new_project.sgt_orders
2021-03-29 21:46:37.299547 (Thread-1): Writing injected SQL for node "model.my_new_project.sgt_orders"
2021-03-29 21:46:37.315747 (Thread-1): finished collecting timing info
2021-03-29 21:46:37.316000 (Thread-1): finished collecting timing info
2021-03-29 21:46:37.316192 (Thread-1): Finished running node model.my_new_project.sgt_orders
2021-03-29 21:46:37.316287 (Thread-1): Began running node model.my_new_project.stg_customers
2021-03-29 21:46:37.316373 (Thread-1): Acquiring new bigquery connection "model.my_new_project.stg_customers".
2021-03-29 21:46:37.316429 (Thread-1): Compiling model.my_new_project.stg_customers
2021-03-29 21:46:37.321671 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_customers"
2021-03-29 21:46:37.340438 (Thread-1): finished collecting timing info
2021-03-29 21:46:37.340748 (Thread-1): finished collecting timing info
2021-03-29 21:46:37.340965 (Thread-1): Finished running node model.my_new_project.stg_customers
2021-03-29 21:46:37.341601 (Thread-1): Began running node model.my_new_project.dim_customers
2021-03-29 21:46:37.341730 (Thread-1): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-03-29 21:46:37.341793 (Thread-1): Compiling model.my_new_project.dim_customers
2021-03-29 21:46:37.351772 (Thread-1): Writing injected SQL for node "model.my_new_project.dim_customers"
2021-03-29 21:46:37.367358 (Thread-1): finished collecting timing info
2021-03-29 21:46:37.367588 (Thread-1): finished collecting timing info
2021-03-29 21:46:37.367777 (Thread-1): Finished running node model.my_new_project.dim_customers
2021-03-29 21:46:37.368740 (MainThread): Connection 'master' was properly closed.
2021-03-29 21:46:37.368823 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-03-29 21:46:37.411819 (MainThread): 21:46:37 | Done.
2021-03-29 21:46:37.483387 (MainThread): Acquiring new bigquery connection "generate_catalog".
2021-03-29 21:46:37.483495 (MainThread): 21:46:37 | Building catalog
2021-03-29 21:46:37.487673 (MainThread): Opening a new connection, currently in state init
2021-03-29 21:46:37.512087 (Thread-88): handling poll request
2021-03-29 21:46:37.512472 (Thread-88): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066eb0250>]}
2021-03-29 21:46:37.516508 (Thread-88): sending response (<Response 13067 bytes [200 OK]>) to 10.0.17.36
2021-03-29 21:46:37.669127 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "finl-1067321-eds-thunderdome.information_schema".
2021-03-29 21:46:37.683781 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-03-29 21:46:37.684140 (ThreadPoolExecutor-1_0): On finl-1067321-eds-thunderdome.information_schema: 
    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `finl-1067321-eds-thunderdome`.`maxm`.__TABLES__
        where (upper(dataset_id) = upper('maxm'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `finl-1067321-eds-thunderdome`.`maxm`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `finl-1067321-eds-thunderdome`.`maxm`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-03-29 21:46:38.979032 (Thread-89): handling poll request
2021-03-29 21:46:38.979502 (Thread-89): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4066dc3460>]}
2021-03-29 21:46:38.980724 (Thread-89): sending response (<Response 8253 bytes [200 OK]>) to 10.0.22.169
2021-03-29 21:46:40.183691 (MainThread): 21:46:40 | Catalog written to /usr/src/develop/user-18991/environment-23989/repository-19333/target/catalog.json
2021-03-29 21:46:40.587948 (Thread-90): handling poll request
2021-03-29 21:46:40.588556 (Thread-90): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c170130>]}
2021-03-29 21:46:40.591587 (Thread-90): sending response (<Response 3471 bytes [200 OK]>) to 10.0.1.13
2021-03-29 21:46:41.026000 (Thread-91): handling status request
2021-03-29 21:46:41.026442 (Thread-91): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6b828d3d-260a-452f-97d6-f7ec88445f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406c141610>]}
2021-03-29 21:46:41.027537 (Thread-91): sending response (<Response 1178 bytes [200 OK]>) to 10.0.7.19
2021-03-30 15:07:23.854504 (MainThread): Running with dbt=0.18.1
2021-03-30 15:07:24.024466 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-03-30 15:07:24.037011 (MainThread): Tracking: tracking
2021-03-30 15:07:24.059546 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb733b0df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727ff1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727ff1af0>]}
2021-03-30 15:07:24.059957 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=15
2021-03-30 15:07:24.060487 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-03-30 15:07:24.060895 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-03-30 15:07:24.062322 (Thread-1): Parsing macros/adapters.sql
2021-03-30 15:07:24.082568 (Thread-1): Parsing macros/etc.sql
2021-03-30 15:07:24.083961 (Thread-1): Parsing macros/catalog.sql
2021-03-30 15:07:24.090257 (Thread-1): Parsing macros/materializations/copy.sql
2021-03-30 15:07:24.095100 (Thread-1): Parsing macros/materializations/table.sql
2021-03-30 15:07:24.104901 (Thread-1): Parsing macros/materializations/incremental.sql
2021-03-30 15:07:24.117366 (Thread-1): Parsing macros/materializations/seed.sql
2021-03-30 15:07:24.120248 (Thread-1): Parsing macros/materializations/snapshot.sql
2021-03-30 15:07:24.122081 (Thread-1): Parsing macros/materializations/view.sql
2021-03-30 15:07:24.125556 (Thread-1): Parsing macros/core.sql
2021-03-30 15:07:24.129140 (Thread-1): Parsing macros/materializations/helpers.sql
2021-03-30 15:07:24.138010 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-03-30 15:07:24.151785 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 15:07:24.153554 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 15:07:24.169726 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 15:07:24.197697 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 15:07:24.202737 (Thread-1): Parsing macros/materializations/view/view.sql
2021-03-30 15:07:24.209010 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-03-30 15:07:24.230049 (Thread-1): Parsing macros/materializations/table/table.sql
2021-03-30 15:07:24.236629 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 15:07:24.238503 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 15:07:24.244734 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-03-30 15:07:24.247080 (Thread-1): Parsing macros/etc/query.sql
2021-03-30 15:07:24.248799 (Thread-1): Parsing macros/etc/datetime.sql
2021-03-30 15:07:24.263951 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-03-30 15:07:24.265607 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-03-30 15:07:24.268448 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-03-30 15:07:24.271854 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-03-30 15:07:24.274462 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 15:07:24.279008 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-03-30 15:07:24.282236 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-03-30 15:07:24.285161 (Thread-1): Parsing macros/adapters/common.sql
2021-03-30 15:07:24.345487 (Thread-1): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - my_new_project

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-30 15:07:24.345927 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72c050be0>]}
2021-03-30 15:07:24.412542 (Thread-1): Acquiring new bigquery connection "model.my_new_project.stg_customers".
2021-03-30 15:07:24.434560 (Thread-1): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-03-30 15:07:24.448433 (Thread-1): Acquiring new bigquery connection "model.my_new_project.sgt_orders".
2021-03-30 15:07:24.710498 (Thread-1): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-30 15:07:25.061060 (Thread-2): handling status request
2021-03-30 15:07:25.061584 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72c9b0790>]}
2021-03-30 15:07:25.066236 (Thread-2): sending response (<Response 11315 bytes [200 OK]>) to 10.0.7.248
2021-03-30 15:07:34.907964 (MainThread): Connection 'model.my_new_project.sgt_orders' was properly closed.
2021-03-30 15:07:34.943940 (Thread-3): project hash mismatch: values missing, cache invalidated: {'jaffle_shop'}
2021-03-30 15:07:34.945091 (Thread-3): Parsing macros/adapters.sql
2021-03-30 15:07:34.975988 (Thread-3): Parsing macros/etc.sql
2021-03-30 15:07:34.978002 (Thread-3): Parsing macros/catalog.sql
2021-03-30 15:07:34.988216 (Thread-3): Parsing macros/materializations/copy.sql
2021-03-30 15:07:34.995399 (Thread-3): Parsing macros/materializations/table.sql
2021-03-30 15:07:35.011390 (Thread-3): Parsing macros/materializations/incremental.sql
2021-03-30 15:07:35.032955 (Thread-3): Parsing macros/materializations/seed.sql
2021-03-30 15:07:35.037968 (Thread-3): Parsing macros/materializations/snapshot.sql
2021-03-30 15:07:35.040874 (Thread-3): Parsing macros/materializations/view.sql
2021-03-30 15:07:35.051637 (Thread-3): Parsing macros/core.sql
2021-03-30 15:07:35.057414 (Thread-3): Parsing macros/materializations/helpers.sql
2021-03-30 15:07:35.072134 (Thread-3): Parsing macros/materializations/common/merge.sql
2021-03-30 15:07:35.095127 (Thread-3): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 15:07:35.098084 (Thread-3): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 15:07:35.124757 (Thread-3): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 15:07:35.172782 (Thread-3): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 15:07:35.180804 (Thread-3): Parsing macros/materializations/view/view.sql
2021-03-30 15:07:35.191136 (Thread-3): Parsing macros/materializations/seed/seed.sql
2021-03-30 15:07:35.225486 (Thread-3): Parsing macros/materializations/table/table.sql
2021-03-30 15:07:35.236654 (Thread-3): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 15:07:35.239837 (Thread-3): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 15:07:35.250041 (Thread-3): Parsing macros/etc/is_incremental.sql
2021-03-30 15:07:35.252821 (Thread-3): Parsing macros/etc/query.sql
2021-03-30 15:07:35.254644 (Thread-3): Parsing macros/etc/datetime.sql
2021-03-30 15:07:35.269813 (Thread-3): Parsing macros/etc/get_custom_alias.sql
2021-03-30 15:07:35.271371 (Thread-3): Parsing macros/etc/get_custom_database.sql
2021-03-30 15:07:35.274063 (Thread-3): Parsing macros/etc/get_custom_schema.sql
2021-03-30 15:07:35.277277 (Thread-3): Parsing macros/schema_tests/not_null.sql
2021-03-30 15:07:35.279734 (Thread-3): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 15:07:35.284224 (Thread-3): Parsing macros/schema_tests/relationships.sql
2021-03-30 15:07:35.287306 (Thread-3): Parsing macros/schema_tests/unique.sql
2021-03-30 15:07:35.290122 (Thread-3): Parsing macros/adapters/common.sql
2021-03-30 15:07:35.376148 (Thread-3): project hash mismatch: values missing, cache invalidated: {'jaffle_shop'}
2021-03-30 15:07:35.410083 (Thread-3): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 15:07:35.419005 (Thread-3): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:07:35.433471 (Thread-3): Acquiring new bigquery connection "model.jaffle_shop.sgt_orders".
2021-03-30 15:07:35.506941 (Thread-4): handling status request
2021-03-30 15:07:35.507331 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7271534f0>]}
2021-03-30 15:07:35.508075 (Thread-4): sending response (<Response 185 bytes [200 OK]>) to 10.0.42.64
2021-03-30 15:07:35.597976 (Thread-3): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-30 15:07:37.030974 (Thread-5): handling status request
2021-03-30 15:07:37.031479 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72c9490d0>]}
2021-03-30 15:07:37.035101 (Thread-5): sending response (<Response 10814 bytes [200 OK]>) to 10.0.1.181
2021-03-30 15:07:59.808682 (MainThread): Connection 'model.jaffle_shop.sgt_orders' was properly closed.
2021-03-30 15:07:59.874178 (Thread-6): Got an acceptable cached parse result
2021-03-30 15:08:00.140568 (Thread-6): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-30 15:08:00.210405 (Thread-7): handling status request
2021-03-30 15:08:00.210973 (Thread-7): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7268bbd00>]}
2021-03-30 15:08:00.212288 (Thread-7): sending response (<Response 875 bytes [200 OK]>) to 10.0.7.248
2021-03-30 15:08:20.758177 (Thread-8): Got an acceptable cached parse result
2021-03-30 15:08:21.097466 (Thread-8): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-30 15:08:21.113662 (Thread-9): handling status request
2021-03-30 15:08:21.114109 (Thread-9): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726873bb0>]}
2021-03-30 15:08:21.115032 (Thread-9): sending response (<Response 875 bytes [200 OK]>) to 10.0.27.28
2021-03-30 15:08:57.930411 (Thread-10): Got an acceptable cached parse result
2021-03-30 15:08:58.141405 (Thread-10): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-30 15:08:58.356008 (Thread-11): handling status request
2021-03-30 15:08:58.356434 (Thread-11): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727118b20>]}
2021-03-30 15:08:58.357338 (Thread-11): sending response (<Response 877 bytes [200 OK]>) to 10.0.37.31
2021-03-30 15:09:14.935126 (Thread-12): Got an acceptable cached parse result
2021-03-30 15:09:15.207066 (Thread-12): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-30 15:09:16.108348 (Thread-13): handling status request
2021-03-30 15:09:16.108786 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7272aa640>]}
2021-03-30 15:09:16.109768 (Thread-13): sending response (<Response 877 bytes [200 OK]>) to 10.0.1.181
2021-03-30 15:10:04.555419 (Thread-14): Got an acceptable cached parse result
2021-03-30 15:10:04.894091 (Thread-14): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-30 15:10:04.930043 (Thread-15): handling status request
2021-03-30 15:10:04.930482 (Thread-15): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727ff6940>]}
2021-03-30 15:10:04.931471 (Thread-15): sending response (<Response 877 bytes [200 OK]>) to 10.0.38.35
2021-03-30 15:10:30.808602 (Thread-16): Got an acceptable cached parse result
2021-03-30 15:10:31.036505 (Thread-16): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-30 15:10:31.204119 (Thread-17): handling status request
2021-03-30 15:10:31.204547 (Thread-17): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7272b1a00>]}
2021-03-30 15:10:31.205489 (Thread-17): sending response (<Response 877 bytes [200 OK]>) to 10.0.37.31
2021-03-30 15:28:53.268546 (Thread-18): Got an acceptable cached parse result
2021-03-30 15:28:53.484308 (Thread-18): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-30 15:28:53.630126 (Thread-19): handling status request
2021-03-30 15:28:53.630534 (Thread-19): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727163880>]}
2021-03-30 15:28:53.631434 (Thread-19): sending response (<Response 877 bytes [200 OK]>) to 10.0.3.45
2021-03-30 15:29:05.425014 (Thread-20): Got an acceptable cached parse result
2021-03-30 15:29:05.815097 (Thread-21): handling status request
2021-03-30 15:29:05.827145 (Thread-20): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-30 15:29:05.827634 (Thread-21): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267af160>]}
2021-03-30 15:29:05.830427 (Thread-21): sending response (<Response 877 bytes [200 OK]>) to 10.0.18.81
2021-03-30 15:29:47.648983 (Thread-22): Got an acceptable cached parse result
2021-03-30 15:29:47.851866 (Thread-22): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-03-30 15:29:48.081835 (Thread-23): handling status request
2021-03-30 15:29:48.082481 (Thread-23): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7271638e0>]}
2021-03-30 15:29:48.083664 (Thread-23): sending response (<Response 877 bytes [200 OK]>) to 10.0.34.79
2021-03-30 15:30:29.198384 (Thread-24): For key jaffle_shop, hash mismatch (FileHash(name='sha256', checksum='59c08485966af504c33a057cd9ef4849b9e60a0a454c29cc3834f141a4f51202') -> FileHash(name='sha256', checksum='be6c0e7ea0ff309c87315d2b3288c79c49638f4335b77721119f7b54ba5195c7')), cache invalidated
2021-03-30 15:30:29.199210 (Thread-24): Parsing macros/adapters.sql
2021-03-30 15:30:29.219440 (Thread-24): Parsing macros/etc.sql
2021-03-30 15:30:29.220901 (Thread-24): Parsing macros/catalog.sql
2021-03-30 15:30:29.227379 (Thread-24): Parsing macros/materializations/copy.sql
2021-03-30 15:30:29.232569 (Thread-24): Parsing macros/materializations/table.sql
2021-03-30 15:30:29.245215 (Thread-24): Parsing macros/materializations/incremental.sql
2021-03-30 15:30:29.261938 (Thread-24): Parsing macros/materializations/seed.sql
2021-03-30 15:30:29.266286 (Thread-24): Parsing macros/materializations/snapshot.sql
2021-03-30 15:30:29.268913 (Thread-24): Parsing macros/materializations/view.sql
2021-03-30 15:30:29.275610 (Thread-24): Parsing macros/core.sql
2021-03-30 15:30:29.279618 (Thread-24): Parsing macros/materializations/helpers.sql
2021-03-30 15:30:29.289267 (Thread-24): Parsing macros/materializations/common/merge.sql
2021-03-30 15:30:29.304587 (Thread-24): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 15:30:29.306571 (Thread-24): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 15:30:29.323648 (Thread-24): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 15:30:29.354643 (Thread-24): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 15:30:29.359690 (Thread-24): Parsing macros/materializations/view/view.sql
2021-03-30 15:30:29.367341 (Thread-24): Parsing macros/materializations/seed/seed.sql
2021-03-30 15:30:29.391089 (Thread-24): Parsing macros/materializations/table/table.sql
2021-03-30 15:30:29.397953 (Thread-24): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 15:30:29.399891 (Thread-24): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 15:30:29.406140 (Thread-24): Parsing macros/etc/is_incremental.sql
2021-03-30 15:30:29.407868 (Thread-24): Parsing macros/etc/query.sql
2021-03-30 15:30:29.409008 (Thread-24): Parsing macros/etc/datetime.sql
2021-03-30 15:30:29.417841 (Thread-24): Parsing macros/etc/get_custom_alias.sql
2021-03-30 15:30:29.418793 (Thread-24): Parsing macros/etc/get_custom_database.sql
2021-03-30 15:30:29.420424 (Thread-24): Parsing macros/etc/get_custom_schema.sql
2021-03-30 15:30:29.422413 (Thread-24): Parsing macros/schema_tests/not_null.sql
2021-03-30 15:30:29.423911 (Thread-24): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 15:30:29.426633 (Thread-24): Parsing macros/schema_tests/relationships.sql
2021-03-30 15:30:29.428581 (Thread-24): Parsing macros/schema_tests/unique.sql
2021-03-30 15:30:29.430473 (Thread-24): Parsing macros/adapters/common.sql
2021-03-30 15:30:29.487019 (Thread-24): For key jaffle_shop, hash mismatch (FileHash(name='sha256', checksum='59c08485966af504c33a057cd9ef4849b9e60a0a454c29cc3834f141a4f51202') -> FileHash(name='sha256', checksum='be6c0e7ea0ff309c87315d2b3288c79c49638f4335b77721119f7b54ba5195c7')), cache invalidated
2021-03-30 15:30:29.520927 (Thread-24): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 15:30:29.528916 (Thread-24): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:30:29.539542 (Thread-24): Acquiring new bigquery connection "model.jaffle_shop.sgt_orders".
2021-03-30 15:30:29.654193 (Thread-25): handling status request
2021-03-30 15:30:29.654619 (Thread-25): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727253d90>]}
2021-03-30 15:30:29.655341 (Thread-25): sending response (<Response 185 bytes [200 OK]>) to 10.0.33.160
2021-03-30 15:30:29.711871 (Thread-24): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.marts
- models.jaffle_shop.staging

2021-03-30 15:30:31.350795 (Thread-26): handling status request
2021-03-30 15:30:31.351228 (Thread-26): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7268311f0>]}
2021-03-30 15:30:31.354756 (Thread-26): sending response (<Response 11251 bytes [200 OK]>) to 10.0.22.23
2021-03-30 15:31:31.915229 (Thread-27): handling status request
2021-03-30 15:31:31.915647 (Thread-27): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7271ac460>]}
2021-03-30 15:31:31.919144 (Thread-27): sending response (<Response 11251 bytes [200 OK]>) to 10.0.37.31
2021-03-30 15:31:32.451064 (Thread-28): handling run_sql request
2021-03-30 15:31:32.451589 (Thread-28): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72686a520>]}
2021-03-30 15:31:32.454602 (Thread-28): Connection 'model.jaffle_shop.sgt_orders' was properly closed.
2021-03-30 15:31:33.429407 (Thread-28): sending response (<Response 138 bytes [200 OK]>) to 10.0.38.35
2021-03-30 15:31:33.455962 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:31:33.518566 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 15:31:33.519084 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:31:33.519196 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 15:31:33.532919 (Thread-1): finished collecting timing info
2021-03-30 15:31:33.533182 (Thread-1): Opening a new connection, currently in state init
2021-03-30 15:31:33.533756 (Thread-1): On rpc.jaffle_shop.request: select * from `finl-1067321-eds-thunderdome.maxmpayments` limit 100
2021-03-30 15:31:33.990283 (Thread-29): handling poll request
2021-03-30 15:31:33.991321 (Thread-29): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727522190>]}
2021-03-30 15:31:33.994591 (Thread-29): sending response (<Response 2611 bytes [200 OK]>) to 10.0.42.64
2021-03-30 15:31:34.102035 (Thread-1): Unhandled error while running:
select * from `finl-1067321-eds-thunderdome.maxmpayments` limit 100
2021-03-30 15:31:34.102257 (Thread-1): finished collecting timing info
2021-03-30 15:31:34.102513 (Thread-1): Got an exception: Runtime Error
  404 Not found: Dataset finl-1067321-eds-thunderdome:finl-1067321-eds-thunderdome was not found in location US
  
  (job ID: 4b8735b3-d6ff-40dd-8e14-bff4948fbe18)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Dataset finl-1067321-eds-thunderdome:finl-1067321-eds-thunderdome was not found in location US

(job ID: 4b8735b3-d6ff-40dd-8e14-bff4948fbe18)

                    -----Query Job SQL Follows-----                     

    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:select * from `finl-1067321-eds-thunderdome.maxmpayments` limit 100
    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 134, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error
  404 Not found: Dataset finl-1067321-eds-thunderdome:finl-1067321-eds-thunderdome was not found in location US
  
  (job ID: 4b8735b3-d6ff-40dd-8e14-bff4948fbe18)
2021-03-30 15:31:34.105544 (Thread-1): Got exception RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 Not found: Dataset finl-1067321-eds-thunderdome:finl-1067321-eds-thunderdome was not found in location US\n  \n  (job ID: 4b8735b3-d6ff-40dd-8e14-bff4948fbe18)', 'raw_sql': 'select * from `finl-1067321-eds-thunderdome.maxmpayments` limit 100', 'compiled_sql': 'select * from `finl-1067321-eds-thunderdome.maxmpayments` limit 100', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 Not found: Dataset finl-1067321-eds-thunderdome:finl-1067321-eds-thunderdome was not found in location US\n  \n  (job ID: 4b8735b3-d6ff-40dd-8e14-bff4948fbe18)', 'raw_sql': 'select * from `finl-1067321-eds-thunderdome.maxmpayments` limit 100', 'compiled_sql': 'select * from `finl-1067321-eds-thunderdome.maxmpayments` limit 100', 'tags': None}, None)
2021-03-30 15:31:35.445463 (Thread-30): handling poll request
2021-03-30 15:31:35.445960 (Thread-30): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726831a30>]}
2021-03-30 15:31:35.446845 (Thread-30): sending response (<Response 9269 bytes [200 OK]>) to 10.0.26.97
2021-03-30 15:31:51.379234 (Thread-31): handling status request
2021-03-30 15:31:51.379662 (Thread-31): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727105400>]}
2021-03-30 15:31:51.383320 (Thread-31): sending response (<Response 11251 bytes [200 OK]>) to 10.0.1.181
2021-03-30 15:31:51.822141 (Thread-32): handling run_sql request
2021-03-30 15:31:51.822557 (Thread-32): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7271056d0>]}
2021-03-30 15:31:52.690576 (Thread-32): sending response (<Response 138 bytes [200 OK]>) to 10.0.26.97
2021-03-30 15:31:52.710431 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:31:52.789410 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 15:31:52.790051 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:31:52.790180 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 15:31:52.806247 (Thread-1): finished collecting timing info
2021-03-30 15:31:52.806585 (Thread-1): Opening a new connection, currently in state init
2021-03-30 15:31:52.807159 (Thread-1): On rpc.jaffle_shop.request: select * from `finl-1067321-eds-thunderdome.maxm.payments` limit 100
2021-03-30 15:31:53.132428 (Thread-33): handling poll request
2021-03-30 15:31:53.132891 (Thread-33): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7271135b0>]}
2021-03-30 15:31:53.135042 (Thread-33): sending response (<Response 2611 bytes [200 OK]>) to 10.0.1.181
2021-03-30 15:31:53.922369 (Thread-1): finished collecting timing info
2021-03-30 15:31:54.605388 (Thread-34): handling poll request
2021-03-30 15:31:54.605848 (Thread-34): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7271139a0>]}
2021-03-30 15:31:54.610853 (Thread-34): sending response (<Response 8785 bytes [200 OK]>) to 10.0.27.42
2021-03-30 15:32:29.118324 (Thread-35): Got an acceptable cached parse result
2021-03-30 15:32:29.350147 (Thread-35): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.marts
- models.jaffle_shop.staging

2021-03-30 15:32:29.686742 (Thread-36): handling status request
2021-03-30 15:32:29.687167 (Thread-36): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72732c9d0>]}
2021-03-30 15:32:29.688346 (Thread-36): sending response (<Response 902 bytes [200 OK]>) to 10.0.15.161
2021-03-30 15:32:37.333461 (Thread-37): Got an acceptable cached parse result
2021-03-30 15:32:37.565332 (Thread-37): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.marts
- models.jaffle_shop.staging

2021-03-30 15:32:37.651419 (Thread-38): handling status request
2021-03-30 15:32:37.651836 (Thread-38): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7274e08b0>]}
2021-03-30 15:32:37.652754 (Thread-38): sending response (<Response 902 bytes [200 OK]>) to 10.0.3.45
2021-03-30 15:32:46.594236 (Thread-39): Got an acceptable cached parse result
2021-03-30 15:32:46.813354 (Thread-39): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.marts
- models.jaffle_shop.staging

2021-03-30 15:32:47.074377 (Thread-40): handling status request
2021-03-30 15:32:47.074852 (Thread-40): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727574700>]}
2021-03-30 15:32:47.075752 (Thread-40): sending response (<Response 902 bytes [200 OK]>) to 10.0.22.23
2021-03-30 15:33:20.158837 (Thread-41): Got an acceptable cached parse result
2021-03-30 15:33:20.485742 (Thread-41): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.marts
- models.jaffle_shop.staging

2021-03-30 15:33:20.516475 (Thread-42): handling status request
2021-03-30 15:33:20.517068 (Thread-42): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7274f5b80>]}
2021-03-30 15:33:20.518452 (Thread-42): sending response (<Response 902 bytes [200 OK]>) to 10.0.5.204
2021-03-30 15:33:37.983238 (Thread-43): Got an acceptable cached parse result
2021-03-30 15:33:38.185179 (Thread-43): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.marts
- models.jaffle_shop.staging

2021-03-30 15:33:38.338157 (Thread-44): handling status request
2021-03-30 15:33:38.338598 (Thread-44): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7274f5220>]}
2021-03-30 15:33:38.339506 (Thread-44): sending response (<Response 902 bytes [200 OK]>) to 10.0.5.204
2021-03-30 15:35:30.020937 (Thread-45): Got an acceptable cached parse result
2021-03-30 15:35:30.237653 (Thread-45): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.marts
- models.jaffle_shop.staging

2021-03-30 15:35:30.412197 (Thread-46): handling status request
2021-03-30 15:35:30.412624 (Thread-46): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72662f5e0>]}
2021-03-30 15:35:30.439154 (Thread-46): sending response (<Response 902 bytes [200 OK]>) to 10.0.27.28
2021-03-30 15:35:47.385220 (Thread-47): Got an acceptable cached parse result
2021-03-30 15:35:47.604494 (Thread-47): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.marts
- models.jaffle_shop.staging

2021-03-30 15:35:47.832182 (Thread-48): handling status request
2021-03-30 15:35:47.832615 (Thread-48): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267a4070>]}
2021-03-30 15:35:47.833558 (Thread-48): sending response (<Response 902 bytes [200 OK]>) to 10.0.37.31
2021-03-30 15:36:08.223023 (Thread-49): Got an acceptable cached parse result
2021-03-30 15:36:08.415456 (Thread-49): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.marts
- models.jaffle_shop.staging

2021-03-30 15:36:08.526263 (Thread-50): handling status request
2021-03-30 15:36:08.526702 (Thread-50): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267d1c70>]}
2021-03-30 15:36:08.527697 (Thread-50): sending response (<Response 902 bytes [200 OK]>) to 10.0.34.79
2021-03-30 15:36:20.115673 (Thread-51): handling status request
2021-03-30 15:36:20.116090 (Thread-51): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267a44f0>]}
2021-03-30 15:36:20.116974 (Thread-51): sending response (<Response 902 bytes [200 OK]>) to 10.0.3.45
2021-03-30 15:36:20.155497 (Thread-52): handling status request
2021-03-30 15:36:20.155870 (Thread-52): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72727b6a0>]}
2021-03-30 15:36:20.156714 (Thread-52): sending response (<Response 902 bytes [200 OK]>) to 10.0.42.64
2021-03-30 15:36:20.594889 (Thread-53): handling cli_args request
2021-03-30 15:36:20.595302 (Thread-53): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7273fda90>]}
2021-03-30 15:36:21.490377 (Thread-53): sending response (<Response 138 bytes [200 OK]>) to 10.0.5.204
2021-03-30 15:36:21.544099 (MainThread): Partial parsing not enabled
2021-03-30 15:36:21.545341 (MainThread): Parsing macros/adapters.sql
2021-03-30 15:36:21.565350 (MainThread): Parsing macros/etc.sql
2021-03-30 15:36:21.566756 (MainThread): Parsing macros/catalog.sql
2021-03-30 15:36:21.572787 (MainThread): Parsing macros/materializations/copy.sql
2021-03-30 15:36:21.607765 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 15:36:21.617625 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 15:36:21.630102 (MainThread): Parsing macros/materializations/seed.sql
2021-03-30 15:36:21.633034 (MainThread): Parsing macros/materializations/snapshot.sql
2021-03-30 15:36:21.634934 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 15:36:21.638538 (MainThread): Parsing macros/core.sql
2021-03-30 15:36:21.642199 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 15:36:21.651320 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 15:36:21.665873 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 15:36:21.667767 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 15:36:21.684411 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 15:36:21.712779 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 15:36:21.717901 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 15:36:21.724189 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 15:36:21.744651 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 15:36:21.751319 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 15:36:21.753206 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 15:36:21.759272 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 15:36:21.760925 (MainThread): Parsing macros/etc/query.sql
2021-03-30 15:36:21.762054 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 15:36:21.770860 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 15:36:21.772374 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 15:36:21.774828 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 15:36:21.777162 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 15:36:21.778864 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 15:36:21.781612 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 15:36:21.783583 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 15:36:21.785411 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 15:36:21.833854 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-30 15:36:21.833989 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e67cd22d-c19e-46ef-a8d5-b7817bba84dc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe180192b0>]}
2021-03-30 15:36:21.837014 (MainThread): Partial parsing not enabled
2021-03-30 15:36:21.890382 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 15:36:21.907783 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:36:21.918919 (Thread-54): handling poll request
2021-03-30 15:36:21.919376 (Thread-54): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7272646d0>]}
2021-03-30 15:36:21.924075 (Thread-54): sending response (<Response 11317 bytes [200 OK]>) to 10.0.27.42
2021-03-30 15:36:21.918226 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.sgt_orders".
2021-03-30 15:36:22.068940 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.staging
- models.jaffle_shop.marts

2021-03-30 15:36:22.088741 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 15:36:22.089429 (MainThread): 
2021-03-30 15:36:22.089752 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 15:36:22.093775 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome".
2021-03-30 15:36:22.093940 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 15:36:22.294444 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome_maxm".
2021-03-30 15:36:22.294590 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-30 15:36:22.517701 (MainThread): 15:36:22 | Concurrency: 1 threads (target='default')
2021-03-30 15:36:22.517879 (MainThread): 15:36:22 | 
2021-03-30 15:36:22.520689 (Thread-1): Began running node model.jaffle_shop.sgt_orders
2021-03-30 15:36:22.522058 (Thread-1): 15:36:22 | 1 of 3 START view model maxm.sgt_orders.............................. [RUN]
2021-03-30 15:36:22.522380 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.sgt_orders".
2021-03-30 15:36:22.522473 (Thread-1): Compiling model.jaffle_shop.sgt_orders
2021-03-30 15:36:22.535826 (Thread-1): Writing injected SQL for node "model.jaffle_shop.sgt_orders"
2021-03-30 15:36:22.563140 (Thread-1): finished collecting timing info
2021-03-30 15:36:22.595490 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.sgt_orders"
2021-03-30 15:36:22.621501 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 15:36:22.622034 (Thread-1): On model.jaffle_shop.sgt_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.sgt_orders"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`sgt_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `finl-1067321-eds-thunderdome.maxm.orders`
)

select * from orders;


2021-03-30 15:36:23.311816 (Thread-1): finished collecting timing info
2021-03-30 15:36:23.312406 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e67cd22d-c19e-46ef-a8d5-b7817bba84dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe17563820>]}
2021-03-30 15:36:23.313359 (Thread-1): 15:36:23 | 1 of 3 OK created view model maxm.sgt_orders......................... [CREATE VIEW in 0.79s]
2021-03-30 15:36:23.313443 (Thread-1): Finished running node model.jaffle_shop.sgt_orders
2021-03-30 15:36:23.313553 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-03-30 15:36:23.314380 (Thread-1): 15:36:23 | 2 of 3 START view model maxm.stg_customers........................... [RUN]
2021-03-30 15:36:23.314577 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 15:36:23.314646 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-03-30 15:36:23.319968 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-03-30 15:36:23.332887 (Thread-1): finished collecting timing info
2021-03-30 15:36:23.336849 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-03-30 15:36:23.349993 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 15:36:23.350344 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
  OPTIONS()
  as with customers as (
    
    select 
        id as customer_id,
        first_name,
        last_name

    from `finl-1067321-eds-thunderdome.maxm.customers`
)

select * from customers;


2021-03-30 15:36:23.440666 (Thread-55): handling poll request
2021-03-30 15:36:23.441075 (Thread-55): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727267070>]}
2021-03-30 15:36:23.444519 (Thread-55): sending response (<Response 13250 bytes [200 OK]>) to 10.0.33.81
2021-03-30 15:36:23.913303 (Thread-1): finished collecting timing info
2021-03-30 15:36:23.914330 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e67cd22d-c19e-46ef-a8d5-b7817bba84dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe166bdf70>]}
2021-03-30 15:36:23.915675 (Thread-1): 15:36:23 | 2 of 3 OK created view model maxm.stg_customers...................... [CREATE VIEW in 0.60s]
2021-03-30 15:36:23.915767 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-03-30 15:36:23.916552 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-03-30 15:36:23.917422 (Thread-1): 15:36:23 | 3 of 3 START table model maxm.dim_customers.......................... [RUN]
2021-03-30 15:36:23.917640 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:36:23.917748 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-03-30 15:36:23.927403 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-03-30 15:36:23.941625 (Thread-1): finished collecting timing info
2021-03-30 15:36:23.959926 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 15:36:24.170549 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-03-30 15:36:24.187383 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers`
  
  
  OPTIONS()
  as (
    

with customers as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
),

orders as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`sgt_orders`
),

 customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-03-30 15:36:24.866976 (Thread-56): handling poll request
2021-03-30 15:36:24.867384 (Thread-56): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727567b80>]}
2021-03-30 15:36:24.869285 (Thread-56): sending response (<Response 6692 bytes [200 OK]>) to 10.0.7.248
2021-03-30 15:36:26.089389 (Thread-1): finished collecting timing info
2021-03-30 15:36:26.090074 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e67cd22d-c19e-46ef-a8d5-b7817bba84dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe14e3a700>]}
2021-03-30 15:36:26.091258 (Thread-1): 15:36:26 | 3 of 3 OK created table model maxm.dim_customers..................... [CREATE TABLE (100.0 rows, 4.3 KB processed) in 2.17s]
2021-03-30 15:36:26.091348 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-03-30 15:36:26.092810 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 15:36:26.093073 (MainThread): 15:36:26 | 
2021-03-30 15:36:26.093135 (MainThread): 15:36:26 | Finished running 2 view models, 1 table model in 4.00s.
2021-03-30 15:36:26.093181 (MainThread): Connection 'master' was properly closed.
2021-03-30 15:36:26.093220 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:36:26.133808 (MainThread): 
2021-03-30 15:36:26.133941 (MainThread): Completed successfully
2021-03-30 15:36:26.134004 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-03-30 15:36:26.627357 (Thread-57): handling poll request
2021-03-30 15:36:26.627780 (Thread-57): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72755ce50>]}
2021-03-30 15:36:26.637023 (Thread-57): sending response (<Response 13416 bytes [200 OK]>) to 10.0.2.124
2021-03-30 15:36:27.139690 (Thread-58): handling status request
2021-03-30 15:36:27.140242 (Thread-58): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7270fd610>]}
2021-03-30 15:36:27.141269 (Thread-58): sending response (<Response 902 bytes [200 OK]>) to 10.0.22.23
2021-03-30 15:38:16.698291 (Thread-59): For key jaffle_shop, hash mismatch (FileHash(name='sha256', checksum='be6c0e7ea0ff309c87315d2b3288c79c49638f4335b77721119f7b54ba5195c7') -> FileHash(name='sha256', checksum='ec6ad40adc5f430903f933151aeaf3c2e376f2dc9acdf0373a6df0801baab593')), cache invalidated
2021-03-30 15:38:16.700773 (Thread-59): Parsing macros/adapters.sql
2021-03-30 15:38:16.720828 (Thread-59): Parsing macros/etc.sql
2021-03-30 15:38:16.722154 (Thread-59): Parsing macros/catalog.sql
2021-03-30 15:38:16.728476 (Thread-59): Parsing macros/materializations/copy.sql
2021-03-30 15:38:16.732795 (Thread-59): Parsing macros/materializations/table.sql
2021-03-30 15:38:16.747804 (Thread-59): Parsing macros/materializations/incremental.sql
2021-03-30 15:38:16.761391 (Thread-59): Parsing macros/materializations/seed.sql
2021-03-30 15:38:16.764150 (Thread-59): Parsing macros/materializations/snapshot.sql
2021-03-30 15:38:16.765988 (Thread-59): Parsing macros/materializations/view.sql
2021-03-30 15:38:16.769437 (Thread-59): Parsing macros/core.sql
2021-03-30 15:38:16.773510 (Thread-59): Parsing macros/materializations/helpers.sql
2021-03-30 15:38:16.786389 (Thread-59): Parsing macros/materializations/common/merge.sql
2021-03-30 15:38:16.802429 (Thread-59): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 15:38:16.804258 (Thread-59): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 15:38:16.820508 (Thread-59): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 15:38:16.861527 (Thread-59): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 15:38:16.866807 (Thread-59): Parsing macros/materializations/view/view.sql
2021-03-30 15:38:16.873032 (Thread-59): Parsing macros/materializations/seed/seed.sql
2021-03-30 15:38:16.893786 (Thread-59): Parsing macros/materializations/table/table.sql
2021-03-30 15:38:16.900487 (Thread-59): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 15:38:16.902354 (Thread-59): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 15:38:16.908400 (Thread-59): Parsing macros/etc/is_incremental.sql
2021-03-30 15:38:16.910146 (Thread-59): Parsing macros/etc/query.sql
2021-03-30 15:38:16.911202 (Thread-59): Parsing macros/etc/datetime.sql
2021-03-30 15:38:16.920186 (Thread-59): Parsing macros/etc/get_custom_alias.sql
2021-03-30 15:38:16.921232 (Thread-59): Parsing macros/etc/get_custom_database.sql
2021-03-30 15:38:16.922888 (Thread-59): Parsing macros/etc/get_custom_schema.sql
2021-03-30 15:38:16.924826 (Thread-59): Parsing macros/schema_tests/not_null.sql
2021-03-30 15:38:16.926359 (Thread-59): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 15:38:16.928970 (Thread-59): Parsing macros/schema_tests/relationships.sql
2021-03-30 15:38:16.931450 (Thread-59): Parsing macros/schema_tests/unique.sql
2021-03-30 15:38:16.933184 (Thread-59): Parsing macros/adapters/common.sql
2021-03-30 15:38:16.987582 (Thread-59): For key jaffle_shop, hash mismatch (FileHash(name='sha256', checksum='be6c0e7ea0ff309c87315d2b3288c79c49638f4335b77721119f7b54ba5195c7') -> FileHash(name='sha256', checksum='ec6ad40adc5f430903f933151aeaf3c2e376f2dc9acdf0373a6df0801baab593')), cache invalidated
2021-03-30 15:38:17.021720 (Thread-59): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 15:38:17.029481 (Thread-59): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:38:17.040404 (Thread-59): Acquiring new bigquery connection "model.jaffle_shop.sgt_orders".
2021-03-30 15:38:17.086322 (Thread-60): handling status request
2021-03-30 15:38:17.086857 (Thread-60): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7271872b0>]}
2021-03-30 15:38:17.087699 (Thread-60): sending response (<Response 185 bytes [200 OK]>) to 10.0.15.161
2021-03-30 15:38:17.199724 (Thread-59): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.staging
- models.jaffle_shop.marts/core

2021-03-30 15:38:18.786737 (Thread-61): handling status request
2021-03-30 15:38:18.787172 (Thread-61): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7272cd400>]}
2021-03-30 15:38:18.790659 (Thread-61): sending response (<Response 11256 bytes [200 OK]>) to 10.0.26.97
2021-03-30 15:38:20.656187 (Thread-62): handling status request
2021-03-30 15:38:20.656608 (Thread-62): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72743d5b0>]}
2021-03-30 15:38:20.660068 (Thread-62): sending response (<Response 11256 bytes [200 OK]>) to 10.0.5.204
2021-03-30 15:38:20.669847 (Thread-63): handling status request
2021-03-30 15:38:20.670221 (Thread-63): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72743d4c0>]}
2021-03-30 15:38:20.673569 (Thread-63): sending response (<Response 11256 bytes [200 OK]>) to 10.0.33.81
2021-03-30 15:38:21.146639 (Thread-64): handling cli_args request
2021-03-30 15:38:21.147056 (Thread-64): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72743dfa0>]}
2021-03-30 15:38:21.157678 (Thread-64): Connection 'model.jaffle_shop.sgt_orders' was properly closed.
2021-03-30 15:38:22.012289 (Thread-64): sending response (<Response 138 bytes [200 OK]>) to 10.0.18.81
2021-03-30 15:38:22.092922 (MainThread): Partial parsing not enabled
2021-03-30 15:38:22.094219 (MainThread): Parsing macros/adapters.sql
2021-03-30 15:38:22.114713 (MainThread): Parsing macros/etc.sql
2021-03-30 15:38:22.116128 (MainThread): Parsing macros/catalog.sql
2021-03-30 15:38:22.122282 (MainThread): Parsing macros/materializations/copy.sql
2021-03-30 15:38:22.163480 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 15:38:22.174349 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 15:38:22.187278 (MainThread): Parsing macros/materializations/seed.sql
2021-03-30 15:38:22.190178 (MainThread): Parsing macros/materializations/snapshot.sql
2021-03-30 15:38:22.192149 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 15:38:22.195833 (MainThread): Parsing macros/core.sql
2021-03-30 15:38:22.199647 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 15:38:22.208861 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 15:38:22.222921 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 15:38:22.224908 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 15:38:22.242818 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 15:38:22.272003 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 15:38:22.277059 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 15:38:22.283389 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 15:38:22.303856 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 15:38:22.310476 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 15:38:22.312360 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 15:38:22.318347 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 15:38:22.320008 (MainThread): Parsing macros/etc/query.sql
2021-03-30 15:38:22.321130 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 15:38:22.329954 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 15:38:22.330999 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 15:38:22.332773 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 15:38:22.334850 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 15:38:22.336428 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 15:38:22.339151 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 15:38:22.341074 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 15:38:22.342934 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 15:38:22.390909 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-30 15:38:22.391044 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f605c99-bcb3-44a9-a84e-760cac245c17', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f188d2495e0>]}
2021-03-30 15:38:22.394036 (MainThread): Partial parsing not enabled
2021-03-30 15:38:22.444309 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 15:38:22.461305 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:38:22.471559 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.sgt_orders".
2021-03-30 15:38:22.557885 (Thread-65): handling poll request
2021-03-30 15:38:22.558368 (Thread-65): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72743da30>]}
2021-03-30 15:38:22.562782 (Thread-65): sending response (<Response 11617 bytes [200 OK]>) to 10.0.27.42
2021-03-30 15:38:22.618557 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.marts/core
- models.jaffle_shop.staging

2021-03-30 15:38:22.640530 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 15:38:22.641172 (MainThread): 
2021-03-30 15:38:22.641446 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 15:38:22.645840 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome".
2021-03-30 15:38:22.646001 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 15:38:22.821369 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome_maxm".
2021-03-30 15:38:22.821540 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-30 15:38:23.008133 (MainThread): 15:38:23 | Concurrency: 1 threads (target='default')
2021-03-30 15:38:23.008263 (MainThread): 15:38:23 | 
2021-03-30 15:38:23.010402 (Thread-1): Began running node model.jaffle_shop.sgt_orders
2021-03-30 15:38:23.011419 (Thread-1): 15:38:23 | 1 of 3 START view model maxm.sgt_orders.............................. [RUN]
2021-03-30 15:38:23.011667 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.sgt_orders".
2021-03-30 15:38:23.011750 (Thread-1): Compiling model.jaffle_shop.sgt_orders
2021-03-30 15:38:23.025375 (Thread-1): Writing injected SQL for node "model.jaffle_shop.sgt_orders"
2021-03-30 15:38:23.044026 (Thread-1): finished collecting timing info
2021-03-30 15:38:23.075343 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.sgt_orders"
2021-03-30 15:38:23.094793 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 15:38:23.095180 (Thread-1): On model.jaffle_shop.sgt_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.sgt_orders"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`sgt_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `finl-1067321-eds-thunderdome.maxm.orders`
)

select * from orders;


2021-03-30 15:38:23.829364 (Thread-1): finished collecting timing info
2021-03-30 15:38:23.829990 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f605c99-bcb3-44a9-a84e-760cac245c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f188c139910>]}
2021-03-30 15:38:23.830956 (Thread-1): 15:38:23 | 1 of 3 OK created view model maxm.sgt_orders......................... [CREATE VIEW in 0.82s]
2021-03-30 15:38:23.831041 (Thread-1): Finished running node model.jaffle_shop.sgt_orders
2021-03-30 15:38:23.831143 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-03-30 15:38:23.831977 (Thread-1): 15:38:23 | 2 of 3 START view model maxm.stg_customers........................... [RUN]
2021-03-30 15:38:23.832175 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 15:38:23.832250 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-03-30 15:38:23.838345 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-03-30 15:38:23.857281 (Thread-1): finished collecting timing info
2021-03-30 15:38:23.861734 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-03-30 15:38:23.880035 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 15:38:23.880519 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
  OPTIONS()
  as with customers as (
    
    select 
        id as customer_id,
        first_name,
        last_name

    from `finl-1067321-eds-thunderdome.maxm.customers`
)

select * from customers;


2021-03-30 15:38:24.027260 (Thread-66): handling poll request
2021-03-30 15:38:24.027678 (Thread-66): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726622f40>]}
2021-03-30 15:38:24.031057 (Thread-66): sending response (<Response 12954 bytes [200 OK]>) to 10.0.5.204
2021-03-30 15:38:24.550881 (Thread-1): finished collecting timing info
2021-03-30 15:38:24.551488 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f605c99-bcb3-44a9-a84e-760cac245c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f188c826f10>]}
2021-03-30 15:38:24.552432 (Thread-1): 15:38:24 | 2 of 3 OK created view model maxm.stg_customers...................... [CREATE VIEW in 0.72s]
2021-03-30 15:38:24.552512 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-03-30 15:38:24.553375 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-03-30 15:38:24.554326 (Thread-1): 15:38:24 | 3 of 3 START table model maxm.dim_customers.......................... [RUN]
2021-03-30 15:38:24.554545 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:38:24.554621 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-03-30 15:38:24.564126 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-03-30 15:38:24.583440 (Thread-1): finished collecting timing info
2021-03-30 15:38:24.600105 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 15:38:24.857349 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-03-30 15:38:24.876518 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers`
  
  
  OPTIONS()
  as (
    

with customers as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
),

orders as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`sgt_orders`
),

 customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-03-30 15:38:25.600906 (Thread-67): handling poll request
2021-03-30 15:38:25.601325 (Thread-67): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72663a3d0>]}
2021-03-30 15:38:25.603263 (Thread-67): sending response (<Response 6692 bytes [200 OK]>) to 10.0.33.81
2021-03-30 15:38:26.895400 (Thread-1): finished collecting timing info
2021-03-30 15:38:26.896068 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f605c99-bcb3-44a9-a84e-760cac245c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f188c826250>]}
2021-03-30 15:38:26.897130 (Thread-1): 15:38:26 | 3 of 3 OK created table model maxm.dim_customers..................... [CREATE TABLE (100.0 rows, 4.3 KB processed) in 2.34s]
2021-03-30 15:38:26.897216 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-03-30 15:38:26.898813 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 15:38:26.899079 (MainThread): 15:38:26 | 
2021-03-30 15:38:26.899143 (MainThread): 15:38:26 | Finished running 2 view models, 1 table model in 4.26s.
2021-03-30 15:38:26.899191 (MainThread): Connection 'master' was properly closed.
2021-03-30 15:38:26.899231 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:38:26.945035 (MainThread): 
2021-03-30 15:38:26.945234 (MainThread): Completed successfully
2021-03-30 15:38:26.945335 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-03-30 15:38:27.044154 (Thread-68): handling poll request
2021-03-30 15:38:27.044814 (Thread-68): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72663a6a0>]}
2021-03-30 15:38:27.047252 (Thread-68): sending response (<Response 4701 bytes [200 OK]>) to 10.0.7.248
2021-03-30 15:38:28.636546 (Thread-69): handling poll request
2021-03-30 15:38:28.636980 (Thread-69): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72663a0d0>]}
2021-03-30 15:38:28.646629 (Thread-69): sending response (<Response 9010 bytes [200 OK]>) to 10.0.15.161
2021-03-30 15:38:29.230083 (Thread-70): handling status request
2021-03-30 15:38:29.230496 (Thread-70): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72663a2b0>]}
2021-03-30 15:38:29.234197 (Thread-70): sending response (<Response 11256 bytes [200 OK]>) to 10.0.27.42
2021-03-30 15:38:38.835378 (Thread-71): For key jaffle_shop, hash mismatch (FileHash(name='sha256', checksum='ec6ad40adc5f430903f933151aeaf3c2e376f2dc9acdf0373a6df0801baab593') -> FileHash(name='sha256', checksum='f7222919b041a806c090c2f2f2bb923b45149957e1274c6a41eaf0929ba9f321')), cache invalidated
2021-03-30 15:38:38.836190 (Thread-71): Parsing macros/adapters.sql
2021-03-30 15:38:38.855226 (Thread-71): Parsing macros/etc.sql
2021-03-30 15:38:38.856500 (Thread-71): Parsing macros/catalog.sql
2021-03-30 15:38:38.862389 (Thread-71): Parsing macros/materializations/copy.sql
2021-03-30 15:38:38.866686 (Thread-71): Parsing macros/materializations/table.sql
2021-03-30 15:38:38.876527 (Thread-71): Parsing macros/materializations/incremental.sql
2021-03-30 15:38:38.889782 (Thread-71): Parsing macros/materializations/seed.sql
2021-03-30 15:38:38.892550 (Thread-71): Parsing macros/materializations/snapshot.sql
2021-03-30 15:38:38.894393 (Thread-71): Parsing macros/materializations/view.sql
2021-03-30 15:38:38.897908 (Thread-71): Parsing macros/core.sql
2021-03-30 15:38:38.901513 (Thread-71): Parsing macros/materializations/helpers.sql
2021-03-30 15:38:38.910519 (Thread-71): Parsing macros/materializations/common/merge.sql
2021-03-30 15:38:38.924364 (Thread-71): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 15:38:38.926170 (Thread-71): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 15:38:38.943241 (Thread-71): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 15:38:38.977160 (Thread-71): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 15:38:38.991518 (Thread-71): Parsing macros/materializations/view/view.sql
2021-03-30 15:38:39.004294 (Thread-71): Parsing macros/materializations/seed/seed.sql
2021-03-30 15:38:39.030629 (Thread-71): Parsing macros/materializations/table/table.sql
2021-03-30 15:38:39.039367 (Thread-71): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 15:38:39.041493 (Thread-71): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 15:38:39.048882 (Thread-71): Parsing macros/etc/is_incremental.sql
2021-03-30 15:38:39.050838 (Thread-71): Parsing macros/etc/query.sql
2021-03-30 15:38:39.052012 (Thread-71): Parsing macros/etc/datetime.sql
2021-03-30 15:38:39.063251 (Thread-71): Parsing macros/etc/get_custom_alias.sql
2021-03-30 15:38:39.064396 (Thread-71): Parsing macros/etc/get_custom_database.sql
2021-03-30 15:38:39.066168 (Thread-71): Parsing macros/etc/get_custom_schema.sql
2021-03-30 15:38:39.068260 (Thread-71): Parsing macros/schema_tests/not_null.sql
2021-03-30 15:38:39.069842 (Thread-71): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 15:38:39.072683 (Thread-71): Parsing macros/schema_tests/relationships.sql
2021-03-30 15:38:39.074653 (Thread-71): Parsing macros/schema_tests/unique.sql
2021-03-30 15:38:39.076490 (Thread-71): Parsing macros/adapters/common.sql
2021-03-30 15:38:39.152762 (Thread-71): For key jaffle_shop, hash mismatch (FileHash(name='sha256', checksum='ec6ad40adc5f430903f933151aeaf3c2e376f2dc9acdf0373a6df0801baab593') -> FileHash(name='sha256', checksum='f7222919b041a806c090c2f2f2bb923b45149957e1274c6a41eaf0929ba9f321')), cache invalidated
2021-03-30 15:38:39.195749 (Thread-71): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 15:38:39.204068 (Thread-71): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:38:39.216571 (Thread-71): Acquiring new bigquery connection "model.jaffle_shop.sgt_orders".
2021-03-30 15:38:39.449033 (Thread-72): handling status request
2021-03-30 15:38:39.449573 (Thread-72): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727304d00>]}
2021-03-30 15:38:39.450412 (Thread-72): sending response (<Response 185 bytes [200 OK]>) to 10.0.42.64
2021-03-30 15:38:39.583176 (Thread-71): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.core
- models.jaffle_shop.staging

2021-03-30 15:38:40.978253 (Thread-73): handling status request
2021-03-30 15:38:40.978695 (Thread-73): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72661e430>]}
2021-03-30 15:38:40.982321 (Thread-73): sending response (<Response 11250 bytes [200 OK]>) to 10.0.27.28
2021-03-30 15:38:42.776490 (Thread-74): handling status request
2021-03-30 15:38:42.776901 (Thread-74): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72661e460>]}
2021-03-30 15:38:42.780524 (Thread-74): sending response (<Response 11250 bytes [200 OK]>) to 10.0.3.45
2021-03-30 15:38:42.808744 (Thread-75): handling status request
2021-03-30 15:38:42.809143 (Thread-75): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7266225e0>]}
2021-03-30 15:38:42.812623 (Thread-75): sending response (<Response 11250 bytes [200 OK]>) to 10.0.2.124
2021-03-30 15:38:43.294866 (Thread-76): handling cli_args request
2021-03-30 15:38:43.295273 (Thread-76): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726622e50>]}
2021-03-30 15:38:43.304771 (Thread-76): Connection 'model.jaffle_shop.sgt_orders' was properly closed.
2021-03-30 15:38:44.156431 (Thread-76): sending response (<Response 138 bytes [200 OK]>) to 10.0.2.124
2021-03-30 15:38:44.209647 (MainThread): Partial parsing not enabled
2021-03-30 15:38:44.210891 (MainThread): Parsing macros/adapters.sql
2021-03-30 15:38:44.231178 (MainThread): Parsing macros/etc.sql
2021-03-30 15:38:44.232612 (MainThread): Parsing macros/catalog.sql
2021-03-30 15:38:44.238837 (MainThread): Parsing macros/materializations/copy.sql
2021-03-30 15:38:44.279729 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 15:38:44.289827 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 15:38:44.302474 (MainThread): Parsing macros/materializations/seed.sql
2021-03-30 15:38:44.305241 (MainThread): Parsing macros/materializations/snapshot.sql
2021-03-30 15:38:44.307110 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 15:38:44.310607 (MainThread): Parsing macros/core.sql
2021-03-30 15:38:44.314409 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 15:38:44.330234 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 15:38:44.354738 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 15:38:44.357875 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 15:38:44.387109 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 15:38:44.436880 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 15:38:44.445820 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 15:38:44.453734 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 15:38:44.474114 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 15:38:44.480744 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 15:38:44.482644 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 15:38:44.488570 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 15:38:44.490284 (MainThread): Parsing macros/etc/query.sql
2021-03-30 15:38:44.491382 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 15:38:44.500126 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 15:38:44.501141 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 15:38:44.502864 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 15:38:44.504860 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 15:38:44.506481 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 15:38:44.509293 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 15:38:44.512067 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 15:38:44.513884 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 15:38:44.561810 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-30 15:38:44.561940 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '18af6c0e-6750-4d83-b398-8154c8e357e0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e11d88e0>]}
2021-03-30 15:38:44.564888 (MainThread): Partial parsing not enabled
2021-03-30 15:38:44.615514 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 15:38:44.633771 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:38:44.640837 (Thread-77): handling poll request
2021-03-30 15:38:44.641247 (Thread-77): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7272c0d60>]}
2021-03-30 15:38:44.645634 (Thread-77): sending response (<Response 11317 bytes [200 OK]>) to 10.0.2.124
2021-03-30 15:38:44.644090 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.sgt_orders".
2021-03-30 15:38:44.839258 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.staging
- models.jaffle_shop.core

2021-03-30 15:38:44.860234 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 15:38:44.860879 (MainThread): 
2021-03-30 15:38:44.861157 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 15:38:44.864987 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome".
2021-03-30 15:38:44.865106 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 15:38:45.073696 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome_maxm".
2021-03-30 15:38:45.073828 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-30 15:38:45.260943 (MainThread): 15:38:45 | Concurrency: 1 threads (target='default')
2021-03-30 15:38:45.261072 (MainThread): 15:38:45 | 
2021-03-30 15:38:45.263156 (Thread-1): Began running node model.jaffle_shop.sgt_orders
2021-03-30 15:38:45.264144 (Thread-1): 15:38:45 | 1 of 3 START view model maxm.sgt_orders.............................. [RUN]
2021-03-30 15:38:45.264381 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.sgt_orders".
2021-03-30 15:38:45.264456 (Thread-1): Compiling model.jaffle_shop.sgt_orders
2021-03-30 15:38:45.280186 (Thread-1): Writing injected SQL for node "model.jaffle_shop.sgt_orders"
2021-03-30 15:38:45.298681 (Thread-1): finished collecting timing info
2021-03-30 15:38:45.329747 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.sgt_orders"
2021-03-30 15:38:45.352362 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 15:38:45.352802 (Thread-1): On model.jaffle_shop.sgt_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.sgt_orders"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`sgt_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `finl-1067321-eds-thunderdome.maxm.orders`
)

select * from orders;


2021-03-30 15:38:46.022559 (Thread-1): finished collecting timing info
2021-03-30 15:38:46.023189 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18af6c0e-6750-4d83-b398-8154c8e357e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e11d8070>]}
2021-03-30 15:38:46.024770 (Thread-1): 15:38:46 | 1 of 3 OK created view model maxm.sgt_orders......................... [CREATE VIEW in 0.76s]
2021-03-30 15:38:46.024865 (Thread-1): Finished running node model.jaffle_shop.sgt_orders
2021-03-30 15:38:46.024970 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-03-30 15:38:46.025809 (Thread-1): 15:38:46 | 2 of 3 START view model maxm.stg_customers........................... [RUN]
2021-03-30 15:38:46.026011 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 15:38:46.026081 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-03-30 15:38:46.031405 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-03-30 15:38:46.049797 (Thread-1): finished collecting timing info
2021-03-30 15:38:46.054359 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-03-30 15:38:46.073484 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 15:38:46.074025 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
  OPTIONS()
  as with customers as (
    
    select 
        id as customer_id,
        first_name,
        last_name

    from `finl-1067321-eds-thunderdome.maxm.customers`
)

select * from customers;


2021-03-30 15:38:46.190876 (Thread-78): handling poll request
2021-03-30 15:38:46.191282 (Thread-78): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267debe0>]}
2021-03-30 15:38:46.195032 (Thread-78): sending response (<Response 13249 bytes [200 OK]>) to 10.0.27.42
2021-03-30 15:38:46.667415 (Thread-1): finished collecting timing info
2021-03-30 15:38:46.668034 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18af6c0e-6750-4d83-b398-8154c8e357e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e00b8280>]}
2021-03-30 15:38:46.669001 (Thread-1): 15:38:46 | 2 of 3 OK created view model maxm.stg_customers...................... [CREATE VIEW in 0.64s]
2021-03-30 15:38:46.669087 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-03-30 15:38:46.669991 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-03-30 15:38:46.670974 (Thread-1): 15:38:46 | 3 of 3 START table model maxm.dim_customers.......................... [RUN]
2021-03-30 15:38:46.671197 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:38:46.671271 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-03-30 15:38:46.683760 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-03-30 15:38:46.702102 (Thread-1): finished collecting timing info
2021-03-30 15:38:46.719071 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 15:38:46.937713 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-03-30 15:38:46.956686 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers`
  
  
  OPTIONS()
  as (
    

with customers as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
),

orders as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`sgt_orders`
),

 customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-03-30 15:38:47.671319 (Thread-79): handling poll request
2021-03-30 15:38:47.671753 (Thread-79): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727288370>]}
2021-03-30 15:38:47.674738 (Thread-79): sending response (<Response 6692 bytes [200 OK]>) to 10.0.5.204
2021-03-30 15:38:48.700674 (Thread-1): finished collecting timing info
2021-03-30 15:38:48.701646 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18af6c0e-6750-4d83-b398-8154c8e357e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e006ebe0>]}
2021-03-30 15:38:48.703105 (Thread-1): 15:38:48 | 3 of 3 OK created table model maxm.dim_customers..................... [CREATE TABLE (100.0 rows, 4.3 KB processed) in 2.03s]
2021-03-30 15:38:48.703222 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-03-30 15:38:48.704797 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 15:38:48.705153 (MainThread): 15:38:48 | 
2021-03-30 15:38:48.705233 (MainThread): 15:38:48 | Finished running 2 view models, 1 table model in 3.84s.
2021-03-30 15:38:48.705281 (MainThread): Connection 'master' was properly closed.
2021-03-30 15:38:48.705320 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:38:48.746416 (MainThread): 
2021-03-30 15:38:48.746594 (MainThread): Completed successfully
2021-03-30 15:38:48.746674 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-03-30 15:38:49.102425 (Thread-80): handling poll request
2021-03-30 15:38:49.102855 (Thread-80): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7272874f0>]}
2021-03-30 15:38:49.143178 (Thread-80): sending response (<Response 13417 bytes [200 OK]>) to 10.0.18.81
2021-03-30 15:38:49.614757 (Thread-81): handling status request
2021-03-30 15:38:49.615190 (Thread-81): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726880be0>]}
2021-03-30 15:38:49.618914 (Thread-81): sending response (<Response 11250 bytes [200 OK]>) to 10.0.22.23
2021-03-30 15:41:16.175951 (Thread-82): Got an acceptable cached parse result
2021-03-30 15:41:16.234653 (Thread-82): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:41:16.400056 (Thread-82): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.core

2021-03-30 15:41:16.640041 (Thread-83): handling status request
2021-03-30 15:41:16.640466 (Thread-83): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7273c2100>]}
2021-03-30 15:41:16.641455 (Thread-83): sending response (<Response 1172 bytes [200 OK]>) to 10.0.33.160
2021-03-30 15:41:56.754060 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:41:56.823057 (Thread-84): Got an acceptable cached parse result
2021-03-30 15:41:56.875489 (Thread-84): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:41:57.041425 (Thread-84): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.core
- models.jaffle_shop.staging

2021-03-30 15:41:57.170322 (Thread-85): handling status request
2021-03-30 15:41:57.170743 (Thread-85): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7274fb880>]}
2021-03-30 15:41:57.171843 (Thread-85): sending response (<Response 1202 bytes [200 OK]>) to 10.0.27.28
2021-03-30 15:42:04.795196 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:42:04.842597 (Thread-86): Got an acceptable cached parse result
2021-03-30 15:42:05.200963 (Thread-86): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.core
- models.jaffle_shop.staging

2021-03-30 15:42:05.539218 (Thread-87): handling status request
2021-03-30 15:42:05.539660 (Thread-87): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726774af0>]}
2021-03-30 15:42:05.540613 (Thread-87): sending response (<Response 901 bytes [200 OK]>) to 10.0.7.248
2021-03-30 15:42:10.610020 (Thread-88): Got an acceptable cached parse result
2021-03-30 15:42:10.818444 (Thread-88): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.core
- models.jaffle_shop.staging

2021-03-30 15:42:11.050780 (Thread-89): handling status request
2021-03-30 15:42:11.051226 (Thread-89): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267b9100>]}
2021-03-30 15:42:11.052176 (Thread-89): sending response (<Response 901 bytes [200 OK]>) to 10.0.27.28
2021-03-30 15:43:27.632496 (Thread-90): For key jaffle_shop, hash mismatch (FileHash(name='sha256', checksum='f7222919b041a806c090c2f2f2bb923b45149957e1274c6a41eaf0929ba9f321') -> FileHash(name='sha256', checksum='07559e29b0cc8c084de252e04ce7ffb0ece251293ae2a27d2f88f69580098214')), cache invalidated
2021-03-30 15:43:27.634910 (Thread-90): Parsing macros/adapters.sql
2021-03-30 15:43:27.654315 (Thread-90): Parsing macros/etc.sql
2021-03-30 15:43:27.655609 (Thread-90): Parsing macros/catalog.sql
2021-03-30 15:43:27.661539 (Thread-90): Parsing macros/materializations/copy.sql
2021-03-30 15:43:27.666301 (Thread-90): Parsing macros/materializations/table.sql
2021-03-30 15:43:27.676649 (Thread-90): Parsing macros/materializations/incremental.sql
2021-03-30 15:43:27.691529 (Thread-90): Parsing macros/materializations/seed.sql
2021-03-30 15:43:27.695369 (Thread-90): Parsing macros/materializations/snapshot.sql
2021-03-30 15:43:27.697929 (Thread-90): Parsing macros/materializations/view.sql
2021-03-30 15:43:27.702878 (Thread-90): Parsing macros/core.sql
2021-03-30 15:43:27.708185 (Thread-90): Parsing macros/materializations/helpers.sql
2021-03-30 15:43:27.721288 (Thread-90): Parsing macros/materializations/common/merge.sql
2021-03-30 15:43:27.741125 (Thread-90): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 15:43:27.743807 (Thread-90): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 15:43:27.764408 (Thread-90): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 15:43:27.793074 (Thread-90): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 15:43:27.798125 (Thread-90): Parsing macros/materializations/view/view.sql
2021-03-30 15:43:27.806845 (Thread-90): Parsing macros/materializations/seed/seed.sql
2021-03-30 15:43:27.835410 (Thread-90): Parsing macros/materializations/table/table.sql
2021-03-30 15:43:27.842453 (Thread-90): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 15:43:27.844524 (Thread-90): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 15:43:27.851588 (Thread-90): Parsing macros/etc/is_incremental.sql
2021-03-30 15:43:27.853312 (Thread-90): Parsing macros/etc/query.sql
2021-03-30 15:43:27.854577 (Thread-90): Parsing macros/etc/datetime.sql
2021-03-30 15:43:27.868408 (Thread-90): Parsing macros/etc/get_custom_alias.sql
2021-03-30 15:43:27.869463 (Thread-90): Parsing macros/etc/get_custom_database.sql
2021-03-30 15:43:27.871191 (Thread-90): Parsing macros/etc/get_custom_schema.sql
2021-03-30 15:43:27.873187 (Thread-90): Parsing macros/schema_tests/not_null.sql
2021-03-30 15:43:27.874800 (Thread-90): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 15:43:27.878359 (Thread-90): Parsing macros/schema_tests/relationships.sql
2021-03-30 15:43:27.880409 (Thread-90): Parsing macros/schema_tests/unique.sql
2021-03-30 15:43:27.882222 (Thread-90): Parsing macros/adapters/common.sql
2021-03-30 15:43:27.957283 (Thread-90): For key jaffle_shop, hash mismatch (FileHash(name='sha256', checksum='f7222919b041a806c090c2f2f2bb923b45149957e1274c6a41eaf0929ba9f321') -> FileHash(name='sha256', checksum='07559e29b0cc8c084de252e04ce7ffb0ece251293ae2a27d2f88f69580098214')), cache invalidated
2021-03-30 15:43:27.995115 (Thread-90): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 15:43:28.003088 (Thread-90): Acquiring new bigquery connection "model.jaffle_shop.sgt_orders".
2021-03-30 15:43:28.010825 (Thread-90): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:43:28.085289 (Thread-91): handling status request
2021-03-30 15:43:28.085876 (Thread-91): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726896850>]}
2021-03-30 15:43:28.086664 (Thread-91): sending response (<Response 185 bytes [200 OK]>) to 10.0.33.81
2021-03-30 15:43:28.170231 (Thread-90): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.staging

2021-03-30 15:43:29.784555 (Thread-92): handling status request
2021-03-30 15:43:29.784980 (Thread-92): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7271cc250>]}
2021-03-30 15:43:29.788512 (Thread-92): sending response (<Response 11223 bytes [200 OK]>) to 10.0.22.40
2021-03-30 15:43:43.015154 (Thread-93): handling status request
2021-03-30 15:43:43.015569 (Thread-93): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7272fb220>]}
2021-03-30 15:43:43.018998 (Thread-93): sending response (<Response 11223 bytes [200 OK]>) to 10.0.1.181
2021-03-30 15:43:43.060689 (Thread-94): handling status request
2021-03-30 15:43:43.061071 (Thread-94): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267747f0>]}
2021-03-30 15:43:43.064526 (Thread-94): sending response (<Response 11223 bytes [200 OK]>) to 10.0.34.79
2021-03-30 15:43:43.805264 (Thread-95): handling cli_args request
2021-03-30 15:43:43.805719 (Thread-95): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7272f45e0>]}
2021-03-30 15:43:43.815919 (Thread-95): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:43:44.660169 (Thread-95): sending response (<Response 138 bytes [200 OK]>) to 10.0.22.40
2021-03-30 15:43:44.715137 (MainThread): Partial parsing not enabled
2021-03-30 15:43:44.747386 (MainThread): Parsing macros/adapters.sql
2021-03-30 15:43:44.775165 (MainThread): Parsing macros/etc.sql
2021-03-30 15:43:44.777428 (MainThread): Parsing macros/catalog.sql
2021-03-30 15:43:44.787813 (MainThread): Parsing macros/materializations/copy.sql
2021-03-30 15:43:44.835907 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 15:43:44.851550 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 15:43:44.872296 (MainThread): Parsing macros/materializations/seed.sql
2021-03-30 15:43:44.876662 (MainThread): Parsing macros/materializations/snapshot.sql
2021-03-30 15:43:44.879533 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 15:43:44.884339 (MainThread): Parsing macros/core.sql
2021-03-30 15:43:44.888010 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 15:43:44.896929 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 15:43:44.910805 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 15:43:44.912699 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 15:43:44.929001 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 15:43:44.956884 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 15:43:44.961870 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 15:43:44.968096 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 15:43:44.988477 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 15:43:44.995128 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 15:43:44.996982 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 15:43:45.002953 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 15:43:45.004614 (MainThread): Parsing macros/etc/query.sql
2021-03-30 15:43:45.005730 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 15:43:45.014406 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 15:43:45.015389 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 15:43:45.017069 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 15:43:45.019082 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 15:43:45.020651 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 15:43:45.023449 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 15:43:45.025365 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 15:43:45.027164 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 15:43:45.074577 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-30 15:43:45.074705 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e454df88-6cc4-46df-b924-1412de99686d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa573441220>]}
2021-03-30 15:43:45.077647 (MainThread): Partial parsing not enabled
2021-03-30 15:43:45.128276 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 15:43:45.145876 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.sgt_orders".
2021-03-30 15:43:45.153199 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:43:45.218851 (Thread-96): handling poll request
2021-03-30 15:43:45.219365 (Thread-96): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7271e1ac0>]}
2021-03-30 15:43:45.223737 (Thread-96): sending response (<Response 11617 bytes [200 OK]>) to 10.0.33.160
2021-03-30 15:43:45.305193 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.staging

2021-03-30 15:43:45.325962 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 15:43:45.326595 (MainThread): 
2021-03-30 15:43:45.326874 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 15:43:45.330691 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome".
2021-03-30 15:43:45.330814 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 15:43:45.526875 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome_maxm".
2021-03-30 15:43:45.527006 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-30 15:43:45.707493 (MainThread): 15:43:45 | Concurrency: 1 threads (target='default')
2021-03-30 15:43:45.707620 (MainThread): 15:43:45 | 
2021-03-30 15:43:45.709653 (Thread-1): Began running node model.jaffle_shop.sgt_orders
2021-03-30 15:43:45.710655 (Thread-1): 15:43:45 | 1 of 3 START view model maxm.sgt_orders.............................. [RUN]
2021-03-30 15:43:45.710895 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.sgt_orders".
2021-03-30 15:43:45.710977 (Thread-1): Compiling model.jaffle_shop.sgt_orders
2021-03-30 15:43:45.724907 (Thread-1): Writing injected SQL for node "model.jaffle_shop.sgt_orders"
2021-03-30 15:43:45.745005 (Thread-1): finished collecting timing info
2021-03-30 15:43:45.777210 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.sgt_orders"
2021-03-30 15:43:45.796938 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 15:43:45.797624 (Thread-1): On model.jaffle_shop.sgt_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.sgt_orders"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`sgt_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `finl-1067321-eds-thunderdome.maxm.orders`
)

select * from orders;


2021-03-30 15:43:46.687232 (Thread-97): handling poll request
2021-03-30 15:43:46.687661 (Thread-97): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7268894f0>]}
2021-03-30 15:43:46.690000 (Thread-97): sending response (<Response 7261 bytes [200 OK]>) to 10.0.26.97
2021-03-30 15:43:46.936761 (Thread-1): finished collecting timing info
2021-03-30 15:43:46.937437 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e454df88-6cc4-46df-b924-1412de99686d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa572145d00>]}
2021-03-30 15:43:46.938618 (Thread-1): 15:43:46 | 1 of 3 OK created view model maxm.sgt_orders......................... [CREATE VIEW in 1.23s]
2021-03-30 15:43:46.938744 (Thread-1): Finished running node model.jaffle_shop.sgt_orders
2021-03-30 15:43:46.938902 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-03-30 15:43:46.940202 (Thread-1): 15:43:46 | 2 of 3 START view model maxm.stg_customers........................... [RUN]
2021-03-30 15:43:46.940512 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 15:43:46.940628 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-03-30 15:43:46.949336 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-03-30 15:43:46.969344 (Thread-1): finished collecting timing info
2021-03-30 15:43:46.976401 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-03-30 15:43:46.995988 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 15:43:46.996448 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
  OPTIONS()
  as with customers as (
    
    select 
        id as customer_id,
        first_name,
        last_name

    from `finl-1067321-eds-thunderdome.maxm.customers`
)

select * from customers;


2021-03-30 15:43:47.799028 (Thread-1): finished collecting timing info
2021-03-30 15:43:47.799941 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e454df88-6cc4-46df-b924-1412de99686d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5702a2a90>]}
2021-03-30 15:43:47.801439 (Thread-1): 15:43:47 | 2 of 3 OK created view model maxm.stg_customers...................... [CREATE VIEW in 0.86s]
2021-03-30 15:43:47.801564 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-03-30 15:43:47.802487 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-03-30 15:43:47.803873 (Thread-1): 15:43:47 | 3 of 3 START table model maxm.dim_customers.......................... [RUN]
2021-03-30 15:43:47.804228 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:43:47.804348 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-03-30 15:43:47.819412 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-03-30 15:43:47.845758 (Thread-1): finished collecting timing info
2021-03-30 15:43:47.874687 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 15:43:48.094016 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-03-30 15:43:48.122790 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers`
  
  
  OPTIONS()
  as (
    

with customers as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
),

orders as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`sgt_orders`
),

 customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-03-30 15:43:48.305430 (Thread-98): handling poll request
2021-03-30 15:43:48.305923 (Thread-98): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7268891c0>]}
2021-03-30 15:43:48.308786 (Thread-98): sending response (<Response 12363 bytes [200 OK]>) to 10.0.7.248
2021-03-30 15:43:49.750550 (Thread-99): handling poll request
2021-03-30 15:43:49.751019 (Thread-99): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726885c40>]}
2021-03-30 15:43:49.752135 (Thread-99): sending response (<Response 293 bytes [200 OK]>) to 10.0.22.40
2021-03-30 15:43:50.116776 (Thread-1): finished collecting timing info
2021-03-30 15:43:50.117413 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e454df88-6cc4-46df-b924-1412de99686d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa570241700>]}
2021-03-30 15:43:50.118559 (Thread-1): 15:43:50 | 3 of 3 OK created table model maxm.dim_customers..................... [CREATE TABLE (100.0 rows, 4.3 KB processed) in 2.31s]
2021-03-30 15:43:50.118646 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-03-30 15:43:50.119839 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 15:43:50.120096 (MainThread): 15:43:50 | 
2021-03-30 15:43:50.120160 (MainThread): 15:43:50 | Finished running 2 view models, 1 table model in 4.79s.
2021-03-30 15:43:50.120208 (MainThread): Connection 'master' was properly closed.
2021-03-30 15:43:50.120248 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:43:50.162863 (MainThread): 
2021-03-30 15:43:50.163012 (MainThread): Completed successfully
2021-03-30 15:43:50.163076 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-03-30 15:43:51.266828 (Thread-100): handling poll request
2021-03-30 15:43:51.267239 (Thread-100): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726896790>]}
2021-03-30 15:43:51.276056 (Thread-100): sending response (<Response 13466 bytes [200 OK]>) to 10.0.15.161
2021-03-30 15:43:51.814548 (Thread-101): handling status request
2021-03-30 15:43:51.815216 (Thread-101): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726648a00>]}
2021-03-30 15:43:51.821522 (Thread-101): sending response (<Response 11223 bytes [200 OK]>) to 10.0.33.81
2021-03-30 15:44:37.595189 (Thread-102): Got an acceptable cached parse result
2021-03-30 15:44:37.653802 (Thread-102): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:44:37.998603 (Thread-103): handling status request
2021-03-30 15:44:37.999024 (Thread-103): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7264ae2e0>]}
2021-03-30 15:44:37.999966 (Thread-103): sending response (<Response 977 bytes [200 OK]>) to 10.0.2.124
2021-03-30 15:45:43.998212 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:45:44.055079 (Thread-104): Got an acceptable cached parse result
2021-03-30 15:45:44.107030 (Thread-104): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:45:44.423480 (Thread-105): handling status request
2021-03-30 15:45:44.424037 (Thread-105): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72c046940>]}
2021-03-30 15:45:44.425032 (Thread-105): sending response (<Response 977 bytes [200 OK]>) to 10.0.26.97
2021-03-30 15:46:04.566607 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:46:04.618679 (Thread-106): Got an acceptable cached parse result
2021-03-30 15:46:04.668976 (Thread-106): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-03-30 15:46:04.972914 (Thread-107): handling status request
2021-03-30 15:46:04.973368 (Thread-107): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72731db50>]}
2021-03-30 15:46:04.974367 (Thread-107): sending response (<Response 747 bytes [200 OK]>) to 10.0.26.97
2021-03-30 15:46:14.254086 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-03-30 15:46:14.299842 (Thread-108): Got an acceptable cached parse result
2021-03-30 15:46:14.488092 (Thread-108): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 15:46:14.668385 (Thread-109): handling status request
2021-03-30 15:46:14.668850 (Thread-109): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7265b7220>]}
2021-03-30 15:46:14.669834 (Thread-109): sending response (<Response 1175 bytes [200 OK]>) to 10.0.1.181
2021-03-30 15:46:21.721063 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-03-30 15:46:21.777547 (Thread-110): Got an acceptable cached parse result
2021-03-30 15:46:21.830927 (Thread-110): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 15:46:22.186295 (Thread-111): handling status request
2021-03-30 15:46:22.186747 (Thread-111): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7265911f0>]}
2021-03-30 15:46:22.187669 (Thread-111): sending response (<Response 1175 bytes [200 OK]>) to 10.0.38.35
2021-03-30 15:46:37.104801 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-03-30 15:46:37.153187 (Thread-112): Got an acceptable cached parse result
2021-03-30 15:46:37.198093 (Thread-112): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 15:46:37.208328 (Thread-112): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-03-30 15:46:37.580942 (Thread-113): handling status request
2021-03-30 15:46:37.581358 (Thread-113): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727374100>]}
2021-03-30 15:46:37.582392 (Thread-113): sending response (<Response 1051 bytes [200 OK]>) to 10.0.38.35
2021-03-30 15:46:42.581780 (MainThread): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-03-30 15:46:42.631320 (Thread-114): Got an acceptable cached parse result
2021-03-30 15:46:43.177953 (Thread-115): handling status request
2021-03-30 15:46:43.178407 (Thread-115): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7272f2040>]}
2021-03-30 15:46:43.179462 (Thread-115): sending response (<Response 448 bytes [200 OK]>) to 10.0.42.64
2021-03-30 15:46:57.554373 (Thread-116): handling status request
2021-03-30 15:46:57.554795 (Thread-116): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7272f2f70>]}
2021-03-30 15:46:57.555621 (Thread-116): sending response (<Response 448 bytes [200 OK]>) to 10.0.3.45
2021-03-30 15:46:57.677225 (Thread-117): handling status request
2021-03-30 15:46:57.677627 (Thread-117): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7272f2940>]}
2021-03-30 15:46:57.678451 (Thread-117): sending response (<Response 448 bytes [200 OK]>) to 10.0.5.204
2021-03-30 15:46:58.371112 (Thread-118): handling cli_args request
2021-03-30 15:46:58.371692 (Thread-118): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7272f27f0>]}
2021-03-30 15:46:59.263056 (Thread-118): sending response (<Response 138 bytes [200 OK]>) to 10.0.42.64
2021-03-30 15:46:59.315681 (MainThread): Partial parsing not enabled
2021-03-30 15:46:59.316879 (MainThread): Parsing macros/adapters.sql
2021-03-30 15:46:59.337368 (MainThread): Parsing macros/etc.sql
2021-03-30 15:46:59.338880 (MainThread): Parsing macros/catalog.sql
2021-03-30 15:46:59.346098 (MainThread): Parsing macros/materializations/copy.sql
2021-03-30 15:46:59.386437 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 15:46:59.397508 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 15:46:59.410731 (MainThread): Parsing macros/materializations/seed.sql
2021-03-30 15:46:59.413600 (MainThread): Parsing macros/materializations/snapshot.sql
2021-03-30 15:46:59.415568 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 15:46:59.419271 (MainThread): Parsing macros/core.sql
2021-03-30 15:46:59.423155 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 15:46:59.435872 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 15:46:59.450631 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 15:46:59.452520 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 15:46:59.469073 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 15:46:59.501689 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 15:46:59.506906 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 15:46:59.513873 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 15:46:59.537122 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 15:46:59.545396 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 15:46:59.547391 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 15:46:59.553441 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 15:46:59.555159 (MainThread): Parsing macros/etc/query.sql
2021-03-30 15:46:59.556264 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 15:46:59.568160 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 15:46:59.569196 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 15:46:59.570960 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 15:46:59.572952 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 15:46:59.574581 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 15:46:59.577267 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 15:46:59.579217 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 15:46:59.581007 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 15:46:59.630538 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-30 15:46:59.630670 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '312c067a-cd3c-454c-8705-4dc27bd5d676', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe817e12d90>]}
2021-03-30 15:46:59.633445 (MainThread): Partial parsing not enabled
2021-03-30 15:46:59.689266 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 15:46:59.708116 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-03-30 15:46:59.715801 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-03-30 15:46:59.724235 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:46:59.754730 (Thread-119): handling poll request
2021-03-30 15:46:59.755392 (Thread-119): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7266d1790>]}
2021-03-30 15:46:59.760750 (Thread-119): sending response (<Response 11919 bytes [200 OK]>) to 10.0.18.81
2021-03-30 15:46:59.924376 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 15:46:59.925039 (MainThread): 
2021-03-30 15:46:59.925419 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 15:46:59.930228 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome".
2021-03-30 15:46:59.930359 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 15:47:00.120356 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome_maxm".
2021-03-30 15:47:00.120489 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-30 15:47:00.310772 (MainThread): 15:47:00 | Concurrency: 1 threads (target='default')
2021-03-30 15:47:00.310896 (MainThread): 15:47:00 | 
2021-03-30 15:47:00.312794 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-03-30 15:47:00.313765 (Thread-1): 15:47:00 | 1 of 4 START view model maxm.stg_customers........................... [RUN]
2021-03-30 15:47:00.314016 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 15:47:00.314094 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-03-30 15:47:00.331229 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-03-30 15:47:00.358278 (Thread-1): finished collecting timing info
2021-03-30 15:47:00.388870 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-03-30 15:47:00.419812 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 15:47:00.420264 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `finl-1067321-eds-thunderdome.maxm.customers`;


2021-03-30 15:47:01.337476 (Thread-1): finished collecting timing info
2021-03-30 15:47:01.338150 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '312c067a-cd3c-454c-8705-4dc27bd5d676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe814c100d0>]}
2021-03-30 15:47:01.339142 (Thread-1): 15:47:01 | 1 of 4 OK created view model maxm.stg_customers...................... [CREATE VIEW in 1.02s]
2021-03-30 15:47:01.339227 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-03-30 15:47:01.339336 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-03-30 15:47:01.340128 (Thread-1): 15:47:01 | 2 of 4 START view model maxm.stg_orders.............................. [RUN]
2021-03-30 15:47:01.340326 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-03-30 15:47:01.340407 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-03-30 15:47:01.349089 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-03-30 15:47:01.361803 (Thread-1): finished collecting timing info
2021-03-30 15:47:01.366133 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-03-30 15:47:01.380814 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 15:47:01.381224 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `finl-1067321-eds-thunderdome.maxm.orders`;


2021-03-30 15:47:01.448895 (Thread-120): handling poll request
2021-03-30 15:47:01.449333 (Thread-120): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7266cefd0>]}
2021-03-30 15:47:01.452837 (Thread-120): sending response (<Response 12399 bytes [200 OK]>) to 10.0.37.31
2021-03-30 15:47:01.902142 (Thread-1): finished collecting timing info
2021-03-30 15:47:01.903090 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '312c067a-cd3c-454c-8705-4dc27bd5d676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe814c2db80>]}
2021-03-30 15:47:01.904775 (Thread-1): 15:47:01 | 2 of 4 OK created view model maxm.stg_orders......................... [CREATE VIEW in 0.56s]
2021-03-30 15:47:01.904894 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-03-30 15:47:01.905055 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-03-30 15:47:01.906332 (Thread-1): 15:47:01 | 3 of 4 START view model maxm.stg_payments............................ [RUN]
2021-03-30 15:47:01.906633 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-03-30 15:47:01.906733 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-03-30 15:47:01.913084 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-03-30 15:47:01.936119 (Thread-1): finished collecting timing info
2021-03-30 15:47:01.940872 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-03-30 15:47:01.962634 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 15:47:01.963212 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  OPTIONS()
  as select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,

    -- amount is stored in cents, convert it to dollars
    amount / 100 as amount,
    created as created_at

from `finl-1067321-eds-thunderdome.maxm.payments`;


2021-03-30 15:47:02.582759 (Thread-1): finished collecting timing info
2021-03-30 15:47:02.583388 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '312c067a-cd3c-454c-8705-4dc27bd5d676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe814be59a0>]}
2021-03-30 15:47:02.584358 (Thread-1): 15:47:02 | 3 of 4 OK created view model maxm.stg_payments....................... [CREATE VIEW in 0.68s]
2021-03-30 15:47:02.584444 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-03-30 15:47:02.584546 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-03-30 15:47:02.585322 (Thread-1): 15:47:02 | 4 of 4 START view model maxm.dim_customers........................... [RUN]
2021-03-30 15:47:02.585529 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:47:02.585605 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-03-30 15:47:02.594412 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-03-30 15:47:02.612289 (Thread-1): finished collecting timing info
2021-03-30 15:47:02.623012 (Thread-1): finished collecting timing info
2021-03-30 15:47:02.623428 (Thread-1): Compilation Error in model dim_customers (models/marts/core/dim_customers.sql)
  Trying to create view `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers`, but it currently exists as a table. Either drop `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model dim_customers (models/marts/core/dim_customers.sql)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 29, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/exceptions.py", line 980, in inner
    raise exc
  File "/usr/local/lib/python3.8/dist-packages/dbt/exceptions.py", line 977, in inner
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/exceptions.py", line 641, in relation_wrong_type
    raise_compiler_error(
  File "/usr/local/lib/python3.8/dist-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model dim_customers (models/marts/core/dim_customers.sql)
  Trying to create view `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers`, but it currently exists as a table. Either drop `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model dim_customers (models/marts/core/dim_customers.sql)
2021-03-30 15:47:02.624777 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '312c067a-cd3c-454c-8705-4dc27bd5d676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe814b9c850>]}
2021-03-30 15:47:02.626118 (Thread-1): 15:47:02 | 4 of 4 ERROR creating view model maxm.dim_customers.................. [ERROR in 0.04s]
2021-03-30 15:47:02.626208 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-03-30 15:47:02.627634 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 15:47:02.627904 (MainThread): 15:47:02 | 
2021-03-30 15:47:02.627969 (MainThread): 15:47:02 | Finished running 4 view models in 2.70s.
2021-03-30 15:47:02.628022 (MainThread): Connection 'master' was properly closed.
2021-03-30 15:47:02.628085 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:47:02.669320 (MainThread): 
2021-03-30 15:47:02.669536 (MainThread): Completed with 1 error and 0 warnings:
2021-03-30 15:47:02.669641 (MainThread): 
2021-03-30 15:47:02.669775 (MainThread): Compilation Error in model dim_customers (models/marts/core/dim_customers.sql)
2021-03-30 15:47:02.669855 (MainThread):   Trying to create view `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers`, but it currently exists as a table. Either drop `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
2021-03-30 15:47:02.669927 (MainThread):   
2021-03-30 15:47:02.670004 (MainThread):   > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
2021-03-30 15:47:02.670066 (MainThread):   > called by macro handle_existing_table (macros/materializations/view/create_or_replace_view.sql)
2021-03-30 15:47:02.670132 (MainThread):   > called by macro create_or_replace_view (macros/materializations/view/create_or_replace_view.sql)
2021-03-30 15:47:02.670193 (MainThread):   > called by macro materialization_view_bigquery (macros/materializations/view.sql)
2021-03-30 15:47:02.670254 (MainThread):   > called by model dim_customers (models/marts/core/dim_customers.sql)
2021-03-30 15:47:02.670330 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2021-03-30 15:47:02.942997 (Thread-121): handling poll request
2021-03-30 15:47:02.943565 (Thread-121): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7264867c0>]}
2021-03-30 15:47:02.960442 (Thread-121): sending response (<Response 37528 bytes [200 OK]>) to 10.0.15.161
2021-03-30 15:47:03.478829 (Thread-122): handling status request
2021-03-30 15:47:03.479377 (Thread-122): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7275a19d0>]}
2021-03-30 15:47:03.510612 (Thread-122): sending response (<Response 448 bytes [200 OK]>) to 10.0.37.31
2021-03-30 15:47:38.199338 (Thread-123): handling status request
2021-03-30 15:47:38.199770 (Thread-123): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7273b5e50>]}
2021-03-30 15:47:38.200648 (Thread-123): sending response (<Response 448 bytes [200 OK]>) to 10.0.27.28
2021-03-30 15:47:38.320181 (Thread-124): handling status request
2021-03-30 15:47:38.320590 (Thread-124): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72660caf0>]}
2021-03-30 15:47:38.321375 (Thread-124): sending response (<Response 448 bytes [200 OK]>) to 10.0.18.81
2021-03-30 15:47:38.859819 (Thread-125): handling cli_args request
2021-03-30 15:47:38.860284 (Thread-125): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72660c100>]}
2021-03-30 15:47:39.753126 (Thread-125): sending response (<Response 138 bytes [200 OK]>) to 10.0.2.124
2021-03-30 15:47:39.821429 (MainThread): Partial parsing not enabled
2021-03-30 15:47:39.822737 (MainThread): Parsing macros/adapters.sql
2021-03-30 15:47:39.844242 (MainThread): Parsing macros/etc.sql
2021-03-30 15:47:39.845725 (MainThread): Parsing macros/catalog.sql
2021-03-30 15:47:39.852247 (MainThread): Parsing macros/materializations/copy.sql
2021-03-30 15:47:39.891355 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 15:47:39.901742 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 15:47:39.915835 (MainThread): Parsing macros/materializations/seed.sql
2021-03-30 15:47:39.918671 (MainThread): Parsing macros/materializations/snapshot.sql
2021-03-30 15:47:39.920550 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 15:47:39.924097 (MainThread): Parsing macros/core.sql
2021-03-30 15:47:39.927757 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 15:47:39.937096 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 15:47:39.951648 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 15:47:39.953580 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 15:47:39.975252 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 15:47:40.006589 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 15:47:40.011654 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 15:47:40.018153 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 15:47:40.039421 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 15:47:40.046380 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 15:47:40.048324 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 15:47:40.054393 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 15:47:40.056076 (MainThread): Parsing macros/etc/query.sql
2021-03-30 15:47:40.057221 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 15:47:40.066203 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 15:47:40.067349 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 15:47:40.069093 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 15:47:40.071212 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 15:47:40.072831 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 15:47:40.075633 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 15:47:40.077611 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 15:47:40.079488 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 15:47:40.128364 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-30 15:47:40.128495 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '32349905-04be-4544-a690-4edc7432d836', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fbbc62cd0>]}
2021-03-30 15:47:40.131268 (MainThread): Partial parsing not enabled
2021-03-30 15:47:40.183609 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 15:47:40.202405 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-03-30 15:47:40.210140 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-03-30 15:47:40.217453 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:47:40.239883 (Thread-126): handling poll request
2021-03-30 15:47:40.240361 (Thread-126): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72715e880>]}
2021-03-30 15:47:40.247264 (Thread-126): sending response (<Response 11919 bytes [200 OK]>) to 10.0.15.161
2021-03-30 15:47:40.394698 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 15:47:40.395373 (MainThread): 
2021-03-30 15:47:40.395775 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 15:47:40.400678 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome".
2021-03-30 15:47:40.400802 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 15:47:40.598315 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome_maxm".
2021-03-30 15:47:40.598452 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-30 15:47:40.866361 (MainThread): 15:47:40 | Concurrency: 1 threads (target='default')
2021-03-30 15:47:40.866496 (MainThread): 15:47:40 | 
2021-03-30 15:47:40.868730 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-03-30 15:47:40.870141 (Thread-1): 15:47:40 | 1 of 4 START view model maxm.stg_customers........................... [RUN]
2021-03-30 15:47:40.870486 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 15:47:40.870593 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-03-30 15:47:40.891576 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-03-30 15:47:40.915079 (Thread-1): finished collecting timing info
2021-03-30 15:47:40.947572 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-03-30 15:47:40.968507 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 15:47:40.969081 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `finl-1067321-eds-thunderdome.maxm.customers`;


2021-03-30 15:47:41.626017 (Thread-1): finished collecting timing info
2021-03-30 15:47:41.626822 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32349905-04be-4544-a690-4edc7432d836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fbb25dee0>]}
2021-03-30 15:47:41.627971 (Thread-1): 15:47:41 | 1 of 4 OK created view model maxm.stg_customers...................... [CREATE VIEW in 0.76s]
2021-03-30 15:47:41.628092 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-03-30 15:47:41.628200 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-03-30 15:47:41.629055 (Thread-1): 15:47:41 | 2 of 4 START view model maxm.stg_orders.............................. [RUN]
2021-03-30 15:47:41.629282 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-03-30 15:47:41.629369 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-03-30 15:47:41.635488 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-03-30 15:47:41.654090 (Thread-1): finished collecting timing info
2021-03-30 15:47:41.658976 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-03-30 15:47:41.678116 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 15:47:41.678618 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `finl-1067321-eds-thunderdome.maxm.orders`;


2021-03-30 15:47:41.741202 (Thread-127): handling poll request
2021-03-30 15:47:41.741822 (Thread-127): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72660c430>]}
2021-03-30 15:47:41.746346 (Thread-127): sending response (<Response 12399 bytes [200 OK]>) to 10.0.34.79
2021-03-30 15:47:42.268029 (Thread-1): finished collecting timing info
2021-03-30 15:47:42.268674 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32349905-04be-4544-a690-4edc7432d836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fb8a1bd90>]}
2021-03-30 15:47:42.270227 (Thread-1): 15:47:42 | 2 of 4 OK created view model maxm.stg_orders......................... [CREATE VIEW in 0.64s]
2021-03-30 15:47:42.270325 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-03-30 15:47:42.270438 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-03-30 15:47:42.271363 (Thread-1): 15:47:42 | 3 of 4 START view model maxm.stg_payments............................ [RUN]
2021-03-30 15:47:42.271582 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-03-30 15:47:42.271660 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-03-30 15:47:42.277709 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-03-30 15:47:42.298536 (Thread-1): finished collecting timing info
2021-03-30 15:47:42.305817 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-03-30 15:47:42.327340 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 15:47:42.327784 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  OPTIONS()
  as select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,

    -- amount is stored in cents, convert it to dollars
    amount / 100 as amount,
    created as created_at

from `finl-1067321-eds-thunderdome.maxm.payments`;


2021-03-30 15:47:42.885010 (Thread-1): finished collecting timing info
2021-03-30 15:47:42.886025 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32349905-04be-4544-a690-4edc7432d836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fbb2e4f10>]}
2021-03-30 15:47:42.887331 (Thread-1): 15:47:42 | 3 of 4 OK created view model maxm.stg_payments....................... [CREATE VIEW in 0.61s]
2021-03-30 15:47:42.887455 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-03-30 15:47:42.887614 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-03-30 15:47:42.889030 (Thread-1): 15:47:42 | 4 of 4 START view model maxm.dim_customers........................... [RUN]
2021-03-30 15:47:42.889401 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:47:42.889523 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-03-30 15:47:42.900437 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-03-30 15:47:42.921709 (Thread-1): finished collecting timing info
2021-03-30 15:47:42.926636 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-03-30 15:47:42.946251 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 15:47:42.946669 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers`
  OPTIONS()
  as with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-03-30 15:47:43.188462 (Thread-128): handling poll request
2021-03-30 15:47:43.189041 (Thread-128): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727518e20>]}
2021-03-30 15:47:43.194068 (Thread-128): sending response (<Response 12450 bytes [200 OK]>) to 10.0.22.40
2021-03-30 15:47:43.410003 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/finl-1067321-eds-thunderdome/queries/fcdf99df-77fa-4b7c-879f-0f6fc9dc10f9?maxResults=0&location=US&prettyPrint=false: Unrecognized name: amount at [26:13]')
2021-03-30 15:47:44.672313 (Thread-129): handling poll request
2021-03-30 15:47:44.672733 (Thread-129): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7275232b0>]}
2021-03-30 15:47:44.673740 (Thread-129): sending response (<Response 829 bytes [200 OK]>) to 10.0.7.248
2021-03-30 15:47:44.780933 (Thread-1): finished collecting timing info
2021-03-30 15:47:44.781486 (Thread-1): Database Error in model dim_customers (models/marts/core/dim_customers.sql)
  Unrecognized name: amount at [26:13]
  compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 125, in result
    self._blocking_poll(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3098, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 104, in _blocking_poll
    retry_(self._done_or_raise)()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 83, in _done_or_raise
    if not self.done():
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3079, in done
    self._query_results = self._client._get_query_results(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 1286, in _get_query_results
    resource = self._call_api(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 556, in _call_api
    return call()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/_http.py", line 435, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/finl-1067321-eds-thunderdome/queries/0a1498a4-02e4-4de1-bd52-8daacf389563?maxResults=0&location=US&prettyPrint=false: Unrecognized name: amount at [26:13]

(job ID: 0a1498a4-02e4-4de1-bd52-8daacf389563)

                                                         -----Query Job SQL Follows-----                                                          

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */
   2:
   3:
   4:  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers`
   5:  OPTIONS()
   6:  as with customers as (
   7:
   8:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
   9:
  10:),
  11:
  12:orders as (
  13:
  14:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  15:
  16:),
  17:
  18:customer_orders as (
  19:
  20:    select
  21:        customer_id,
  22:
  23:        min(order_date) as first_order_date,
  24:        max(order_date) as most_recent_order_date,
  25:        count(order_id) as number_of_orders,
  26:        sum(amount) as lifetime_value
  27:
  28:    from orders
  29:
  30:    group by 1
  31:
  32:),
  33:
  34:final as (
  35:
  36:    select
  37:        customers.customer_id,
  38:        customers.first_name,
  39:        customers.last_name,
  40:        customer_orders.first_order_date,
  41:        customer_orders.most_recent_order_date,
  42:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  43:
  44:    from customers
  45:
  46:    left join customer_orders using (customer_id)
  47:
  48:)
  49:
  50:select * from final;
  51:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_customers (models/marts/core/dim_customers.sql)
  Unrecognized name: amount at [26:13]
  compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
2021-03-30 15:47:44.784589 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32349905-04be-4544-a690-4edc7432d836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fb89862b0>]}
2021-03-30 15:47:44.786132 (Thread-1): 15:47:44 | 4 of 4 ERROR creating view model maxm.dim_customers.................. [ERROR in 1.90s]
2021-03-30 15:47:44.786267 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-03-30 15:47:44.787609 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 15:47:44.787888 (MainThread): 15:47:44 | 
2021-03-30 15:47:44.787955 (MainThread): 15:47:44 | Finished running 4 view models in 4.39s.
2021-03-30 15:47:44.788004 (MainThread): Connection 'master' was properly closed.
2021-03-30 15:47:44.788045 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:47:44.836433 (MainThread): 
2021-03-30 15:47:44.836597 (MainThread): Completed with 1 error and 0 warnings:
2021-03-30 15:47:44.836657 (MainThread): 
2021-03-30 15:47:44.836711 (MainThread): Database Error in model dim_customers (models/marts/core/dim_customers.sql)
2021-03-30 15:47:44.836756 (MainThread):   Unrecognized name: amount at [26:13]
2021-03-30 15:47:44.836800 (MainThread):   compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
2021-03-30 15:47:44.836857 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2021-03-30 15:47:46.135275 (Thread-130): handling poll request
2021-03-30 15:47:46.135732 (Thread-130): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72716fe80>]}
2021-03-30 15:47:46.147355 (Thread-130): sending response (<Response 27473 bytes [200 OK]>) to 10.0.2.124
2021-03-30 15:47:46.625296 (Thread-131): handling status request
2021-03-30 15:47:46.625745 (Thread-131): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72660c250>]}
2021-03-30 15:47:46.626633 (Thread-131): sending response (<Response 448 bytes [200 OK]>) to 10.0.2.124
2021-03-30 15:48:51.739811 (Thread-132): Got an acceptable cached parse result
2021-03-30 15:48:51.793254 (Thread-132): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:48:52.108363 (Thread-133): handling status request
2021-03-30 15:48:52.108796 (Thread-133): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7275a2250>]}
2021-03-30 15:48:52.109967 (Thread-133): sending response (<Response 750 bytes [200 OK]>) to 10.0.18.81
2021-03-30 15:50:51.904451 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:50:51.953761 (Thread-134): Got an acceptable cached parse result
2021-03-30 15:50:52.149701 (Thread-134): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:50:52.370517 (Thread-135): handling status request
2021-03-30 15:50:52.370954 (Thread-135): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7266ecac0>]}
2021-03-30 15:50:52.371894 (Thread-135): sending response (<Response 750 bytes [200 OK]>) to 10.0.37.31
2021-03-30 15:50:54.091074 (Thread-136): handling status request
2021-03-30 15:50:54.091498 (Thread-136): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7271ccc40>]}
2021-03-30 15:50:54.092401 (Thread-136): sending response (<Response 750 bytes [200 OK]>) to 10.0.2.124
2021-03-30 15:50:54.565644 (Thread-137): handling run_sql request
2021-03-30 15:50:54.566198 (Thread-137): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7275a21c0>]}
2021-03-30 15:50:54.567648 (Thread-137): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:50:55.427880 (Thread-137): sending response (<Response 138 bytes [200 OK]>) to 10.0.7.248
2021-03-30 15:50:55.445595 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:50:55.509432 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 15:50:55.509958 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:50:55.510072 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 15:50:55.527412 (Thread-1): finished collecting timing info
2021-03-30 15:50:55.527657 (Thread-1): Opening a new connection, currently in state init
2021-03-30 15:50:55.528117 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),

customer_payments as (
    select
        order_id as order_id,
        amount as amount
    from payments
)

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        sum(customer_payments.amount) as lifetime_value

    from customers

    left join customer_orders using (customer_id)
    left join customer_payments using (order_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 15:50:55.988261 (Thread-138): handling poll request
2021-03-30 15:50:55.988849 (Thread-138): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7273eb550>]}
2021-03-30 15:50:55.991140 (Thread-138): sending response (<Response 3794 bytes [200 OK]>) to 10.0.22.40
2021-03-30 15:50:56.150693 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got identifier "final" at [40:1]')
2021-03-30 15:50:57.313639 (Thread-1): finished collecting timing info
2021-03-30 15:50:57.314010 (Thread-1): Got an exception: Database Error
  Syntax error: Expected "(" or "," or keyword SELECT but got identifier "final" at [40:1]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected "(" or "," or keyword SELECT but got identifier "final" at [40:1]

(job ID: 4fd03878-1446-4b4f-9f2b-4fd6d268d3d7)

                        -----Query Job SQL Follows-----                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with customers as (
   2:
   3:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
   4:
   5:),
   6:
   7:orders as (
   8:
   9:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  10:
  11:),
  12:
  13:payments as (
  14:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  15:),
  16:
  17:customer_orders as (
  18:
  19:    select
  20:        customer_id,
  21:
  22:        min(order_date) as first_order_date,
  23:        max(order_date) as most_recent_order_date,
  24:        count(order_id) as number_of_orders,
  25:        sum(amount) as lifetime_value
  26:
  27:    from orders
  28:
  29:    group by 1
  30:
  31:),
  32:
  33:customer_payments as (
  34:    select
  35:        order_id as order_id,
  36:        amount as amount
  37:    from payments
  38:)
  39:
  40:final as (
  41:
  42:    select
  43:        customers.customer_id,
  44:        customers.first_name,
  45:        customers.last_name,
  46:        customer_orders.first_order_date,
  47:        customer_orders.most_recent_order_date,
  48:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
  49:        sum(customer_payments.amount) as lifetime_value
  50:
  51:    from customers
  52:
  53:    left join customer_orders using (customer_id)
  54:    left join customer_payments using (order_id)
  55:
  56:)
  57:
  58:select * from final
  59:limit 500
  60:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Syntax error: Expected "(" or "," or keyword SELECT but got identifier "final" at [40:1]
2021-03-30 15:50:57.315845 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Syntax error: Expected "(" or "," or keyword SELECT but got identifier "final" at [40:1]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    select * from {{ ref('stg_payments' )}}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders,\n        sum(amount) as lifetime_value\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n)\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders,\n        sum(amount) as lifetime_value\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n)\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Syntax error: Expected "(" or "," or keyword SELECT but got identifier "final" at [40:1]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    select * from {{ ref('stg_payments' )}}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders,\n        sum(amount) as lifetime_value\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n)\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders,\n        sum(amount) as lifetime_value\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n)\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-30 15:50:57.546383 (Thread-139): handling poll request
2021-03-30 15:50:57.546821 (Thread-139): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72680a3a0>]}
2021-03-30 15:50:57.547824 (Thread-139): sending response (<Response 18877 bytes [200 OK]>) to 10.0.3.45
2021-03-30 15:51:07.935397 (Thread-140): Got an acceptable cached parse result
2021-03-30 15:51:07.987072 (Thread-140): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:51:08.276542 (Thread-141): handling status request
2021-03-30 15:51:08.276970 (Thread-141): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726875910>]}
2021-03-30 15:51:08.277911 (Thread-141): sending response (<Response 750 bytes [200 OK]>) to 10.0.27.28
2021-03-30 15:51:08.959378 (Thread-142): handling status request
2021-03-30 15:51:08.959800 (Thread-142): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726875dc0>]}
2021-03-30 15:51:08.960700 (Thread-142): sending response (<Response 750 bytes [200 OK]>) to 10.0.18.81
2021-03-30 15:51:09.439572 (Thread-143): handling run_sql request
2021-03-30 15:51:09.440033 (Thread-143): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7275888e0>]}
2021-03-30 15:51:09.441221 (Thread-143): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:51:10.298413 (Thread-143): sending response (<Response 138 bytes [200 OK]>) to 10.0.42.64
2021-03-30 15:51:10.315628 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:51:10.368651 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 15:51:10.369139 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:51:10.369260 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 15:51:10.386711 (Thread-1): finished collecting timing info
2021-03-30 15:51:10.386951 (Thread-1): Opening a new connection, currently in state init
2021-03-30 15:51:10.387403 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),

customer_payments as (
    select
        order_id as order_id,
        amount as amount
    from payments
),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        sum(customer_payments.amount) as lifetime_value

    from customers

    left join customer_orders using (customer_id)
    left join customer_payments using (order_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 15:51:10.684067 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: amount at [25:13]')
2021-03-30 15:51:10.898123 (Thread-144): handling poll request
2021-03-30 15:51:10.899380 (Thread-144): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726404e50>]}
2021-03-30 15:51:10.901485 (Thread-144): sending response (<Response 4112 bytes [200 OK]>) to 10.0.3.45
2021-03-30 15:51:11.910114 (Thread-1): finished collecting timing info
2021-03-30 15:51:11.910588 (Thread-1): Got an exception: Database Error
  Unrecognized name: amount at [25:13]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: amount at [25:13]

(job ID: 1d64cafc-968a-4881-bef8-c71265c88130)

                        -----Query Job SQL Follows-----                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with customers as (
   2:
   3:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
   4:
   5:),
   6:
   7:orders as (
   8:
   9:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  10:
  11:),
  12:
  13:payments as (
  14:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  15:),
  16:
  17:customer_orders as (
  18:
  19:    select
  20:        customer_id,
  21:
  22:        min(order_date) as first_order_date,
  23:        max(order_date) as most_recent_order_date,
  24:        count(order_id) as number_of_orders,
  25:        sum(amount) as lifetime_value
  26:
  27:    from orders
  28:
  29:    group by 1
  30:
  31:),
  32:
  33:customer_payments as (
  34:    select
  35:        order_id as order_id,
  36:        amount as amount
  37:    from payments
  38:),
  39:
  40:final as (
  41:
  42:    select
  43:        customers.customer_id,
  44:        customers.first_name,
  45:        customers.last_name,
  46:        customer_orders.first_order_date,
  47:        customer_orders.most_recent_order_date,
  48:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
  49:        sum(customer_payments.amount) as lifetime_value
  50:
  51:    from customers
  52:
  53:    left join customer_orders using (customer_id)
  54:    left join customer_payments using (order_id)
  55:
  56:)
  57:
  58:select * from final
  59:limit 500
  60:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Unrecognized name: amount at [25:13]
2021-03-30 15:51:11.913334 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: amount at [25:13]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    select * from {{ ref('stg_payments' )}}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders,\n        sum(amount) as lifetime_value\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders,\n        sum(amount) as lifetime_value\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: amount at [25:13]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    select * from {{ ref('stg_payments' )}}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders,\n        sum(amount) as lifetime_value\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders,\n        sum(amount) as lifetime_value\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-30 15:51:12.413720 (Thread-145): handling poll request
2021-03-30 15:51:12.414141 (Thread-145): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726875ac0>]}
2021-03-30 15:51:12.415071 (Thread-145): sending response (<Response 18479 bytes [200 OK]>) to 10.0.2.124
2021-03-30 15:52:56.846702 (Thread-146): Got an acceptable cached parse result
2021-03-30 15:52:56.903090 (Thread-146): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:52:57.280278 (Thread-147): handling status request
2021-03-30 15:52:57.280921 (Thread-147): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267fde80>]}
2021-03-30 15:52:57.282666 (Thread-147): sending response (<Response 750 bytes [200 OK]>) to 10.0.33.81
2021-03-30 15:53:00.381955 (Thread-148): handling status request
2021-03-30 15:53:00.382392 (Thread-148): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7268756d0>]}
2021-03-30 15:53:00.383317 (Thread-148): sending response (<Response 750 bytes [200 OK]>) to 10.0.27.42
2021-03-30 15:53:00.872444 (Thread-149): handling run_sql request
2021-03-30 15:53:00.872855 (Thread-149): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267fd2e0>]}
2021-03-30 15:53:00.874071 (Thread-149): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:53:01.727050 (Thread-149): sending response (<Response 138 bytes [200 OK]>) to 10.0.42.64
2021-03-30 15:53:01.744169 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:53:01.795767 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 15:53:01.796274 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:53:01.796402 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 15:53:01.814705 (Thread-1): finished collecting timing info
2021-03-30 15:53:01.814964 (Thread-1): Opening a new connection, currently in state init
2021-03-30 15:53:01.815445 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    select
        order_id as order_id,
        amount as amount
    from payments
),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        sum(customer_payments.amount) as lifetime_value

    from customers

    left join customer_orders using (customer_id)
    left join customer_payments using (order_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 15:53:02.195975 (Thread-150): handling poll request
2021-03-30 15:53:02.196434 (Thread-150): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7264b4130>]}
2021-03-30 15:53:02.198515 (Thread-150): sending response (<Response 3755 bytes [200 OK]>) to 10.0.15.161
2021-03-30 15:53:02.352110 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Column order_id in USING clause not found on left side of join at [53:40]')
2021-03-30 15:53:02.810472 (Thread-1): finished collecting timing info
2021-03-30 15:53:02.810791 (Thread-1): Got an exception: Database Error
  Column order_id in USING clause not found on left side of join at [53:40]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Column order_id in USING clause not found on left side of join at [53:40]

(job ID: e36c357e-9e34-48d2-9be3-156407e1b3e1)

                        -----Query Job SQL Follows-----                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with customers as (
   2:
   3:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
   4:
   5:),
   6:
   7:orders as (
   8:
   9:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  10:
  11:),
  12:
  13:payments as (
  14:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  15:),
  16:
  17:customer_orders as (
  18:
  19:    select
  20:        customer_id,
  21:
  22:        min(order_date) as first_order_date,
  23:        max(order_date) as most_recent_order_date,
  24:        count(order_id) as number_of_orders
  25:
  26:    from orders
  27:
  28:    group by 1
  29:
  30:),
  31:
  32:customer_payments as (
  33:    select
  34:        order_id as order_id,
  35:        amount as amount
  36:    from payments
  37:),
  38:
  39:final as (
  40:
  41:    select
  42:        customers.customer_id,
  43:        customers.first_name,
  44:        customers.last_name,
  45:        customer_orders.first_order_date,
  46:        customer_orders.most_recent_order_date,
  47:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
  48:        sum(customer_payments.amount) as lifetime_value
  49:
  50:    from customers
  51:
  52:    left join customer_orders using (customer_id)
  53:    left join customer_payments using (order_id)
  54:
  55:)
  56:
  57:select * from final
  58:limit 500
  59:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Column order_id in USING clause not found on left side of join at [53:40]
2021-03-30 15:53:02.812753 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Column order_id in USING clause not found on left side of join at [53:40]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    select * from {{ ref('stg_payments' )}}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Column order_id in USING clause not found on left side of join at [53:40]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    select * from {{ ref('stg_payments' )}}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-30 15:53:03.749241 (Thread-151): handling poll request
2021-03-30 15:53:03.749690 (Thread-151): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7264b42e0>]}
2021-03-30 15:53:03.750654 (Thread-151): sending response (<Response 18409 bytes [200 OK]>) to 10.0.27.42
2021-03-30 15:53:37.843069 (Thread-152): Got an acceptable cached parse result
2021-03-30 15:53:38.027776 (Thread-152): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:53:38.277529 (Thread-153): handling status request
2021-03-30 15:53:38.277984 (Thread-153): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267fd340>]}
2021-03-30 15:53:38.278931 (Thread-153): sending response (<Response 750 bytes [200 OK]>) to 10.0.2.124
2021-03-30 15:53:39.439164 (Thread-154): handling status request
2021-03-30 15:53:39.439578 (Thread-154): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7266e8580>]}
2021-03-30 15:53:39.440483 (Thread-154): sending response (<Response 750 bytes [200 OK]>) to 10.0.1.181
2021-03-30 15:53:40.032133 (Thread-155): handling run_sql request
2021-03-30 15:53:40.032549 (Thread-155): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727351df0>]}
2021-03-30 15:53:40.033801 (Thread-155): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:53:40.876164 (Thread-155): sending response (<Response 138 bytes [200 OK]>) to 10.0.22.23
2021-03-30 15:53:40.893352 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:53:40.942749 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 15:53:40.943307 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:53:40.943435 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 15:53:40.961023 (Thread-1): finished collecting timing info
2021-03-30 15:53:40.961272 (Thread-1): Opening a new connection, currently in state init
2021-03-30 15:53:40.961897 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    select
        order_id as order_id,
        amount as amount
    from payments
),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        sum(customer_payments.amount) as lifetime_value

    from customers

    left join customer_orders co using (customer_id)
    left join customer_payments cp on co.order_id = cp.order_id

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 15:53:41.347702 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Name order_id not found inside co at [53:42]')
2021-03-30 15:53:42.276134 (Thread-156): handling poll request
2021-03-30 15:53:42.276588 (Thread-156): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7268231f0>]}
2021-03-30 15:53:42.278792 (Thread-156): sending response (<Response 4097 bytes [200 OK]>) to 10.0.15.161
2021-03-30 15:53:42.565319 (Thread-1): finished collecting timing info
2021-03-30 15:53:42.565637 (Thread-1): Got an exception: Database Error
  Name order_id not found inside co at [53:42]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Name order_id not found inside co at [53:42]

(job ID: d371519a-b1e4-4e42-b5bb-545ded9c150c)

                        -----Query Job SQL Follows-----                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with customers as (
   2:
   3:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
   4:
   5:),
   6:
   7:orders as (
   8:
   9:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  10:
  11:),
  12:
  13:payments as (
  14:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  15:),
  16:
  17:customer_orders as (
  18:
  19:    select
  20:        customer_id,
  21:
  22:        min(order_date) as first_order_date,
  23:        max(order_date) as most_recent_order_date,
  24:        count(order_id) as number_of_orders
  25:
  26:    from orders
  27:
  28:    group by 1
  29:
  30:),
  31:
  32:customer_payments as (
  33:    select
  34:        order_id as order_id,
  35:        amount as amount
  36:    from payments
  37:),
  38:
  39:final as (
  40:
  41:    select
  42:        customers.customer_id,
  43:        customers.first_name,
  44:        customers.last_name,
  45:        customer_orders.first_order_date,
  46:        customer_orders.most_recent_order_date,
  47:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
  48:        sum(customer_payments.amount) as lifetime_value
  49:
  50:    from customers
  51:
  52:    left join customer_orders co using (customer_id)
  53:    left join customer_payments cp on co.order_id = cp.order_id
  54:
  55:)
  56:
  57:select * from final
  58:limit 500
  59:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Name order_id not found inside co at [53:42]
2021-03-30 15:53:42.567508 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Name order_id not found inside co at [53:42]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    select * from {{ ref('stg_payments' )}}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Name order_id not found inside co at [53:42]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    select * from {{ ref('stg_payments' )}}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-30 15:53:43.905227 (Thread-157): handling poll request
2021-03-30 15:53:43.905653 (Thread-157): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726823e80>]}
2021-03-30 15:53:43.935129 (Thread-157): sending response (<Response 18350 bytes [200 OK]>) to 10.0.22.40
2021-03-30 15:54:00.101918 (Thread-158): Got an acceptable cached parse result
2021-03-30 15:54:00.155377 (Thread-158): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:54:00.524919 (Thread-159): handling status request
2021-03-30 15:54:00.525355 (Thread-159): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726789790>]}
2021-03-30 15:54:00.526368 (Thread-159): sending response (<Response 750 bytes [200 OK]>) to 10.0.37.31
2021-03-30 15:54:02.889242 (Thread-160): handling status request
2021-03-30 15:54:02.889854 (Thread-160): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7275461f0>]}
2021-03-30 15:54:02.891112 (Thread-160): sending response (<Response 750 bytes [200 OK]>) to 10.0.2.124
2021-03-30 15:54:03.562094 (Thread-161): handling run_sql request
2021-03-30 15:54:03.562502 (Thread-161): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727546b80>]}
2021-03-30 15:54:03.564010 (Thread-161): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:54:04.472854 (Thread-161): sending response (<Response 138 bytes [200 OK]>) to 10.0.22.40
2021-03-30 15:54:04.492257 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:54:04.545998 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 15:54:04.546499 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:54:04.546604 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 15:54:04.564370 (Thread-1): finished collecting timing info
2021-03-30 15:54:04.564645 (Thread-1): Opening a new connection, currently in state init
2021-03-30 15:54:04.565243 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
),

customer_orders as (

    select
        customer_id,
        order_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    select
        order_id as order_id,
        amount as amount
    from payments
),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        sum(customer_payments.amount) as lifetime_value

    from customers

    left join customer_orders co using (customer_id)
    left join customer_payments cp on co.order_id = cp.order_id

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 15:54:04.860554 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column order_id which is neither grouped nor aggregated at [21:9]')
2021-03-30 15:54:05.038514 (Thread-162): handling poll request
2021-03-30 15:54:05.038975 (Thread-162): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72654f610>]}
2021-03-30 15:54:05.041081 (Thread-162): sending response (<Response 4170 bytes [200 OK]>) to 10.0.3.45
2021-03-30 15:54:06.062706 (Thread-1): finished collecting timing info
2021-03-30 15:54:06.063045 (Thread-1): Got an exception: Database Error
  SELECT list expression references column order_id which is neither grouped nor aggregated at [21:9]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 SELECT list expression references column order_id which is neither grouped nor aggregated at [21:9]

(job ID: 536686d8-c784-4ff2-ba84-0949524fc541)

                        -----Query Job SQL Follows-----                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with customers as (
   2:
   3:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
   4:
   5:),
   6:
   7:orders as (
   8:
   9:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  10:
  11:),
  12:
  13:payments as (
  14:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  15:),
  16:
  17:customer_orders as (
  18:
  19:    select
  20:        customer_id,
  21:        order_id,
  22:        min(order_date) as first_order_date,
  23:        max(order_date) as most_recent_order_date,
  24:        count(order_id) as number_of_orders
  25:
  26:    from orders
  27:
  28:    group by 1
  29:
  30:),
  31:
  32:customer_payments as (
  33:    select
  34:        order_id as order_id,
  35:        amount as amount
  36:    from payments
  37:),
  38:
  39:final as (
  40:
  41:    select
  42:        customers.customer_id,
  43:        customers.first_name,
  44:        customers.last_name,
  45:        customer_orders.first_order_date,
  46:        customer_orders.most_recent_order_date,
  47:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
  48:        sum(customer_payments.amount) as lifetime_value
  49:
  50:    from customers
  51:
  52:    left join customer_orders co using (customer_id)
  53:    left join customer_payments cp on co.order_id = cp.order_id
  54:
  55:)
  56:
  57:select * from final
  58:limit 500
  59:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  SELECT list expression references column order_id which is neither grouped nor aggregated at [21:9]
2021-03-30 15:54:06.064896 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  SELECT list expression references column order_id which is neither grouped nor aggregated at [21:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    select * from {{ ref('stg_payments' )}}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  SELECT list expression references column order_id which is neither grouped nor aggregated at [21:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    select * from {{ ref('stg_payments' )}}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-30 15:54:06.607641 (Thread-163): handling poll request
2021-03-30 15:54:06.608063 (Thread-163): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72654f910>]}
2021-03-30 15:54:06.609011 (Thread-163): sending response (<Response 18871 bytes [200 OK]>) to 10.0.33.160
2021-03-30 15:54:20.404509 (Thread-164): Got an acceptable cached parse result
2021-03-30 15:54:20.463449 (Thread-164): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:54:20.870530 (Thread-165): handling status request
2021-03-30 15:54:20.871121 (Thread-165): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7266710a0>]}
2021-03-30 15:54:20.872722 (Thread-165): sending response (<Response 750 bytes [200 OK]>) to 10.0.34.79
2021-03-30 15:54:22.329849 (Thread-166): handling status request
2021-03-30 15:54:22.330283 (Thread-166): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7272629d0>]}
2021-03-30 15:54:22.331179 (Thread-166): sending response (<Response 750 bytes [200 OK]>) to 10.0.1.181
2021-03-30 15:54:23.534242 (Thread-167): handling run_sql request
2021-03-30 15:54:23.534674 (Thread-167): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727262b50>]}
2021-03-30 15:54:23.535904 (Thread-167): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:54:24.368527 (Thread-167): sending response (<Response 138 bytes [200 OK]>) to 10.0.22.23
2021-03-30 15:54:24.385414 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:54:24.433526 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 15:54:24.434019 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:54:24.434124 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 15:54:24.450776 (Thread-1): finished collecting timing info
2021-03-30 15:54:24.451001 (Thread-1): Opening a new connection, currently in state init
2021-03-30 15:54:24.451414 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
),

customer_orders as (

    select
        customer_id,
        order_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1,2

),

customer_payments as (
    select
        order_id as order_id,
        amount as amount
    from payments
),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        sum(customer_payments.amount) as lifetime_value

    from customers

    left join customer_orders co using (customer_id)
    left join customer_payments cp on co.order_id = cp.order_id

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 15:54:24.843945 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_orders; Did you mean customer_id? at [45:9]')
2021-03-30 15:54:24.926079 (Thread-168): handling poll request
2021-03-30 15:54:24.926556 (Thread-168): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7271feac0>]}
2021-03-30 15:54:24.928661 (Thread-168): sending response (<Response 4144 bytes [200 OK]>) to 10.0.33.160
2021-03-30 15:54:25.632032 (Thread-1): finished collecting timing info
2021-03-30 15:54:25.632376 (Thread-1): Got an exception: Database Error
  Unrecognized name: customer_orders; Did you mean customer_id? at [45:9]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: customer_orders; Did you mean customer_id? at [45:9]

(job ID: 64907315-841b-419d-aa2f-fa079c765095)

                        -----Query Job SQL Follows-----                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with customers as (
   2:
   3:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
   4:
   5:),
   6:
   7:orders as (
   8:
   9:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  10:
  11:),
  12:
  13:payments as (
  14:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  15:),
  16:
  17:customer_orders as (
  18:
  19:    select
  20:        customer_id,
  21:        order_id,
  22:        min(order_date) as first_order_date,
  23:        max(order_date) as most_recent_order_date,
  24:        count(order_id) as number_of_orders
  25:
  26:    from orders
  27:
  28:    group by 1,2
  29:
  30:),
  31:
  32:customer_payments as (
  33:    select
  34:        order_id as order_id,
  35:        amount as amount
  36:    from payments
  37:),
  38:
  39:final as (
  40:
  41:    select
  42:        customers.customer_id,
  43:        customers.first_name,
  44:        customers.last_name,
  45:        customer_orders.first_order_date,
  46:        customer_orders.most_recent_order_date,
  47:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
  48:        sum(customer_payments.amount) as lifetime_value
  49:
  50:    from customers
  51:
  52:    left join customer_orders co using (customer_id)
  53:    left join customer_payments cp on co.order_id = cp.order_id
  54:
  55:)
  56:
  57:select * from final
  58:limit 500
  59:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Unrecognized name: customer_orders; Did you mean customer_id? at [45:9]
2021-03-30 15:54:25.634323 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: customer_orders; Did you mean customer_id? at [45:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    select * from {{ ref('stg_payments' )}}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: customer_orders; Did you mean customer_id? at [45:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    select * from {{ ref('stg_payments' )}}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    select\n        order_id as order_id,\n        amount as amount\n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-30 15:54:26.664109 (Thread-169): handling poll request
2021-03-30 15:54:26.664581 (Thread-169): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727262730>]}
2021-03-30 15:54:26.665522 (Thread-169): sending response (<Response 18691 bytes [200 OK]>) to 10.0.33.160
2021-03-30 15:56:24.106736 (Thread-170): Got an acceptable cached parse result
2021-03-30 15:56:24.158686 (Thread-170): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:56:25.314154 (Thread-171): handling status request
2021-03-30 15:56:25.314599 (Thread-171): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7271a99a0>]}
2021-03-30 15:56:25.315504 (Thread-171): sending response (<Response 750 bytes [200 OK]>) to 10.0.18.81
2021-03-30 15:56:25.782679 (Thread-172): handling status request
2021-03-30 15:56:25.783092 (Thread-172): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7272bc760>]}
2021-03-30 15:56:25.784149 (Thread-172): sending response (<Response 750 bytes [200 OK]>) to 10.0.15.161
2021-03-30 15:56:26.211779 (Thread-173): handling run_sql request
2021-03-30 15:56:26.212262 (Thread-173): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7272bc070>]}
2021-03-30 15:56:26.213420 (Thread-173): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:56:27.092691 (Thread-173): sending response (<Response 138 bytes [200 OK]>) to 10.0.5.204
2021-03-30 15:56:27.109840 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:56:27.165875 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 15:56:27.166358 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:56:27.166485 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 15:56:27.184051 (Thread-1): finished collecting timing info
2021-03-30 15:56:27.184305 (Thread-1): Opening a new connection, currently in state init
2021-03-30 15:56:27.184815 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
),

customer_orders as (

    select
        customer_id,
        order_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1,2

),

customer_payments as (
    select
        order_id ,
        amount 
    
    from payments
),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        sum(customer_payments.amount) as lifetime_value

    from customers

    left join customer_orders co using (customer_id)
    left join customer_payments cp on co.order_id = cp.order_id

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 15:56:27.765408 (Thread-174): handling poll request
2021-03-30 15:56:27.765894 (Thread-174): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726633f40>]}
2021-03-30 15:56:27.767891 (Thread-174): sending response (<Response 3778 bytes [200 OK]>) to 10.0.26.97
2021-03-30 15:56:27.869165 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_orders; Did you mean customer_id? at [46:9]')
2021-03-30 15:56:29.158304 (Thread-1): finished collecting timing info
2021-03-30 15:56:29.158635 (Thread-1): Got an exception: Database Error
  Unrecognized name: customer_orders; Did you mean customer_id? at [46:9]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: customer_orders; Did you mean customer_id? at [46:9]

(job ID: 3f3d7a87-d2a8-4c62-9c1d-d3b132ab5c9f)

                        -----Query Job SQL Follows-----                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with customers as (
   2:
   3:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
   4:
   5:),
   6:
   7:orders as (
   8:
   9:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  10:
  11:),
  12:
  13:payments as (
  14:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  15:),
  16:
  17:customer_orders as (
  18:
  19:    select
  20:        customer_id,
  21:        order_id,
  22:        min(order_date) as first_order_date,
  23:        max(order_date) as most_recent_order_date,
  24:        count(order_id) as number_of_orders
  25:
  26:    from orders
  27:
  28:    group by 1,2
  29:
  30:),
  31:
  32:customer_payments as (
  33:    select
  34:        order_id ,
  35:        amount 
  36:    
  37:    from payments
  38:),
  39:
  40:final as (
  41:
  42:    select
  43:        customers.customer_id,
  44:        customers.first_name,
  45:        customers.last_name,
  46:        customer_orders.first_order_date,
  47:        customer_orders.most_recent_order_date,
  48:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
  49:        sum(customer_payments.amount) as lifetime_value
  50:
  51:    from customers
  52:
  53:    left join customer_orders co using (customer_id)
  54:    left join customer_payments cp on co.order_id = cp.order_id
  55:
  56:)
  57:
  58:select * from final
  59:limit 500
  60:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Unrecognized name: customer_orders; Did you mean customer_id? at [46:9]
2021-03-30 15:56:29.160513 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: customer_orders; Did you mean customer_id? at [46:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    select * from {{ ref('stg_payments' )}}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    select\n        order_id ,\n        amount \n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    select\n        order_id ,\n        amount \n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: customer_orders; Did you mean customer_id? at [46:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    select * from {{ ref('stg_payments' )}}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    select\n        order_id ,\n        amount \n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    select\n        order_id ,\n        amount \n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-30 15:56:29.210490 (Thread-175): handling poll request
2021-03-30 15:56:29.210918 (Thread-175): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72746e640>]}
2021-03-30 15:56:29.212254 (Thread-175): sending response (<Response 12831 bytes [200 OK]>) to 10.0.27.42
2021-03-30 15:56:30.873162 (Thread-176): handling poll request
2021-03-30 15:56:30.873622 (Thread-176): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7263f26d0>]}
2021-03-30 15:56:30.874621 (Thread-176): sending response (<Response 18588 bytes [200 OK]>) to 10.0.26.97
2021-03-30 15:56:49.711439 (Thread-177): Got an acceptable cached parse result
2021-03-30 15:56:49.782102 (Thread-177): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:56:50.103295 (Thread-178): handling status request
2021-03-30 15:56:50.103738 (Thread-178): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7266d4730>]}
2021-03-30 15:56:50.104744 (Thread-178): sending response (<Response 750 bytes [200 OK]>) to 10.0.27.42
2021-03-30 15:56:50.807509 (Thread-179): handling status request
2021-03-30 15:56:50.807932 (Thread-179): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7266d40d0>]}
2021-03-30 15:56:50.808853 (Thread-179): sending response (<Response 750 bytes [200 OK]>) to 10.0.7.248
2021-03-30 15:56:51.281377 (Thread-180): handling run_sql request
2021-03-30 15:56:51.281839 (Thread-180): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727442580>]}
2021-03-30 15:56:51.283163 (Thread-180): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:56:52.174220 (Thread-180): sending response (<Response 138 bytes [200 OK]>) to 10.0.3.45
2021-03-30 15:56:52.191918 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:56:52.243926 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 15:56:52.244438 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:56:52.244576 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 15:56:52.262270 (Thread-1): finished collecting timing info
2021-03-30 15:56:52.262522 (Thread-1): Opening a new connection, currently in state init
2021-03-30 15:56:52.263022 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
),

customer_orders as (

    select
        customer_id,
        order_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1,2

),

customer_payments as (
    select
        order_id ,
        amount 
    
    from payments
),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        sum(customer_payments.amount) as lifetime_value

    from customers

    left join customer_orders co using (customer_id)
    --left join customer_payments cp on co.order_id = cp.order_id

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 15:56:52.563151 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_orders; Did you mean customer_id? at [46:9]')
2021-03-30 15:56:52.600287 (Thread-181): handling poll request
2021-03-30 15:56:52.600742 (Thread-181): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7273eb490>]}
2021-03-30 15:56:52.602942 (Thread-181): sending response (<Response 4132 bytes [200 OK]>) to 10.0.5.204
2021-03-30 15:56:53.790669 (Thread-1): finished collecting timing info
2021-03-30 15:56:53.791091 (Thread-1): Got an exception: Database Error
  Unrecognized name: customer_orders; Did you mean customer_id? at [46:9]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: customer_orders; Did you mean customer_id? at [46:9]

(job ID: 445e5e0e-653a-4108-8607-f1f2584a97f5)

                        -----Query Job SQL Follows-----                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with customers as (
   2:
   3:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
   4:
   5:),
   6:
   7:orders as (
   8:
   9:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  10:
  11:),
  12:
  13:payments as (
  14:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  15:),
  16:
  17:customer_orders as (
  18:
  19:    select
  20:        customer_id,
  21:        order_id,
  22:        min(order_date) as first_order_date,
  23:        max(order_date) as most_recent_order_date,
  24:        count(order_id) as number_of_orders
  25:
  26:    from orders
  27:
  28:    group by 1,2
  29:
  30:),
  31:
  32:customer_payments as (
  33:    select
  34:        order_id ,
  35:        amount 
  36:    
  37:    from payments
  38:),
  39:
  40:final as (
  41:
  42:    select
  43:        customers.customer_id,
  44:        customers.first_name,
  45:        customers.last_name,
  46:        customer_orders.first_order_date,
  47:        customer_orders.most_recent_order_date,
  48:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
  49:        sum(customer_payments.amount) as lifetime_value
  50:
  51:    from customers
  52:
  53:    left join customer_orders co using (customer_id)
  54:    --left join customer_payments cp on co.order_id = cp.order_id
  55:
  56:)
  57:
  58:select * from final
  59:limit 500
  60:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Unrecognized name: customer_orders; Did you mean customer_id? at [46:9]
2021-03-30 15:56:53.792974 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: customer_orders; Did you mean customer_id? at [46:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    select * from {{ ref('stg_payments' )}}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    select\n        order_id ,\n        amount \n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    --left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    select\n        order_id ,\n        amount \n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    --left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: customer_orders; Did you mean customer_id? at [46:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    select * from {{ ref('stg_payments' )}}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    select\n        order_id ,\n        amount \n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    --left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    select\n        order_id ,\n        amount \n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    --left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-30 15:56:54.132459 (Thread-182): handling poll request
2021-03-30 15:56:54.132875 (Thread-182): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727351e50>]}
2021-03-30 15:56:54.133881 (Thread-182): sending response (<Response 18604 bytes [200 OK]>) to 10.0.26.97
2021-03-30 15:56:59.588633 (Thread-183): Got an acceptable cached parse result
2021-03-30 15:56:59.642714 (Thread-183): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:57:00.041960 (Thread-184): handling status request
2021-03-30 15:57:00.042415 (Thread-184): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7265fe640>]}
2021-03-30 15:57:00.043336 (Thread-184): sending response (<Response 750 bytes [200 OK]>) to 10.0.33.81
2021-03-30 15:57:58.409170 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:57:58.455633 (Thread-185): Got an acceptable cached parse result
2021-03-30 15:57:58.505312 (Thread-185): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:57:58.884977 (Thread-186): handling status request
2021-03-30 15:57:58.885552 (Thread-186): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726116940>]}
2021-03-30 15:57:58.886852 (Thread-186): sending response (<Response 750 bytes [200 OK]>) to 10.0.33.160
2021-03-30 15:58:07.493552 (Thread-187): handling status request
2021-03-30 15:58:07.494149 (Thread-187): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7261162b0>]}
2021-03-30 15:58:07.495425 (Thread-187): sending response (<Response 750 bytes [200 OK]>) to 10.0.15.161
2021-03-30 15:58:08.135941 (Thread-188): handling run_sql request
2021-03-30 15:58:08.136370 (Thread-188): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7264d8400>]}
2021-03-30 15:58:08.137983 (Thread-188): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:58:08.985140 (Thread-188): sending response (<Response 138 bytes [200 OK]>) to 10.0.37.31
2021-03-30 15:58:09.002581 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:58:09.057871 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 15:58:09.058406 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:58:09.058509 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 15:58:09.076293 (Thread-1): finished collecting timing info
2021-03-30 15:58:09.076609 (Thread-1): Opening a new connection, currently in state init
2021-03-30 15:58:09.077079 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
),

customer_orders as (

    select
        customer_id,
        order_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1,2

),

customer_payments as (
    select
        order_id ,
        amount 
    
    from payments
),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        sum(customer_payments.amount) as lifetime_value

    from customers

    left join customer_orders co using (customer_id)
    left join customer_payments cp on co.order_id = cp.order_id

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 15:58:09.435379 (Thread-189): handling poll request
2021-03-30 15:58:09.435829 (Thread-189): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726304c40>]}
2021-03-30 15:58:09.437900 (Thread-189): sending response (<Response 3778 bytes [200 OK]>) to 10.0.2.124
2021-03-30 15:58:09.454218 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_orders; Did you mean customer_id? at [46:9]')
2021-03-30 15:58:10.698992 (Thread-1): finished collecting timing info
2021-03-30 15:58:10.699318 (Thread-1): Got an exception: Database Error
  Unrecognized name: customer_orders; Did you mean customer_id? at [46:9]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: customer_orders; Did you mean customer_id? at [46:9]

(job ID: 3197f80f-02a9-4a69-a337-b31c69eb6b13)

                        -----Query Job SQL Follows-----                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with customers as (
   2:
   3:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
   4:
   5:),
   6:
   7:orders as (
   8:
   9:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  10:
  11:),
  12:
  13:payments as (
  14:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  15:),
  16:
  17:customer_orders as (
  18:
  19:    select
  20:        customer_id,
  21:        order_id,
  22:        min(order_date) as first_order_date,
  23:        max(order_date) as most_recent_order_date,
  24:        count(order_id) as number_of_orders
  25:
  26:    from orders
  27:
  28:    group by 1,2
  29:
  30:),
  31:
  32:customer_payments as (
  33:    select
  34:        order_id ,
  35:        amount 
  36:    
  37:    from payments
  38:),
  39:
  40:final as (
  41:
  42:    select
  43:        customers.customer_id,
  44:        customers.first_name,
  45:        customers.last_name,
  46:        customer_orders.first_order_date,
  47:        customer_orders.most_recent_order_date,
  48:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
  49:        sum(customer_payments.amount) as lifetime_value
  50:
  51:    from customers
  52:
  53:    left join customer_orders co using (customer_id)
  54:    left join customer_payments cp on co.order_id = cp.order_id
  55:
  56:)
  57:
  58:select * from final
  59:limit 500
  60:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Unrecognized name: customer_orders; Did you mean customer_id? at [46:9]
2021-03-30 15:58:10.701138 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: customer_orders; Did you mean customer_id? at [46:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers') }}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    select * from {{ ref('stg_payments') }}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    select\n        order_id ,\n        amount \n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    select\n        order_id ,\n        amount \n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: customer_orders; Did you mean customer_id? at [46:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers') }}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    select * from {{ ref('stg_payments') }}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    select\n        order_id ,\n        amount \n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    select\n        order_id ,\n        amount \n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-30 15:58:11.099390 (Thread-190): handling poll request
2021-03-30 15:58:11.099848 (Thread-190): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7264d8b80>]}
2021-03-30 15:58:11.100883 (Thread-190): sending response (<Response 18591 bytes [200 OK]>) to 10.0.26.97
2021-03-30 15:58:41.823696 (Thread-191): Got an acceptable cached parse result
2021-03-30 15:58:42.018158 (Thread-191): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 15:58:42.240251 (Thread-192): handling status request
2021-03-30 15:58:42.240687 (Thread-192): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72611ae80>]}
2021-03-30 15:58:42.241615 (Thread-192): sending response (<Response 750 bytes [200 OK]>) to 10.0.18.81
2021-03-30 15:58:54.531309 (Thread-193): handling status request
2021-03-30 15:58:54.531731 (Thread-193): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72734be20>]}
2021-03-30 15:58:54.532643 (Thread-193): sending response (<Response 750 bytes [200 OK]>) to 10.0.27.42
2021-03-30 15:58:55.032550 (Thread-194): handling run_sql request
2021-03-30 15:58:55.033017 (Thread-194): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7264b1b80>]}
2021-03-30 15:58:55.059293 (Thread-194): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 15:58:55.965327 (Thread-194): sending response (<Response 138 bytes [200 OK]>) to 10.0.27.42
2021-03-30 15:58:55.983067 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:58:56.035719 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 15:58:56.036210 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 15:58:56.036337 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 15:58:56.053587 (Thread-1): finished collecting timing info
2021-03-30 15:58:56.053893 (Thread-1): Opening a new connection, currently in state init
2021-03-30 15:58:56.054482 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`

),

customer_orders as (

    select
        customer_id,
        order_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1,2

),

customer_payments as (
    select
        order_id ,
        amount 
    
    from payments
),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        sum(customer_payments.amount) as lifetime_value

    from customers

    left join customer_orders co using (customer_id)
    left join customer_payments cp on co.order_id = cp.order_id

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 15:58:56.433282 (Thread-195): handling poll request
2021-03-30 15:58:56.433809 (Thread-195): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726116850>]}
2021-03-30 15:58:56.435793 (Thread-195): sending response (<Response 3786 bytes [200 OK]>) to 10.0.1.181
2021-03-30 15:58:56.461070 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]')
2021-03-30 15:58:57.716748 (Thread-1): finished collecting timing info
2021-03-30 15:58:57.717079 (Thread-1): Got an exception: Database Error
  Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]

(job ID: 498df080-5b6b-41bf-ae4e-18e1c026f166)

                        -----Query Job SQL Follows-----                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with customers as (
   2:
   3:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
   4:
   5:),
   6:
   7:orders as (
   8:
   9:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  10:
  11:),
  12:
  13:payments as (
  14:    
  15:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  16:
  17:),
  18:
  19:customer_orders as (
  20:
  21:    select
  22:        customer_id,
  23:        order_id,
  24:        min(order_date) as first_order_date,
  25:        max(order_date) as most_recent_order_date,
  26:        count(order_id) as number_of_orders
  27:
  28:    from orders
  29:
  30:    group by 1,2
  31:
  32:),
  33:
  34:customer_payments as (
  35:    select
  36:        order_id ,
  37:        amount 
  38:    
  39:    from payments
  40:),
  41:
  42:final as (
  43:
  44:    select
  45:        customers.customer_id,
  46:        customers.first_name,
  47:        customers.last_name,
  48:        customer_orders.first_order_date,
  49:        customer_orders.most_recent_order_date,
  50:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
  51:        sum(customer_payments.amount) as lifetime_value
  52:
  53:    from customers
  54:
  55:    left join customer_orders co using (customer_id)
  56:    left join customer_payments cp on co.order_id = cp.order_id
  57:
  58:)
  59:
  60:select * from final
  61:limit 500
  62:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]
2021-03-30 15:58:57.718983 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers') }}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    \n    select * from {{ ref('stg_payments') }}\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    select\n        order_id ,\n        amount \n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    \n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    select\n        order_id ,\n        amount \n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers') }}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    \n    select * from {{ ref('stg_payments') }}\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    select\n        order_id ,\n        amount \n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    \n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    select\n        order_id ,\n        amount \n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-30 15:58:58.097463 (Thread-196): handling poll request
2021-03-30 15:58:58.097994 (Thread-196): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7266c3400>]}
2021-03-30 15:58:58.099007 (Thread-196): sending response (<Response 18673 bytes [200 OK]>) to 10.0.15.161
2021-03-30 16:00:14.403860 (Thread-197): Got an acceptable cached parse result
2021-03-30 16:00:14.461366 (Thread-197): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 16:00:14.800917 (Thread-198): handling status request
2021-03-30 16:00:14.801370 (Thread-198): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267b95e0>]}
2021-03-30 16:00:14.802378 (Thread-198): sending response (<Response 750 bytes [200 OK]>) to 10.0.22.23
2021-03-30 16:00:16.496575 (Thread-199): handling status request
2021-03-30 16:00:16.497005 (Thread-199): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267b9ca0>]}
2021-03-30 16:00:16.498010 (Thread-199): sending response (<Response 750 bytes [200 OK]>) to 10.0.33.160
2021-03-30 16:00:16.964874 (Thread-200): handling compile_sql request
2021-03-30 16:00:16.965316 (Thread-200): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72662f5e0>]}
2021-03-30 16:00:16.966579 (Thread-200): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 16:00:17.809781 (Thread-200): sending response (<Response 138 bytes [200 OK]>) to 10.0.42.64
2021-03-30 16:00:17.826839 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:00:17.887544 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:00:17.888110 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:00:17.888257 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 16:00:17.909383 (Thread-1): finished collecting timing info
2021-03-30 16:00:17.909635 (Thread-1): finished collecting timing info
2021-03-30 16:00:18.278530 (Thread-201): handling poll request
2021-03-30 16:00:18.278988 (Thread-201): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267b9d60>]}
2021-03-30 16:00:18.283766 (Thread-201): sending response (<Response 10002 bytes [200 OK]>) to 10.0.18.81
2021-03-30 16:01:09.588137 (Thread-202): Got an acceptable cached parse result
2021-03-30 16:01:09.639193 (Thread-202): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 16:01:10.051586 (Thread-203): handling status request
2021-03-30 16:01:10.052247 (Thread-203): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72617b5b0>]}
2021-03-30 16:01:10.053524 (Thread-203): sending response (<Response 750 bytes [200 OK]>) to 10.0.15.161
2021-03-30 16:01:11.742019 (Thread-204): handling status request
2021-03-30 16:01:11.742607 (Thread-204): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72669db20>]}
2021-03-30 16:01:11.743925 (Thread-204): sending response (<Response 750 bytes [200 OK]>) to 10.0.27.42
2021-03-30 16:01:13.087345 (Thread-205): handling run_sql request
2021-03-30 16:01:13.087788 (Thread-205): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72669d2e0>]}
2021-03-30 16:01:13.089325 (Thread-205): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 16:01:14.253565 (Thread-205): sending response (<Response 138 bytes [200 OK]>) to 10.0.34.79
2021-03-30 16:01:14.278095 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:01:14.341019 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:01:14.341616 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:01:14.341764 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 16:01:14.360015 (Thread-1): finished collecting timing info
2021-03-30 16:01:14.360282 (Thread-1): Opening a new connection, currently in state init
2021-03-30 16:01:14.360736 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`

),

customer_orders as (

    select
        customer_id,
        order_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1,2

),

-- customer_payments as (
--     select
--         order_id,
--         amount 
    
--     from payments
-- ),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        sum(customer_payments.amount) as lifetime_value

    from customers

    left join customer_orders co using (customer_id)
    --left join customer_payments cp on co.order_id = cp.order_id

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 16:01:14.718302 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]')
2021-03-30 16:01:14.830666 (Thread-206): handling poll request
2021-03-30 16:01:14.831311 (Thread-206): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72631b370>]}
2021-03-30 16:01:14.834288 (Thread-206): sending response (<Response 4157 bytes [200 OK]>) to 10.0.22.23
2021-03-30 16:01:15.592975 (Thread-1): finished collecting timing info
2021-03-30 16:01:15.593318 (Thread-1): Got an exception: Database Error
  Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]

(job ID: 741ccbbe-8cd3-4682-b190-f198a1bed967)

                        -----Query Job SQL Follows-----                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with customers as (
   2:
   3:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
   4:
   5:),
   6:
   7:orders as (
   8:
   9:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  10:
  11:),
  12:
  13:payments as (
  14:    
  15:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  16:
  17:),
  18:
  19:customer_orders as (
  20:
  21:    select
  22:        customer_id,
  23:        order_id,
  24:        min(order_date) as first_order_date,
  25:        max(order_date) as most_recent_order_date,
  26:        count(order_id) as number_of_orders
  27:
  28:    from orders
  29:
  30:    group by 1,2
  31:
  32:),
  33:
  34:-- customer_payments as (
  35:--     select
  36:--         order_id,
  37:--         amount 
  38:    
  39:--     from payments
  40:-- ),
  41:
  42:final as (
  43:
  44:    select
  45:        customers.customer_id,
  46:        customers.first_name,
  47:        customers.last_name,
  48:        customer_orders.first_order_date,
  49:        customer_orders.most_recent_order_date,
  50:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
  51:        sum(customer_payments.amount) as lifetime_value
  52:
  53:    from customers
  54:
  55:    left join customer_orders co using (customer_id)
  56:    --left join customer_payments cp on co.order_id = cp.order_id
  57:
  58:)
  59:
  60:select * from final
  61:limit 500
  62:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]
2021-03-30 16:01:15.595207 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers') }}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    \n    select * from {{ ref('stg_payments') }}\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\n-- customer_payments as (\n--     select\n--         order_id,\n--         amount \n    \n--     from payments\n-- ),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    --left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    \n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\n-- customer_payments as (\n--     select\n--         order_id,\n--         amount \n    \n--     from payments\n-- ),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    --left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers') }}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    \n    select * from {{ ref('stg_payments') }}\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\n-- customer_payments as (\n--     select\n--         order_id,\n--         amount \n    \n--     from payments\n-- ),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    --left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    \n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\n-- customer_payments as (\n--     select\n--         order_id,\n--         amount \n    \n--     from payments\n-- ),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    --left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-30 16:01:16.766609 (Thread-207): handling poll request
2021-03-30 16:01:16.767306 (Thread-207): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72617b0d0>]}
2021-03-30 16:01:16.768802 (Thread-207): sending response (<Response 18825 bytes [200 OK]>) to 10.0.7.248
2021-03-30 16:01:32.203257 (Thread-208): Got an acceptable cached parse result
2021-03-30 16:01:32.473857 (Thread-208): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 16:01:32.704873 (Thread-209): handling status request
2021-03-30 16:01:32.705399 (Thread-209): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7263667c0>]}
2021-03-30 16:01:32.706746 (Thread-209): sending response (<Response 750 bytes [200 OK]>) to 10.0.33.81
2021-03-30 16:01:50.585901 (Thread-210): handling status request
2021-03-30 16:01:50.586491 (Thread-210): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726366d30>]}
2021-03-30 16:01:50.587817 (Thread-210): sending response (<Response 750 bytes [200 OK]>) to 10.0.18.81
2021-03-30 16:01:51.099807 (Thread-211): handling run_sql request
2021-03-30 16:01:51.100400 (Thread-211): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726375f10>]}
2021-03-30 16:01:51.102081 (Thread-211): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 16:01:52.401480 (Thread-211): sending response (<Response 138 bytes [200 OK]>) to 10.0.22.40
2021-03-30 16:01:52.429604 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:01:52.511574 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:01:52.512074 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:01:52.512365 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 16:01:52.544140 (Thread-1): finished collecting timing info
2021-03-30 16:01:52.544537 (Thread-1): Opening a new connection, currently in state init
2021-03-30 16:01:52.550020 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`

),

customer_orders as (

    select
        customer_id,
        order_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by customer_id, order_id

),

-- customer_payments as (
--     select
--         order_id,
--         amount 
    
--     from payments
-- ),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        sum(customer_payments.amount) as lifetime_value

    from customers

    left join customer_orders co using (customer_id)
    --left join customer_payments cp on co.order_id = cp.order_id

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 16:01:52.899433 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]')
2021-03-30 16:01:53.025907 (Thread-212): handling poll request
2021-03-30 16:01:53.026527 (Thread-212): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7266cde50>]}
2021-03-30 16:01:53.029195 (Thread-212): sending response (<Response 4175 bytes [200 OK]>) to 10.0.18.81
2021-03-30 16:01:53.817441 (Thread-1): finished collecting timing info
2021-03-30 16:01:53.817935 (Thread-1): Got an exception: Database Error
  Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]

(job ID: 1f973088-dabf-412d-bc0c-f02820d10e6e)

                        -----Query Job SQL Follows-----                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with customers as (
   2:
   3:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
   4:
   5:),
   6:
   7:orders as (
   8:
   9:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  10:
  11:),
  12:
  13:payments as (
  14:    
  15:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  16:
  17:),
  18:
  19:customer_orders as (
  20:
  21:    select
  22:        customer_id,
  23:        order_id,
  24:        min(order_date) as first_order_date,
  25:        max(order_date) as most_recent_order_date,
  26:        count(order_id) as number_of_orders
  27:
  28:    from orders
  29:
  30:    group by customer_id, order_id
  31:
  32:),
  33:
  34:-- customer_payments as (
  35:--     select
  36:--         order_id,
  37:--         amount 
  38:    
  39:--     from payments
  40:-- ),
  41:
  42:final as (
  43:
  44:    select
  45:        customers.customer_id,
  46:        customers.first_name,
  47:        customers.last_name,
  48:        customer_orders.first_order_date,
  49:        customer_orders.most_recent_order_date,
  50:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
  51:        sum(customer_payments.amount) as lifetime_value
  52:
  53:    from customers
  54:
  55:    left join customer_orders co using (customer_id)
  56:    --left join customer_payments cp on co.order_id = cp.order_id
  57:
  58:)
  59:
  60:select * from final
  61:limit 500
  62:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]
2021-03-30 16:01:53.820408 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers') }}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    \n    select * from {{ ref('stg_payments') }}\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by customer_id, order_id\n\n),\n\n-- customer_payments as (\n--     select\n--         order_id,\n--         amount \n    \n--     from payments\n-- ),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    --left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    \n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by customer_id, order_id\n\n),\n\n-- customer_payments as (\n--     select\n--         order_id,\n--         amount \n    \n--     from payments\n-- ),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    --left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers') }}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    \n    select * from {{ ref('stg_payments') }}\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by customer_id, order_id\n\n),\n\n-- customer_payments as (\n--     select\n--         order_id,\n--         amount \n    \n--     from payments\n-- ),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    --left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    \n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by customer_id, order_id\n\n),\n\n-- customer_payments as (\n--     select\n--         order_id,\n--         amount \n    \n--     from payments\n-- ),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    --left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-30 16:01:54.590690 (Thread-213): handling poll request
2021-03-30 16:01:54.591957 (Thread-213): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727459490>]}
2021-03-30 16:01:54.593281 (Thread-213): sending response (<Response 18969 bytes [200 OK]>) to 10.0.2.124
2021-03-30 16:02:06.044283 (Thread-214): Got an acceptable cached parse result
2021-03-30 16:02:06.123824 (Thread-214): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 16:02:06.757758 (Thread-215): handling status request
2021-03-30 16:02:06.758423 (Thread-215): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267d78e0>]}
2021-03-30 16:02:06.759909 (Thread-215): sending response (<Response 750 bytes [200 OK]>) to 10.0.34.79
2021-03-30 16:02:08.588276 (Thread-216): handling status request
2021-03-30 16:02:08.588844 (Thread-216): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726116460>]}
2021-03-30 16:02:08.590248 (Thread-216): sending response (<Response 750 bytes [200 OK]>) to 10.0.1.181
2021-03-30 16:02:09.662590 (Thread-217): handling run_sql request
2021-03-30 16:02:09.663031 (Thread-217): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7260056a0>]}
2021-03-30 16:02:09.664484 (Thread-217): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 16:02:10.941873 (Thread-217): sending response (<Response 138 bytes [200 OK]>) to 10.0.22.40
2021-03-30 16:02:10.970006 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:02:11.052341 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:02:11.052912 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:02:11.053043 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 16:02:11.091108 (Thread-1): finished collecting timing info
2021-03-30 16:02:11.091502 (Thread-1): Opening a new connection, currently in state init
2021-03-30 16:02:11.091928 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`

),

customer_orders as (

    select
        customer_id,
        order_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by customer_id, order_id

),

-- customer_payments as (
--     select
--         order_id,
--         amount 
    
--     from payments
-- ),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        --sum(customer_payments.amount) as lifetime_value

    from customers

    left join customer_orders co using (customer_id)
    --left join customer_payments cp on co.order_id = cp.order_id

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 16:02:11.464099 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]')
2021-03-30 16:02:12.023016 (Thread-218): handling poll request
2021-03-30 16:02:12.023677 (Thread-218): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72730a4c0>]}
2021-03-30 16:02:12.027746 (Thread-218): sending response (<Response 4176 bytes [200 OK]>) to 10.0.3.45
2021-03-30 16:02:12.486702 (Thread-1): finished collecting timing info
2021-03-30 16:02:12.487056 (Thread-1): Got an exception: Database Error
  Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]

(job ID: b5157875-c3d5-4abc-b099-cc5040bc6aae)

                        -----Query Job SQL Follows-----                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with customers as (
   2:
   3:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
   4:
   5:),
   6:
   7:orders as (
   8:
   9:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  10:
  11:),
  12:
  13:payments as (
  14:    
  15:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  16:
  17:),
  18:
  19:customer_orders as (
  20:
  21:    select
  22:        customer_id,
  23:        order_id,
  24:        min(order_date) as first_order_date,
  25:        max(order_date) as most_recent_order_date,
  26:        count(order_id) as number_of_orders
  27:
  28:    from orders
  29:
  30:    group by customer_id, order_id
  31:
  32:),
  33:
  34:-- customer_payments as (
  35:--     select
  36:--         order_id,
  37:--         amount 
  38:    
  39:--     from payments
  40:-- ),
  41:
  42:final as (
  43:
  44:    select
  45:        customers.customer_id,
  46:        customers.first_name,
  47:        customers.last_name,
  48:        customer_orders.first_order_date,
  49:        customer_orders.most_recent_order_date,
  50:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
  51:        --sum(customer_payments.amount) as lifetime_value
  52:
  53:    from customers
  54:
  55:    left join customer_orders co using (customer_id)
  56:    --left join customer_payments cp on co.order_id = cp.order_id
  57:
  58:)
  59:
  60:select * from final
  61:limit 500
  62:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]
2021-03-30 16:02:12.488750 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers') }}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    \n    select * from {{ ref('stg_payments') }}\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by customer_id, order_id\n\n),\n\n-- customer_payments as (\n--     select\n--         order_id,\n--         amount \n    \n--     from payments\n-- ),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        --sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    --left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    \n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by customer_id, order_id\n\n),\n\n-- customer_payments as (\n--     select\n--         order_id,\n--         amount \n    \n--     from payments\n-- ),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        --sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    --left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers') }}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    \n    select * from {{ ref('stg_payments') }}\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by customer_id, order_id\n\n),\n\n-- customer_payments as (\n--     select\n--         order_id,\n--         amount \n    \n--     from payments\n-- ),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        --sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    --left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    \n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by customer_id, order_id\n\n),\n\n-- customer_payments as (\n--     select\n--         order_id,\n--         amount \n    \n--     from payments\n-- ),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        --sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    --left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-30 16:02:14.130490 (Thread-219): handling poll request
2021-03-30 16:02:14.131155 (Thread-219): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726366910>]}
2021-03-30 16:02:14.132516 (Thread-219): sending response (<Response 18985 bytes [200 OK]>) to 10.0.42.64
2021-03-30 16:02:14.786429 (Thread-220): handling kill request
2021-03-30 16:02:14.787129 (Thread-220): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7273d11c0>]}
2021-03-30 16:02:14.790793 (Thread-220): sending response (<Response 114 bytes [200 OK]>) to 10.0.33.81
2021-03-30 16:02:18.262330 (Thread-221): handling status request
2021-03-30 16:02:18.262909 (Thread-221): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726505460>]}
2021-03-30 16:02:18.264279 (Thread-221): sending response (<Response 750 bytes [200 OK]>) to 10.0.2.124
2021-03-30 16:02:19.229093 (Thread-222): handling run_sql request
2021-03-30 16:02:19.229753 (Thread-222): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7264869a0>]}
2021-03-30 16:02:20.714886 (Thread-222): sending response (<Response 138 bytes [200 OK]>) to 10.0.18.81
2021-03-30 16:02:20.754010 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:02:20.846695 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:02:20.849955 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:02:20.850126 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 16:02:20.903095 (Thread-1): finished collecting timing info
2021-03-30 16:02:20.903532 (Thread-1): Opening a new connection, currently in state init
2021-03-30 16:02:20.903938 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`

),

customer_orders as (

    select
        customer_id,
        order_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by customer_id, order_id

),

-- customer_payments as (
--     select
--         order_id,
--         amount 
    
--     from payments
-- ),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
        --sum(customer_payments.amount) as lifetime_value

    from customers

    left join customer_orders co using (customer_id)
    --left join customer_payments cp on co.order_id = cp.order_id

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 16:02:21.355185 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]')
2021-03-30 16:02:21.539525 (Thread-223): handling poll request
2021-03-30 16:02:21.540205 (Thread-223): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72730a670>]}
2021-03-30 16:02:21.546518 (Thread-223): sending response (<Response 4176 bytes [200 OK]>) to 10.0.27.42
2021-03-30 16:02:22.596215 (Thread-1): finished collecting timing info
2021-03-30 16:02:22.596662 (Thread-1): Got an exception: Database Error
  Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]

(job ID: 4c7c200e-83ef-4732-81f1-263a2e7ca0da)

                       -----Query Job SQL Follows-----                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with customers as (
   2:
   3:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
   4:
   5:),
   6:
   7:orders as (
   8:
   9:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  10:
  11:),
  12:
  13:payments as (
  14:    
  15:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  16:
  17:),
  18:
  19:customer_orders as (
  20:
  21:    select
  22:        customer_id,
  23:        order_id,
  24:        min(order_date) as first_order_date,
  25:        max(order_date) as most_recent_order_date,
  26:        count(order_id) as number_of_orders
  27:
  28:    from orders
  29:
  30:    group by customer_id, order_id
  31:
  32:),
  33:
  34:-- customer_payments as (
  35:--     select
  36:--         order_id,
  37:--         amount 
  38:    
  39:--     from payments
  40:-- ),
  41:
  42:final as (
  43:
  44:    select
  45:        customers.customer_id,
  46:        customers.first_name,
  47:        customers.last_name,
  48:        customer_orders.first_order_date,
  49:        customer_orders.most_recent_order_date,
  50:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  51:        --sum(customer_payments.amount) as lifetime_value
  52:
  53:    from customers
  54:
  55:    left join customer_orders co using (customer_id)
  56:    --left join customer_payments cp on co.order_id = cp.order_id
  57:
  58:)
  59:
  60:select * from final
  61:limit 500
  62:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]
2021-03-30 16:02:22.599182 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers') }}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    \n    select * from {{ ref('stg_payments') }}\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by customer_id, order_id\n\n),\n\n-- customer_payments as (\n--     select\n--         order_id,\n--         amount \n    \n--     from payments\n-- ),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n        --sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    --left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    \n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by customer_id, order_id\n\n),\n\n-- customer_payments as (\n--     select\n--         order_id,\n--         amount \n    \n--     from payments\n-- ),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n        --sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    --left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: customer_orders; Did you mean customer_id? at [48:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers') }}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    \n    select * from {{ ref('stg_payments') }}\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by customer_id, order_id\n\n),\n\n-- customer_payments as (\n--     select\n--         order_id,\n--         amount \n    \n--     from payments\n-- ),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n        --sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    --left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    \n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by customer_id, order_id\n\n),\n\n-- customer_payments as (\n--     select\n--         order_id,\n--         amount \n    \n--     from payments\n-- ),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\n        --sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    --left join customer_payments cp on co.order_id = cp.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-30 16:02:23.921864 (Thread-224): handling poll request
2021-03-30 16:02:23.922443 (Thread-224): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72730aa30>]}
2021-03-30 16:02:23.923823 (Thread-224): sending response (<Response 18976 bytes [200 OK]>) to 10.0.34.79
2021-03-30 16:02:46.229941 (Thread-225): Got an acceptable cached parse result
2021-03-30 16:02:46.297624 (Thread-225): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 16:02:46.874545 (Thread-226): handling status request
2021-03-30 16:02:46.875178 (Thread-226): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726504ee0>]}
2021-03-30 16:02:46.876590 (Thread-226): sending response (<Response 750 bytes [200 OK]>) to 10.0.22.23
2021-03-30 16:02:53.875356 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 16:02:53.959690 (Thread-227): Got an acceptable cached parse result
2021-03-30 16:02:54.040081 (Thread-227): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 16:02:55.084111 (Thread-228): handling status request
2021-03-30 16:02:55.084705 (Thread-228): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72666c670>]}
2021-03-30 16:02:55.086105 (Thread-228): sending response (<Response 750 bytes [200 OK]>) to 10.0.42.64
2021-03-30 16:02:56.106588 (Thread-229): handling status request
2021-03-30 16:02:56.107168 (Thread-229): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7271a30a0>]}
2021-03-30 16:02:56.108494 (Thread-229): sending response (<Response 750 bytes [200 OK]>) to 10.0.34.79
2021-03-30 16:02:56.990786 (Thread-230): handling run_sql request
2021-03-30 16:02:56.991381 (Thread-230): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72651c070>]}
2021-03-30 16:02:57.029188 (Thread-230): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 16:02:58.249035 (Thread-230): sending response (<Response 138 bytes [200 OK]>) to 10.0.33.160
2021-03-30 16:02:58.271634 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:02:58.361517 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:02:58.362700 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:02:58.362870 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 16:02:58.386872 (Thread-1): finished collecting timing info
2021-03-30 16:02:58.387169 (Thread-1): Opening a new connection, currently in state init
2021-03-30 16:02:58.387767 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`

),

customer_orders as (

    select
        customer_id,
        order_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by customer_id, order_id

),

customer_payments as (
    select
        order_id,
        amount 
    
    from payments
),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        sum(customer_payments.amount) as lifetime_value

    from customers

    left join customer_orders co using (customer_id)
    left join customer_payments cp on co.order_id = cp.order_id

))

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 16:02:58.809754 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got ")" at [58:2]')
2021-03-30 16:02:59.206099 (Thread-231): handling poll request
2021-03-30 16:02:59.206728 (Thread-231): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726504430>]}
2021-03-30 16:02:59.209872 (Thread-231): sending response (<Response 4164 bytes [200 OK]>) to 10.0.22.23
2021-03-30 16:03:00.023822 (Thread-1): finished collecting timing info
2021-03-30 16:03:00.024263 (Thread-1): Got an exception: Database Error
  Syntax error: Expected "(" or "," or keyword SELECT but got ")" at [58:2]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected "(" or "," or keyword SELECT but got ")" at [58:2]

(job ID: 02a4afc4-cdb8-4b7c-bf3a-4afdc3fb5ca6)

                        -----Query Job SQL Follows-----                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with customers as (
   2:
   3:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
   4:
   5:),
   6:
   7:orders as (
   8:
   9:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  10:
  11:),
  12:
  13:payments as (
  14:    
  15:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  16:
  17:),
  18:
  19:customer_orders as (
  20:
  21:    select
  22:        customer_id,
  23:        order_id,
  24:        min(order_date) as first_order_date,
  25:        max(order_date) as most_recent_order_date,
  26:        count(order_id) as number_of_orders
  27:
  28:    from orders
  29:
  30:    group by customer_id, order_id
  31:
  32:),
  33:
  34:customer_payments as (
  35:    select
  36:        order_id,
  37:        amount 
  38:    
  39:    from payments
  40:),
  41:
  42:final as (
  43:
  44:    select
  45:        customers.customer_id,
  46:        customers.first_name,
  47:        customers.last_name,
  48:        customer_orders.first_order_date,
  49:        customer_orders.most_recent_order_date,
  50:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
  51:        sum(customer_payments.amount) as lifetime_value
  52:
  53:    from customers
  54:
  55:    left join customer_orders co using (customer_id)
  56:    left join customer_payments cp on co.order_id = cp.order_id
  57:
  58:))
  59:
  60:select * from final
  61:limit 500
  62:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Syntax error: Expected "(" or "," or keyword SELECT but got ")" at [58:2]
2021-03-30 16:03:00.026949 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Syntax error: Expected "(" or "," or keyword SELECT but got ")" at [58:2]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers') }}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    \n    select * from {{ ref('stg_payments') }}\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by customer_id, order_id\n\n),\n\ncustomer_payments as (\n    select\n        order_id,\n        amount \n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n))\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    \n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by customer_id, order_id\n\n),\n\ncustomer_payments as (\n    select\n        order_id,\n        amount \n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n))\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Syntax error: Expected "(" or "," or keyword SELECT but got ")" at [58:2]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers') }}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    \n    select * from {{ ref('stg_payments') }}\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by customer_id, order_id\n\n),\n\ncustomer_payments as (\n    select\n        order_id,\n        amount \n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n))\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    \n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by customer_id, order_id\n\n),\n\ncustomer_payments as (\n    select\n        order_id,\n        amount \n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders co using (customer_id)\n    left join customer_payments cp on co.order_id = cp.order_id\n\n))\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-30 16:03:00.846344 (Thread-232): handling poll request
2021-03-30 16:03:00.846933 (Thread-232): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727481790>]}
2021-03-30 16:03:00.848273 (Thread-232): sending response (<Response 18873 bytes [200 OK]>) to 10.0.5.204
2021-03-30 16:03:50.060686 (Thread-233): handling status request
2021-03-30 16:03:50.061242 (Thread-233): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727481310>]}
2021-03-30 16:03:50.062499 (Thread-233): sending response (<Response 750 bytes [200 OK]>) to 10.0.22.23
2021-03-30 16:03:51.654022 (Thread-234): handling run_sql request
2021-03-30 16:03:51.654433 (Thread-234): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727481340>]}
2021-03-30 16:03:52.687324 (Thread-234): sending response (<Response 138 bytes [200 OK]>) to 10.0.34.79
2021-03-30 16:03:52.704820 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:03:52.767112 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:03:52.767761 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:03:52.767927 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 16:03:52.794071 (Thread-1): finished collecting timing info
2021-03-30 16:03:52.794357 (Thread-1): Opening a new connection, currently in state init
2021-03-30 16:03:52.794898 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 16:03:53.632044 (Thread-235): handling poll request
2021-03-30 16:03:53.632490 (Thread-235): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7266c79d0>]}
2021-03-30 16:03:53.634646 (Thread-235): sending response (<Response 3436 bytes [200 OK]>) to 10.0.33.160
2021-03-30 16:03:54.394574 (Thread-1): finished collecting timing info
2021-03-30 16:03:55.144130 (Thread-236): handling poll request
2021-03-30 16:03:55.144739 (Thread-236): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7272079d0>]}
2021-03-30 16:03:55.152131 (Thread-236): sending response (<Response 11868 bytes [200 OK]>) to 10.0.3.45
2021-03-30 16:05:24.290708 (Thread-237): Got an acceptable cached parse result
2021-03-30 16:05:24.349231 (Thread-237): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 16:05:24.693421 (Thread-238): handling status request
2021-03-30 16:05:24.694042 (Thread-238): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7261e79d0>]}
2021-03-30 16:05:24.695148 (Thread-238): sending response (<Response 750 bytes [200 OK]>) to 10.0.15.161
2021-03-30 16:05:26.015776 (Thread-239): handling status request
2021-03-30 16:05:26.016284 (Thread-239): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72666cf10>]}
2021-03-30 16:05:26.017244 (Thread-239): sending response (<Response 750 bytes [200 OK]>) to 10.0.38.35
2021-03-30 16:05:26.794089 (Thread-240): handling run_sql request
2021-03-30 16:05:26.794535 (Thread-240): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72666c340>]}
2021-03-30 16:05:26.795869 (Thread-240): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 16:05:27.714989 (Thread-240): sending response (<Response 138 bytes [200 OK]>) to 10.0.34.79
2021-03-30 16:05:27.733476 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:05:27.806641 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:05:27.807306 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:05:27.807590 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 16:05:27.838570 (Thread-1): finished collecting timing info
2021-03-30 16:05:27.838976 (Thread-1): Opening a new connection, currently in state init
2021-03-30 16:05:27.839555 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    
    select
        order_id,
        amount
    
    from payments
),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 16:05:28.364159 (Thread-241): handling poll request
2021-03-30 16:05:28.365390 (Thread-241): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72666c370>]}
2021-03-30 16:05:28.367397 (Thread-241): sending response (<Response 3643 bytes [200 OK]>) to 10.0.26.97
2021-03-30 16:05:29.469456 (Thread-1): finished collecting timing info
2021-03-30 16:05:30.069753 (Thread-242): handling poll request
2021-03-30 16:05:30.070189 (Thread-242): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7261e75e0>]}
2021-03-30 16:05:30.074815 (Thread-242): sending response (<Response 12900 bytes [200 OK]>) to 10.0.27.28
2021-03-30 16:06:49.589313 (Thread-243): Got an acceptable cached parse result
2021-03-30 16:06:49.661528 (Thread-243): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 16:06:49.941955 (Thread-244): handling status request
2021-03-30 16:06:49.942544 (Thread-244): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7263cc5b0>]}
2021-03-30 16:06:49.943826 (Thread-244): sending response (<Response 750 bytes [200 OK]>) to 10.0.22.40
2021-03-30 16:06:52.115444 (Thread-245): handling status request
2021-03-30 16:06:52.115877 (Thread-245): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7262b8c40>]}
2021-03-30 16:06:52.116787 (Thread-245): sending response (<Response 750 bytes [200 OK]>) to 10.0.22.40
2021-03-30 16:06:52.630114 (Thread-246): handling run_sql request
2021-03-30 16:06:52.630566 (Thread-246): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7262b8d60>]}
2021-03-30 16:06:52.631839 (Thread-246): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 16:06:53.535797 (Thread-246): sending response (<Response 138 bytes [200 OK]>) to 10.0.1.181
2021-03-30 16:06:53.563658 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:06:53.620288 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:06:53.620777 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:06:53.620884 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 16:06:53.638803 (Thread-1): finished collecting timing info
2021-03-30 16:06:53.639071 (Thread-1): Opening a new connection, currently in state init
2021-03-30 16:06:53.639568 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    
    select
        order_id,
        amount
    
    from payments
),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        sum(customer_payments.amount) as lifetime_value

    from customers

    left join customer_orders using (customer_id)
    left join customer_payments on customer_orders.order_id = customer_payments.order_id

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 16:06:53.984646 (Thread-247): handling poll request
2021-03-30 16:06:53.985090 (Thread-247): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7262b8310>]}
2021-03-30 16:06:53.987123 (Thread-247): sending response (<Response 3791 bytes [200 OK]>) to 10.0.3.45
2021-03-30 16:06:54.532556 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Name order_id not found inside customer_orders at [56:52]')
2021-03-30 16:06:55.519867 (Thread-248): handling poll request
2021-03-30 16:06:55.520362 (Thread-248): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7263ccdc0>]}
2021-03-30 16:06:55.521541 (Thread-248): sending response (<Response 739 bytes [200 OK]>) to 10.0.33.160
2021-03-30 16:06:55.797282 (Thread-1): finished collecting timing info
2021-03-30 16:06:55.797632 (Thread-1): Got an exception: Database Error
  Name order_id not found inside customer_orders at [56:52]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Name order_id not found inside customer_orders at [56:52]

(job ID: 0b30f941-8394-4733-bfbf-77ad9e477b7e)

                               -----Query Job SQL Follows-----                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with customers as (
   2:
   3:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
   4:
   5:),
   6:
   7:orders as (
   8:
   9:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  10:
  11:),
  12:
  13:payments as (
  14:    
  15:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  16:),
  17:
  18:customer_orders as (
  19:
  20:    select
  21:        customer_id,
  22:
  23:        min(order_date) as first_order_date,
  24:        max(order_date) as most_recent_order_date,
  25:        count(order_id) as number_of_orders
  26:
  27:    from orders
  28:
  29:    group by 1
  30:
  31:),
  32:
  33:customer_payments as (
  34:    
  35:    select
  36:        order_id,
  37:        amount
  38:    
  39:    from payments
  40:),
  41:
  42:final as (
  43:
  44:    select
  45:        customers.customer_id,
  46:        customers.first_name,
  47:        customers.last_name,
  48:        customer_orders.first_order_date,
  49:        customer_orders.most_recent_order_date,
  50:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
  51:        sum(customer_payments.amount) as lifetime_value
  52:
  53:    from customers
  54:
  55:    left join customer_orders using (customer_id)
  56:    left join customer_payments on customer_orders.order_id = customer_payments.order_id
  57:
  58:)
  59:
  60:select * from final
  61:limit 500
  62:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Name order_id not found inside customer_orders at [56:52]
2021-03-30 16:06:55.799508 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Name order_id not found inside customer_orders at [56:52]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    \n    select * from {{ ref('stg_payments') }}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    \n    select\n        order_id,\n        amount\n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments on customer_orders.order_id = customer_payments.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    \n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    \n    select\n        order_id,\n        amount\n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments on customer_orders.order_id = customer_payments.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Name order_id not found inside customer_orders at [56:52]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    \n    select * from {{ ref('stg_payments') }}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    \n    select\n        order_id,\n        amount\n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments on customer_orders.order_id = customer_payments.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    \n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    \n    select\n        order_id,\n        amount\n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments on customer_orders.order_id = customer_payments.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-30 16:06:57.044721 (Thread-249): handling poll request
2021-03-30 16:06:57.045284 (Thread-249): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726262580>]}
2021-03-30 16:06:57.046362 (Thread-249): sending response (<Response 18646 bytes [200 OK]>) to 10.0.42.64
2021-03-30 16:07:08.878693 (Thread-250): Got an acceptable cached parse result
2021-03-30 16:07:08.936642 (Thread-250): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 16:07:09.238329 (Thread-251): handling status request
2021-03-30 16:07:09.239050 (Thread-251): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72c050370>]}
2021-03-30 16:07:09.240438 (Thread-251): sending response (<Response 185 bytes [200 OK]>) to 10.0.22.40
2021-03-30 16:07:11.160022 (Thread-252): handling status request
2021-03-30 16:07:11.160459 (Thread-252): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72746a490>]}
2021-03-30 16:07:11.161386 (Thread-252): sending response (<Response 750 bytes [200 OK]>) to 10.0.27.28
2021-03-30 16:07:11.869482 (Thread-253): handling status request
2021-03-30 16:07:11.870112 (Thread-253): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72658fe50>]}
2021-03-30 16:07:11.871444 (Thread-253): sending response (<Response 750 bytes [200 OK]>) to 10.0.3.45
2021-03-30 16:07:13.389088 (Thread-254): handling run_sql request
2021-03-30 16:07:13.389556 (Thread-254): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72658f7f0>]}
2021-03-30 16:07:13.390837 (Thread-254): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 16:07:14.307166 (Thread-254): sending response (<Response 138 bytes [200 OK]>) to 10.0.37.31
2021-03-30 16:07:14.325432 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:07:14.389416 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:07:14.390057 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:07:14.390175 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 16:07:14.412638 (Thread-1): finished collecting timing info
2021-03-30 16:07:14.413012 (Thread-1): Opening a new connection, currently in state init
2021-03-30 16:07:14.413458 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
),

customer_orders as (

    select
        customer_id,
        order_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

customer_payments as (
    
    select
        order_id,
        amount
    
    from payments
),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        sum(customer_payments.amount) as lifetime_value

    from customers

    left join customer_orders using (customer_id)
    left join customer_payments on customer_orders.order_id = customer_payments.order_id

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 16:07:14.730411 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column order_id which is neither grouped nor aggregated at [22:9]')
2021-03-30 16:07:14.940755 (Thread-255): handling poll request
2021-03-30 16:07:14.941211 (Thread-255): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267d1b80>]}
2021-03-30 16:07:14.943420 (Thread-255): sending response (<Response 4188 bytes [200 OK]>) to 10.0.33.81
2021-03-30 16:07:15.628475 (Thread-1): finished collecting timing info
2021-03-30 16:07:15.628913 (Thread-1): Got an exception: Database Error
  SELECT list expression references column order_id which is neither grouped nor aggregated at [22:9]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 SELECT list expression references column order_id which is neither grouped nor aggregated at [22:9]

(job ID: 64d6a813-ada8-406f-a3a3-ad6731f349fa)

                               -----Query Job SQL Follows-----                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with customers as (
   2:
   3:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
   4:
   5:),
   6:
   7:orders as (
   8:
   9:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  10:
  11:),
  12:
  13:payments as (
  14:    
  15:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  16:),
  17:
  18:customer_orders as (
  19:
  20:    select
  21:        customer_id,
  22:        order_id,
  23:        min(order_date) as first_order_date,
  24:        max(order_date) as most_recent_order_date,
  25:        count(order_id) as number_of_orders
  26:
  27:    from orders
  28:
  29:    group by 1
  30:
  31:),
  32:
  33:customer_payments as (
  34:    
  35:    select
  36:        order_id,
  37:        amount
  38:    
  39:    from payments
  40:),
  41:
  42:final as (
  43:
  44:    select
  45:        customers.customer_id,
  46:        customers.first_name,
  47:        customers.last_name,
  48:        customer_orders.first_order_date,
  49:        customer_orders.most_recent_order_date,
  50:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
  51:        sum(customer_payments.amount) as lifetime_value
  52:
  53:    from customers
  54:
  55:    left join customer_orders using (customer_id)
  56:    left join customer_payments on customer_orders.order_id = customer_payments.order_id
  57:
  58:)
  59:
  60:select * from final
  61:limit 500
  62:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  SELECT list expression references column order_id which is neither grouped nor aggregated at [22:9]
2021-03-30 16:07:15.631647 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  SELECT list expression references column order_id which is neither grouped nor aggregated at [22:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    \n    select * from {{ ref('stg_payments') }}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    \n    select\n        order_id,\n        amount\n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments on customer_orders.order_id = customer_payments.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    \n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    \n    select\n        order_id,\n        amount\n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments on customer_orders.order_id = customer_payments.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  SELECT list expression references column order_id which is neither grouped nor aggregated at [22:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    \n    select * from {{ ref('stg_payments') }}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    \n    select\n        order_id,\n        amount\n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments on customer_orders.order_id = customer_payments.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    \n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1\n\n),\n\ncustomer_payments as (\n    \n    select\n        order_id,\n        amount\n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments on customer_orders.order_id = customer_payments.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-30 16:07:16.413301 (Thread-256): handling poll request
2021-03-30 16:07:16.413839 (Thread-256): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7260799d0>]}
2021-03-30 16:07:16.414787 (Thread-256): sending response (<Response 19076 bytes [200 OK]>) to 10.0.18.81
2021-03-30 16:07:23.006222 (Thread-257): Got an acceptable cached parse result
2021-03-30 16:07:23.077911 (Thread-257): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 16:07:23.468567 (Thread-258): handling status request
2021-03-30 16:07:23.469043 (Thread-258): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7261d5430>]}
2021-03-30 16:07:23.470053 (Thread-258): sending response (<Response 750 bytes [200 OK]>) to 10.0.34.79
2021-03-30 16:07:25.506568 (Thread-259): handling status request
2021-03-30 16:07:25.507065 (Thread-259): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72658f940>]}
2021-03-30 16:07:25.508106 (Thread-259): sending response (<Response 750 bytes [200 OK]>) to 10.0.33.160
2021-03-30 16:07:26.092285 (Thread-260): handling run_sql request
2021-03-30 16:07:26.092780 (Thread-260): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7272e8b50>]}
2021-03-30 16:07:26.094314 (Thread-260): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 16:07:27.178614 (Thread-260): sending response (<Response 138 bytes [200 OK]>) to 10.0.1.181
2021-03-30 16:07:27.200205 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:07:27.280025 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:07:27.280691 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:07:27.281010 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 16:07:27.299150 (Thread-1): finished collecting timing info
2021-03-30 16:07:27.299421 (Thread-1): Opening a new connection, currently in state init
2021-03-30 16:07:27.299922 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
),

customer_orders as (

    select
        customer_id,
        order_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1,2

),

customer_payments as (
    
    select
        order_id,
        amount
    
    from payments
),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        sum(customer_payments.amount) as lifetime_value

    from customers

    left join customer_orders using (customer_id)
    left join customer_payments on customer_orders.order_id = customer_payments.order_id

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 16:07:27.604244 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references customers.customer_id which is neither grouped nor aggregated at [45:9]')
2021-03-30 16:07:27.665322 (Thread-261): handling poll request
2021-03-30 16:07:27.665965 (Thread-261): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7272cf490>]}
2021-03-30 16:07:27.668999 (Thread-261): sending response (<Response 4196 bytes [200 OK]>) to 10.0.33.160
2021-03-30 16:07:28.850252 (Thread-1): finished collecting timing info
2021-03-30 16:07:28.850704 (Thread-1): Got an exception: Database Error
  SELECT list expression references customers.customer_id which is neither grouped nor aggregated at [45:9]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 SELECT list expression references customers.customer_id which is neither grouped nor aggregated at [45:9]

(job ID: 6a03c0ac-da6e-44b8-8d59-d0b2f7d04d96)

                               -----Query Job SQL Follows-----                               

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with customers as (
   2:
   3:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
   4:
   5:),
   6:
   7:orders as (
   8:
   9:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  10:
  11:),
  12:
  13:payments as (
  14:    
  15:    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  16:),
  17:
  18:customer_orders as (
  19:
  20:    select
  21:        customer_id,
  22:        order_id,
  23:        min(order_date) as first_order_date,
  24:        max(order_date) as most_recent_order_date,
  25:        count(order_id) as number_of_orders
  26:
  27:    from orders
  28:
  29:    group by 1,2
  30:
  31:),
  32:
  33:customer_payments as (
  34:    
  35:    select
  36:        order_id,
  37:        amount
  38:    
  39:    from payments
  40:),
  41:
  42:final as (
  43:
  44:    select
  45:        customers.customer_id,
  46:        customers.first_name,
  47:        customers.last_name,
  48:        customer_orders.first_order_date,
  49:        customer_orders.most_recent_order_date,
  50:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
  51:        sum(customer_payments.amount) as lifetime_value
  52:
  53:    from customers
  54:
  55:    left join customer_orders using (customer_id)
  56:    left join customer_payments on customer_orders.order_id = customer_payments.order_id
  57:
  58:)
  59:
  60:select * from final
  61:limit 500
  62:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 84, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  SELECT list expression references customers.customer_id which is neither grouped nor aggregated at [45:9]
2021-03-30 16:07:28.853453 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  SELECT list expression references customers.customer_id which is neither grouped nor aggregated at [45:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    \n    select * from {{ ref('stg_payments') }}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    \n    select\n        order_id,\n        amount\n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments on customer_orders.order_id = customer_payments.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    \n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    \n    select\n        order_id,\n        amount\n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments on customer_orders.order_id = customer_payments.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 349, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 52, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  SELECT list expression references customers.customer_id which is neither grouped nor aggregated at [45:9]', 'raw_sql': "with customers as (\n\n    select * from {{ ref('stg_customers')}}\n\n),\n\norders as (\n\n    select * from {{ ref('stg_orders') }}\n\n),\n\npayments as (\n    \n    select * from {{ ref('stg_payments') }}\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    \n    select\n        order_id,\n        amount\n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments on customer_orders.order_id = customer_payments.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with customers as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`\n\n),\n\npayments as (\n    \n    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`\n),\n\ncustomer_orders as (\n\n    select\n        customer_id,\n        order_id,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date,\n        count(order_id) as number_of_orders\n\n    from orders\n\n    group by 1,2\n\n),\n\ncustomer_payments as (\n    \n    select\n        order_id,\n        amount\n    \n    from payments\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        sum(customer_payments.amount) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n    left join customer_payments on customer_orders.order_id = customer_payments.order_id\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-30 16:07:29.196586 (Thread-262): handling poll request
2021-03-30 16:07:29.197240 (Thread-262): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7272cfb80>]}
2021-03-30 16:07:29.198662 (Thread-262): sending response (<Response 19134 bytes [200 OK]>) to 10.0.38.35
2021-03-30 16:08:18.524517 (Thread-263): handling status request
2021-03-30 16:08:18.524954 (Thread-263): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7272cf6d0>]}
2021-03-30 16:08:18.525973 (Thread-263): sending response (<Response 750 bytes [200 OK]>) to 10.0.33.81
2021-03-30 16:08:19.255315 (Thread-264): handling run_sql request
2021-03-30 16:08:19.255740 (Thread-264): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7260da490>]}
2021-03-30 16:08:20.214288 (Thread-264): sending response (<Response 138 bytes [200 OK]>) to 10.0.22.23
2021-03-30 16:08:20.232326 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:08:20.294414 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:08:20.294937 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:08:20.295043 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 16:08:20.314276 (Thread-1): finished collecting timing info
2021-03-30 16:08:20.314558 (Thread-1): Opening a new connection, currently in state init
2021-03-30 16:08:20.315015 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
),

customer_orders as (

    select
        customer_id,
        order_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1,2

),

customer_payments as (
    
    select
        order_id,
        amount
    
    from payments
),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        sum(customer_payments.amount) as lifetime_value

    from customers

    left join customer_orders using (customer_id)
    left join customer_payments on customer_orders.order_id = customer_payments.order_id

    group by 1,2,3,4,5,6
)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 16:08:20.731374 (Thread-265): handling poll request
2021-03-30 16:08:20.731883 (Thread-265): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72689a430>]}
2021-03-30 16:08:20.733994 (Thread-265): sending response (<Response 3836 bytes [200 OK]>) to 10.0.42.64
2021-03-30 16:08:21.774192 (Thread-1): finished collecting timing info
2021-03-30 16:08:22.283867 (Thread-266): handling poll request
2021-03-30 16:08:22.284312 (Thread-266): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726079910>]}
2021-03-30 16:08:22.289434 (Thread-266): sending response (<Response 16763 bytes [200 OK]>) to 10.0.27.28
2021-03-30 16:08:28.675616 (Thread-267): Got an acceptable cached parse result
2021-03-30 16:08:28.725002 (Thread-267): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 16:08:29.348730 (Thread-268): handling status request
2021-03-30 16:08:29.349207 (Thread-268): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725ef85e0>]}
2021-03-30 16:08:29.350253 (Thread-268): sending response (<Response 750 bytes [200 OK]>) to 10.0.27.28
2021-03-30 16:08:47.551293 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 16:08:47.614324 (Thread-269): Got an acceptable cached parse result
2021-03-30 16:08:47.678447 (Thread-269): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-03-30 16:08:48.027788 (Thread-270): handling status request
2021-03-30 16:08:48.028265 (Thread-270): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725f9afd0>]}
2021-03-30 16:08:48.029211 (Thread-270): sending response (<Response 747 bytes [200 OK]>) to 10.0.38.35
2021-03-30 16:08:58.695830 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-03-30 16:08:58.751883 (Thread-271): Got an acceptable cached parse result
2021-03-30 16:08:58.822527 (Thread-271): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-03-30 16:08:59.258312 (Thread-272): handling status request
2021-03-30 16:08:59.258765 (Thread-272): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72600b160>]}
2021-03-30 16:08:59.259709 (Thread-272): sending response (<Response 747 bytes [200 OK]>) to 10.0.37.31
2021-03-30 16:09:00.878050 (Thread-273): handling status request
2021-03-30 16:09:00.878514 (Thread-273): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72600b880>]}
2021-03-30 16:09:00.879397 (Thread-273): sending response (<Response 747 bytes [200 OK]>) to 10.0.38.35
2021-03-30 16:09:01.311797 (Thread-274): handling run_sql request
2021-03-30 16:09:01.312238 (Thread-274): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72645b880>]}
2021-03-30 16:09:01.313419 (Thread-274): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-03-30 16:09:02.276969 (Thread-274): sending response (<Response 138 bytes [200 OK]>) to 10.0.27.42
2021-03-30 16:09:02.294350 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:09:02.347479 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:09:02.347967 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:09:02.348070 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 16:09:02.365010 (Thread-1): finished collecting timing info
2021-03-30 16:09:02.365255 (Thread-1): Opening a new connection, currently in state init
2021-03-30 16:09:02.365761 (Thread-1): On rpc.jaffle_shop.request: with orders as  (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
),

payments as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 16:09:02.867702 (Thread-275): handling poll request
2021-03-30 16:09:02.868356 (Thread-275): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72615e910>]}
2021-03-30 16:09:02.871410 (Thread-275): sending response (<Response 3205 bytes [200 OK]>) to 10.0.33.160
2021-03-30 16:09:03.789911 (Thread-1): finished collecting timing info
2021-03-30 16:09:04.314597 (Thread-276): handling poll request
2021-03-30 16:09:04.315069 (Thread-276): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72615ee50>]}
2021-03-30 16:09:04.319717 (Thread-276): sending response (<Response 8922 bytes [200 OK]>) to 10.0.22.23
2021-03-30 16:25:54.764387 (Thread-277): handling status request
2021-03-30 16:25:54.766576 (Thread-277): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725f92310>]}
2021-03-30 16:25:54.767538 (Thread-277): sending response (<Response 747 bytes [200 OK]>) to 10.0.5.204
2021-03-30 16:25:55.315927 (Thread-278): handling run_sql request
2021-03-30 16:25:55.316370 (Thread-278): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725f927c0>]}
2021-03-30 16:25:56.164433 (Thread-278): sending response (<Response 138 bytes [200 OK]>) to 10.0.2.124
2021-03-30 16:25:56.182543 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:25:56.243542 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:25:56.244136 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 16:25:56.244262 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 16:25:56.258064 (Thread-1): finished collecting timing info
2021-03-30 16:25:56.258346 (Thread-1): Opening a new connection, currently in state init
2021-03-30 16:25:56.258929 (Thread-1): On rpc.jaffle_shop.request: select
    id as customer_id,
    first_name,
    last_name

from `finl-1067321-eds-thunderdome.maxm.customers`
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 16:25:56.700461 (Thread-279): handling poll request
2021-03-30 16:25:56.700947 (Thread-279): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72679ca00>]}
2021-03-30 16:25:56.703113 (Thread-279): sending response (<Response 2729 bytes [200 OK]>) to 10.0.27.42
2021-03-30 16:25:57.546567 (Thread-1): finished collecting timing info
2021-03-30 16:25:58.271658 (Thread-280): handling poll request
2021-03-30 16:25:58.272103 (Thread-280): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72648f310>]}
2021-03-30 16:25:58.276200 (Thread-280): sending response (<Response 5551 bytes [200 OK]>) to 10.0.38.35
2021-03-30 16:26:25.683113 (Thread-281): Got an acceptable cached parse result
2021-03-30 16:26:26.164698 (Thread-282): handling status request
2021-03-30 16:26:26.165132 (Thread-282): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72626a460>]}
2021-03-30 16:26:26.166004 (Thread-282): sending response (<Response 448 bytes [200 OK]>) to 10.0.22.40
2021-03-30 16:27:32.014772 (Thread-283): Got an acceptable cached parse result
2021-03-30 16:27:32.379198 (Thread-284): handling status request
2021-03-30 16:27:32.379636 (Thread-284): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7273a51c0>]}
2021-03-30 16:27:32.380502 (Thread-284): sending response (<Response 1031 bytes [200 OK]>) to 10.0.27.28
2021-03-30 16:28:01.461146 (Thread-285): Got an acceptable cached parse result
2021-03-30 16:28:02.116081 (Thread-286): handling status request
2021-03-30 16:28:02.116551 (Thread-286): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725f29cd0>]}
2021-03-30 16:28:02.117390 (Thread-286): sending response (<Response 448 bytes [200 OK]>) to 10.0.33.160
2021-03-30 16:28:07.014117 (Thread-287): handling status request
2021-03-30 16:28:07.014538 (Thread-287): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725ee48e0>]}
2021-03-30 16:28:07.015355 (Thread-287): sending response (<Response 448 bytes [200 OK]>) to 10.0.7.248
2021-03-30 16:28:07.034661 (Thread-288): handling status request
2021-03-30 16:28:07.035002 (Thread-288): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725c0a040>]}
2021-03-30 16:28:07.035739 (Thread-288): sending response (<Response 448 bytes [200 OK]>) to 10.0.3.45
2021-03-30 16:28:07.538378 (Thread-289): handling cli_args request
2021-03-30 16:28:07.538805 (Thread-289): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725bf6610>]}
2021-03-30 16:28:08.553093 (Thread-289): sending response (<Response 138 bytes [200 OK]>) to 10.0.22.40
2021-03-30 16:28:08.605735 (MainThread): Partial parsing not enabled
2021-03-30 16:28:08.606927 (MainThread): Parsing macros/adapters.sql
2021-03-30 16:28:08.656645 (MainThread): Parsing macros/etc.sql
2021-03-30 16:28:08.658013 (MainThread): Parsing macros/catalog.sql
2021-03-30 16:28:08.663899 (MainThread): Parsing macros/materializations/copy.sql
2021-03-30 16:28:08.668269 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 16:28:08.677986 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 16:28:08.690220 (MainThread): Parsing macros/materializations/seed.sql
2021-03-30 16:28:08.692983 (MainThread): Parsing macros/materializations/snapshot.sql
2021-03-30 16:28:08.694827 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 16:28:08.698256 (MainThread): Parsing macros/core.sql
2021-03-30 16:28:08.701788 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 16:28:08.710569 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 16:28:08.724280 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 16:28:08.726088 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 16:28:08.742060 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 16:28:08.769747 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 16:28:08.774630 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 16:28:08.780720 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 16:28:08.800855 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 16:28:08.807460 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 16:28:08.809317 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 16:28:08.815242 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 16:28:08.816887 (MainThread): Parsing macros/etc/query.sql
2021-03-30 16:28:08.817989 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 16:28:08.826635 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 16:28:08.827619 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 16:28:08.829270 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 16:28:08.831254 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 16:28:08.832777 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 16:28:08.835467 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 16:28:08.837345 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 16:28:08.839176 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 16:28:08.886054 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-30 16:28:08.886173 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '14c92419-98e1-4210-807a-b799307e1154', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fdeb7280>]}
2021-03-30 16:28:08.888872 (MainThread): Partial parsing not enabled
2021-03-30 16:28:08.940914 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 16:28:08.963453 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-03-30 16:28:08.973270 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-03-30 16:28:08.980692 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 16:28:08.991952 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-03-30 16:28:09.104931 (Thread-290): handling poll request
2021-03-30 16:28:09.105375 (Thread-290): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725c69640>]}
2021-03-30 16:28:09.110154 (Thread-290): sending response (<Response 12260 bytes [200 OK]>) to 10.0.26.97
2021-03-30 16:28:09.248093 (MainThread): Found 5 models, 3 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:28:09.249137 (MainThread): 
2021-03-30 16:28:09.249515 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 16:28:09.256545 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome".
2021-03-30 16:28:09.256735 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 16:28:09.461006 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome_maxm".
2021-03-30 16:28:09.461155 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-30 16:28:09.644449 (MainThread): 16:28:09 | Concurrency: 1 threads (target='default')
2021-03-30 16:28:09.644583 (MainThread): 16:28:09 | 
2021-03-30 16:28:09.646776 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-03-30 16:28:09.647861 (Thread-1): 16:28:09 | 1 of 5 START view model maxm.stg_orders.............................. [RUN]
2021-03-30 16:28:09.648138 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-03-30 16:28:09.648235 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-03-30 16:28:09.665267 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-03-30 16:28:09.683650 (Thread-1): finished collecting timing info
2021-03-30 16:28:09.713884 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-03-30 16:28:09.736840 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 16:28:09.737254 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `finl-1067321-eds-thunderdome.maxm.orders`;


2021-03-30 16:28:10.517794 (Thread-1): finished collecting timing info
2021-03-30 16:28:10.518441 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14c92419-98e1-4210-807a-b799307e1154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fd4dfe80>]}
2021-03-30 16:28:10.519424 (Thread-1): 16:28:10 | 1 of 5 OK created view model maxm.stg_orders......................... [CREATE VIEW in 0.87s]
2021-03-30 16:28:10.519509 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-03-30 16:28:10.519615 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-03-30 16:28:10.520402 (Thread-1): 16:28:10 | 2 of 5 START view model maxm.stg_payments............................ [RUN]
2021-03-30 16:28:10.520595 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-03-30 16:28:10.520666 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-03-30 16:28:10.528473 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-03-30 16:28:10.547349 (Thread-1): finished collecting timing info
2021-03-30 16:28:10.551638 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-03-30 16:28:10.570737 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 16:28:10.571267 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  OPTIONS()
  as select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,

    -- amount is stored in cents, convert it to dollars
    amount / 100 as amount,
    created as created_at

from `finl-1067321-eds-thunderdome.maxm.payments`;


2021-03-30 16:28:10.620687 (Thread-291): handling poll request
2021-03-30 16:28:10.621092 (Thread-291): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725c099a0>]}
2021-03-30 16:28:10.624434 (Thread-291): sending response (<Response 12548 bytes [200 OK]>) to 10.0.22.40
2021-03-30 16:28:11.134841 (Thread-1): finished collecting timing info
2021-03-30 16:28:11.135973 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14c92419-98e1-4210-807a-b799307e1154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fd480be0>]}
2021-03-30 16:28:11.137608 (Thread-1): 16:28:11 | 2 of 5 OK created view model maxm.stg_payments....................... [CREATE VIEW in 0.62s]
2021-03-30 16:28:11.137815 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-03-30 16:28:11.137965 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-03-30 16:28:11.139416 (Thread-1): 16:28:11 | 3 of 5 START view model maxm.stg_customers........................... [RUN]
2021-03-30 16:28:11.139755 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 16:28:11.139853 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-03-30 16:28:11.146746 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-03-30 16:28:11.169242 (Thread-1): finished collecting timing info
2021-03-30 16:28:11.173891 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-03-30 16:28:11.194128 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 16:28:11.194549 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `finl-1067321-eds-thunderdome.maxm.customers`;


2021-03-30 16:28:11.729270 (Thread-1): finished collecting timing info
2021-03-30 16:28:11.729913 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14c92419-98e1-4210-807a-b799307e1154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fd473820>]}
2021-03-30 16:28:11.730879 (Thread-1): 16:28:11 | 3 of 5 OK created view model maxm.stg_customers...................... [CREATE VIEW in 0.59s]
2021-03-30 16:28:11.730962 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-03-30 16:28:11.731061 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-03-30 16:28:11.731844 (Thread-1): 16:28:11 | 4 of 5 START view model maxm.fct_orders.............................. [RUN]
2021-03-30 16:28:11.732043 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-03-30 16:28:11.732114 (Thread-1): Compiling model.jaffle_shop.fct_orders
2021-03-30 16:28:11.740337 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-03-30 16:28:11.752698 (Thread-1): finished collecting timing info
2021-03-30 16:28:11.757050 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-03-30 16:28:11.770212 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 16:28:11.770574 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`fct_orders`
  OPTIONS()
  as with orders as  (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
),

payments as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final;


2021-03-30 16:28:12.090872 (Thread-292): handling poll request
2021-03-30 16:28:12.091348 (Thread-292): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725bf6700>]}
2021-03-30 16:28:12.094359 (Thread-292): sending response (<Response 12030 bytes [200 OK]>) to 10.0.33.81
2021-03-30 16:28:12.685203 (Thread-1): finished collecting timing info
2021-03-30 16:28:12.685852 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14c92419-98e1-4210-807a-b799307e1154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fd480be0>]}
2021-03-30 16:28:12.686811 (Thread-1): 16:28:12 | 4 of 5 OK created view model maxm.fct_orders......................... [CREATE VIEW in 0.95s]
2021-03-30 16:28:12.686896 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-03-30 16:28:12.686997 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-03-30 16:28:12.687793 (Thread-1): 16:28:12 | 5 of 5 START view model maxm.dim_customers........................... [RUN]
2021-03-30 16:28:12.687994 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 16:28:12.688070 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-03-30 16:28:12.697794 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-03-30 16:28:12.718309 (Thread-1): finished collecting timing info
2021-03-30 16:28:12.723016 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-03-30 16:28:12.742933 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 16:28:12.743385 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers`
  OPTIONS()
  as with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
),

customer_orders as (

    select
        customer_id,
        order_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1,2

),

customer_payments as (
    
    select
        order_id,
        amount
    
    from payments
),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        sum(customer_payments.amount) as lifetime_value

    from customers

    left join customer_orders using (customer_id)
    left join customer_payments on customer_orders.order_id = customer_payments.order_id

    group by 1,2,3,4,5,6
)

select * from final;


2021-03-30 16:28:13.544708 (Thread-1): finished collecting timing info
2021-03-30 16:28:13.545322 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14c92419-98e1-4210-807a-b799307e1154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fc4c8c70>]}
2021-03-30 16:28:13.546446 (Thread-1): 16:28:13 | 5 of 5 OK created view model maxm.dim_customers...................... [CREATE VIEW in 0.86s]
2021-03-30 16:28:13.546531 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-03-30 16:28:13.547764 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 16:28:13.555154 (Thread-293): handling poll request
2021-03-30 16:28:13.555487 (Thread-293): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725c74f40>]}
2021-03-30 16:28:13.557829 (Thread-293): sending response (<Response 9141 bytes [200 OK]>) to 10.0.5.204
2021-03-30 16:28:13.548040 (MainThread): 16:28:13 | 
2021-03-30 16:28:13.548105 (MainThread): 16:28:13 | Finished running 5 view models in 4.30s.
2021-03-30 16:28:13.548153 (MainThread): Connection 'master' was properly closed.
2021-03-30 16:28:13.548193 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 16:28:13.589001 (MainThread): 
2021-03-30 16:28:13.589133 (MainThread): Completed successfully
2021-03-30 16:28:13.589199 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-03-30 16:28:15.041110 (Thread-294): handling poll request
2021-03-30 16:28:15.041542 (Thread-294): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725e4e910>]}
2021-03-30 16:28:15.054924 (Thread-294): sending response (<Response 18540 bytes [200 OK]>) to 10.0.38.35
2021-03-30 16:28:15.562735 (Thread-295): handling status request
2021-03-30 16:28:15.563159 (Thread-295): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725e4e8b0>]}
2021-03-30 16:28:15.564032 (Thread-295): sending response (<Response 448 bytes [200 OK]>) to 10.0.18.81
2021-03-30 16:30:57.252711 (Thread-296): handling status request
2021-03-30 16:30:57.254789 (Thread-296): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725f560a0>]}
2021-03-30 16:30:57.255581 (Thread-296): sending response (<Response 448 bytes [200 OK]>) to 10.0.34.79
2021-03-30 16:30:57.530409 (Thread-297): handling status request
2021-03-30 16:30:57.530828 (Thread-297): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725d75340>]}
2021-03-30 16:30:57.531840 (Thread-297): sending response (<Response 448 bytes [200 OK]>) to 10.0.34.79
2021-03-30 16:30:57.806675 (Thread-298): handling cli_args request
2021-03-30 16:30:57.807172 (Thread-298): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725e3b070>]}
2021-03-30 16:30:58.683306 (Thread-298): sending response (<Response 138 bytes [200 OK]>) to 10.0.42.64
2021-03-30 16:30:58.735671 (MainThread): Partial parsing not enabled
2021-03-30 16:30:58.736876 (MainThread): Parsing macros/adapters.sql
2021-03-30 16:30:58.758313 (MainThread): Parsing macros/etc.sql
2021-03-30 16:30:58.759667 (MainThread): Parsing macros/catalog.sql
2021-03-30 16:30:58.797163 (MainThread): Parsing macros/materializations/copy.sql
2021-03-30 16:30:58.801615 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 16:30:58.811482 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 16:30:58.823940 (MainThread): Parsing macros/materializations/seed.sql
2021-03-30 16:30:58.826724 (MainThread): Parsing macros/materializations/snapshot.sql
2021-03-30 16:30:58.828555 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 16:30:58.832051 (MainThread): Parsing macros/core.sql
2021-03-30 16:30:58.835629 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 16:30:58.844486 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 16:30:58.858276 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 16:30:58.860100 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 16:30:58.876108 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 16:30:58.904146 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 16:30:58.909180 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 16:30:58.915514 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 16:30:58.939004 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 16:30:58.945761 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 16:30:58.947749 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 16:30:58.953813 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 16:30:58.955570 (MainThread): Parsing macros/etc/query.sql
2021-03-30 16:30:58.956687 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 16:30:58.966304 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 16:30:58.967496 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 16:30:58.969349 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 16:30:58.971552 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 16:30:58.973184 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 16:30:58.976050 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 16:30:58.978094 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 16:30:58.980029 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 16:30:59.028595 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-30 16:30:59.028735 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ea586f08-a30c-41b9-88b3-fc50dff62ce4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b16cb3220>]}
2021-03-30 16:30:59.031889 (MainThread): Partial parsing not enabled
2021-03-30 16:30:59.084756 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 16:30:59.101991 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-03-30 16:30:59.111635 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-03-30 16:30:59.120975 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 16:30:59.132292 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-03-30 16:30:59.173750 (Thread-299): handling poll request
2021-03-30 16:30:59.174212 (Thread-299): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725d93d00>]}
2021-03-30 16:30:59.179015 (Thread-299): sending response (<Response 12275 bytes [200 OK]>) to 10.0.27.42
2021-03-30 16:30:59.400178 (MainThread): Found 5 models, 3 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:30:59.400882 (MainThread): 
2021-03-30 16:30:59.401197 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 16:30:59.410740 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome_maxm".
2021-03-30 16:30:59.410842 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-03-30 16:30:59.649111 (MainThread): 16:30:59 | Concurrency: 1 threads (target='default')
2021-03-30 16:30:59.649239 (MainThread): 16:30:59 | 
2021-03-30 16:30:59.651481 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed
2021-03-30 16:30:59.651691 (Thread-1): 16:30:59 | 1 of 1 START test accepted_values_stg_orders_status__completed__shipped__returned__placed [RUN]
2021-03-30 16:30:59.651930 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed".
2021-03-30 16:30:59.652016 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed
2021-03-30 16:30:59.671421 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed"
2021-03-30 16:30:59.704895 (Thread-1): finished collecting timing info
2021-03-30 16:30:59.705484 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 16:30:59.706201 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed"} */

    
    




with all_values as (

    select distinct
        status as value_field

    from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'completed','shipped','returned','placed'
    )
)

select count(*) as validation_errors
from validation_errors



2021-03-30 16:31:00.790075 (Thread-300): handling poll request
2021-03-30 16:31:00.791094 (Thread-300): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725d93790>]}
2021-03-30 16:31:00.825903 (Thread-300): sending response (<Response 7050 bytes [200 OK]>) to 10.0.27.42
2021-03-30 16:31:01.382380 (Thread-1): finished collecting timing info
2021-03-30 16:31:01.382944 (Thread-1): 16:31:01 | 1 of 1 FAIL 1 accepted_values_stg_orders_status__completed__shipped__returned__placed [FAIL 1 in 1.73s]
2021-03-30 16:31:01.383026 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed
2021-03-30 16:31:01.384315 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 16:31:01.384551 (MainThread): 16:31:01 | 
2021-03-30 16:31:01.384613 (MainThread): 16:31:01 | Finished running 1 test in 1.98s.
2021-03-30 16:31:01.384660 (MainThread): Connection 'master' was properly closed.
2021-03-30 16:31:01.384699 (MainThread): Connection 'test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed' was properly closed.
2021-03-30 16:31:01.409242 (MainThread): 
2021-03-30 16:31:01.409376 (MainThread): Completed with 1 error and 0 warnings:
2021-03-30 16:31:01.409431 (MainThread): 
2021-03-30 16:31:01.409498 (MainThread): Failure in test accepted_values_stg_orders_status__completed__shipped__returned__placed (models/staging/jaffle_shop/stage_jaffle_shop.yml)
2021-03-30 16:31:01.409557 (MainThread):   Got 1 result, expected 0.
2021-03-30 16:31:01.409601 (MainThread): 
2021-03-30 16:31:01.409645 (MainThread):   compiled SQL at target/compiled/jaffle_shop/models/staging/jaffle_shop/stage_jaffle_shop.yml/schema_test/accepted_values_stg_orders_d7b8e45120dd6439aa99abe42328f4bb.sql
2021-03-30 16:31:01.409722 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-03-30 16:31:02.368275 (Thread-301): handling poll request
2021-03-30 16:31:02.368711 (Thread-301): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7274c9460>]}
2021-03-30 16:31:02.374955 (Thread-301): sending response (<Response 10003 bytes [200 OK]>) to 10.0.22.23
2021-03-30 16:31:03.760842 (Thread-302): handling status request
2021-03-30 16:31:03.761267 (Thread-302): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7274c94c0>]}
2021-03-30 16:31:03.762235 (Thread-302): sending response (<Response 448 bytes [200 OK]>) to 10.0.37.31
2021-03-30 16:31:13.346421 (Thread-303): handling status request
2021-03-30 16:31:13.346894 (Thread-303): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7274c9700>]}
2021-03-30 16:31:13.347736 (Thread-303): sending response (<Response 448 bytes [200 OK]>) to 10.0.37.31
2021-03-30 16:31:13.519301 (Thread-304): handling status request
2021-03-30 16:31:13.519724 (Thread-304): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725db8370>]}
2021-03-30 16:31:13.520527 (Thread-304): sending response (<Response 448 bytes [200 OK]>) to 10.0.27.28
2021-03-30 16:31:14.181449 (Thread-305): handling cli_args request
2021-03-30 16:31:14.181914 (Thread-305): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725f649d0>]}
2021-03-30 16:31:15.029888 (Thread-305): sending response (<Response 138 bytes [200 OK]>) to 10.0.26.97
2021-03-30 16:31:15.081807 (MainThread): Partial parsing not enabled
2021-03-30 16:31:15.083127 (MainThread): Parsing macros/adapters.sql
2021-03-30 16:31:15.103661 (MainThread): Parsing macros/etc.sql
2021-03-30 16:31:15.105024 (MainThread): Parsing macros/catalog.sql
2021-03-30 16:31:15.142568 (MainThread): Parsing macros/materializations/copy.sql
2021-03-30 16:31:15.147018 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 16:31:15.156718 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 16:31:15.169109 (MainThread): Parsing macros/materializations/seed.sql
2021-03-30 16:31:15.171839 (MainThread): Parsing macros/materializations/snapshot.sql
2021-03-30 16:31:15.173706 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 16:31:15.177174 (MainThread): Parsing macros/core.sql
2021-03-30 16:31:15.180761 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 16:31:15.189789 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 16:31:15.203886 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 16:31:15.205795 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 16:31:15.221996 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 16:31:15.249938 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 16:31:15.254978 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 16:31:15.261194 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 16:31:15.281525 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 16:31:15.288217 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 16:31:15.290204 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 16:31:15.296255 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 16:31:15.297970 (MainThread): Parsing macros/etc/query.sql
2021-03-30 16:31:15.299097 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 16:31:15.308030 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 16:31:15.309064 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 16:31:15.310826 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 16:31:15.312841 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 16:31:15.314536 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 16:31:15.317234 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 16:31:15.319206 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 16:31:15.321034 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 16:31:15.368703 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-30 16:31:15.368835 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5d33a84d-d066-40fa-becc-144aa4f7bbf1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f7f3f1400>]}
2021-03-30 16:31:15.372161 (MainThread): Partial parsing not enabled
2021-03-30 16:31:15.422676 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 16:31:15.440192 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-03-30 16:31:15.447914 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-03-30 16:31:15.455483 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 16:31:15.467769 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-03-30 16:31:15.623910 (Thread-306): handling poll request
2021-03-30 16:31:15.624361 (Thread-306): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7274c9490>]}
2021-03-30 16:31:15.629063 (Thread-306): sending response (<Response 12275 bytes [200 OK]>) to 10.0.42.64
2021-03-30 16:31:15.721445 (MainThread): Found 5 models, 3 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:31:15.722140 (MainThread): 
2021-03-30 16:31:15.722417 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 16:31:15.731399 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome_maxm".
2021-03-30 16:31:15.731504 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-03-30 16:31:15.914343 (MainThread): 16:31:15 | Concurrency: 1 threads (target='default')
2021-03-30 16:31:15.914485 (MainThread): 16:31:15 | 
2021-03-30 16:31:15.916386 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed
2021-03-30 16:31:15.916557 (Thread-1): 16:31:15 | 1 of 1 START test accepted_values_stg_orders_status__completed__shipped__returned__placed [RUN]
2021-03-30 16:31:15.916776 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed".
2021-03-30 16:31:15.916857 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed
2021-03-30 16:31:15.936356 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed"
2021-03-30 16:31:15.956328 (Thread-1): finished collecting timing info
2021-03-30 16:31:15.956638 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 16:31:15.957037 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed"} */

    
    




with all_values as (

    select distinct
        status as value_field

    from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'completed','shipped','returned','placed'
    )
)

select count(*) as validation_errors
from validation_errors



2021-03-30 16:31:16.767176 (Thread-1): finished collecting timing info
2021-03-30 16:31:16.768020 (Thread-1): 16:31:16 | 1 of 1 FAIL 1 accepted_values_stg_orders_status__completed__shipped__returned__placed [FAIL 1 in 0.85s]
2021-03-30 16:31:16.768155 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed
2021-03-30 16:31:16.769542 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 16:31:16.769798 (MainThread): 16:31:16 | 
2021-03-30 16:31:16.769864 (MainThread): 16:31:16 | Finished running 1 test in 1.05s.
2021-03-30 16:31:16.769912 (MainThread): Connection 'master' was properly closed.
2021-03-30 16:31:16.769951 (MainThread): Connection 'test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed' was properly closed.
2021-03-30 16:31:16.790444 (MainThread): 
2021-03-30 16:31:16.790561 (MainThread): Completed with 1 error and 0 warnings:
2021-03-30 16:31:16.790617 (MainThread): 
2021-03-30 16:31:16.790679 (MainThread): Failure in test accepted_values_stg_orders_status__completed__shipped__returned__placed (models/staging/jaffle_shop/stage_jaffle_shop.yml)
2021-03-30 16:31:16.790735 (MainThread):   Got 1 result, expected 0.
2021-03-30 16:31:16.790779 (MainThread): 
2021-03-30 16:31:16.790839 (MainThread):   compiled SQL at target/compiled/jaffle_shop/models/staging/jaffle_shop/stage_jaffle_shop.yml/schema_test/accepted_values_stg_orders_d7b8e45120dd6439aa99abe42328f4bb.sql
2021-03-30 16:31:16.790917 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-03-30 16:31:17.349090 (Thread-307): handling poll request
2021-03-30 16:31:17.349511 (Thread-307): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7263b0910>]}
2021-03-30 16:31:17.355914 (Thread-307): sending response (<Response 16747 bytes [200 OK]>) to 10.0.26.97
2021-03-30 16:31:17.989949 (Thread-308): handling status request
2021-03-30 16:31:17.990386 (Thread-308): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726262940>]}
2021-03-30 16:31:17.991338 (Thread-308): sending response (<Response 448 bytes [200 OK]>) to 10.0.22.40
2021-03-30 16:31:30.359187 (Thread-309): Got an acceptable cached parse result
2021-03-30 16:31:30.747880 (Thread-310): handling status request
2021-03-30 16:31:30.748517 (Thread-310): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72741a100>]}
2021-03-30 16:31:30.749775 (Thread-310): sending response (<Response 448 bytes [200 OK]>) to 10.0.22.40
2021-03-30 16:31:34.626801 (Thread-311): handling status request
2021-03-30 16:31:34.627235 (Thread-311): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725d93d90>]}
2021-03-30 16:31:34.628050 (Thread-311): sending response (<Response 448 bytes [200 OK]>) to 10.0.33.81
2021-03-30 16:31:34.638619 (Thread-312): handling status request
2021-03-30 16:31:34.638944 (Thread-312): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725d25160>]}
2021-03-30 16:31:34.639697 (Thread-312): sending response (<Response 448 bytes [200 OK]>) to 10.0.33.81
2021-03-30 16:31:35.062705 (Thread-313): handling cli_args request
2021-03-30 16:31:35.063187 (Thread-313): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725f29850>]}
2021-03-30 16:31:35.889637 (Thread-313): sending response (<Response 138 bytes [200 OK]>) to 10.0.3.45
2021-03-30 16:31:35.941569 (MainThread): Partial parsing not enabled
2021-03-30 16:31:35.942794 (MainThread): Parsing macros/adapters.sql
2021-03-30 16:31:35.962995 (MainThread): Parsing macros/etc.sql
2021-03-30 16:31:35.964357 (MainThread): Parsing macros/catalog.sql
2021-03-30 16:31:36.002449 (MainThread): Parsing macros/materializations/copy.sql
2021-03-30 16:31:36.006894 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 16:31:36.016684 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 16:31:36.029156 (MainThread): Parsing macros/materializations/seed.sql
2021-03-30 16:31:36.031976 (MainThread): Parsing macros/materializations/snapshot.sql
2021-03-30 16:31:36.033899 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 16:31:36.037409 (MainThread): Parsing macros/core.sql
2021-03-30 16:31:36.041023 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 16:31:36.049985 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 16:31:36.063851 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 16:31:36.065676 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 16:31:36.081742 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 16:31:36.109771 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 16:31:36.114783 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 16:31:36.121238 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 16:31:36.142527 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 16:31:36.149186 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 16:31:36.151080 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 16:31:36.157012 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 16:31:36.158691 (MainThread): Parsing macros/etc/query.sql
2021-03-30 16:31:36.159850 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 16:31:36.168538 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 16:31:36.169550 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 16:31:36.171251 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 16:31:36.173944 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 16:31:36.175991 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 16:31:36.179869 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 16:31:36.182639 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 16:31:36.185116 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 16:31:36.239751 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-30 16:31:36.239885 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'eb1f7fdb-ff56-454a-8106-f7f25faaf2e4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce04e10dc0>]}
2021-03-30 16:31:36.242946 (MainThread): Partial parsing not enabled
2021-03-30 16:31:36.293469 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 16:31:36.310710 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-03-30 16:31:36.318046 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-03-30 16:31:36.325351 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 16:31:36.336495 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-03-30 16:31:36.583701 (Thread-314): handling poll request
2021-03-30 16:31:36.584263 (Thread-314): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726599ca0>]}
2021-03-30 16:31:36.591758 (Thread-314): sending response (<Response 12274 bytes [200 OK]>) to 10.0.27.42
2021-03-30 16:31:36.619497 (MainThread): Found 5 models, 3 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:31:36.620277 (MainThread): 
2021-03-30 16:31:36.620593 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 16:31:36.630788 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome_maxm".
2021-03-30 16:31:36.630941 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-03-30 16:31:36.858980 (MainThread): 16:31:36 | Concurrency: 1 threads (target='default')
2021-03-30 16:31:36.859112 (MainThread): 16:31:36 | 
2021-03-30 16:31:36.861072 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending
2021-03-30 16:31:36.861240 (Thread-1): 16:31:36 | 1 of 1 START test accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending [RUN]
2021-03-30 16:31:36.861459 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending".
2021-03-30 16:31:36.861534 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending
2021-03-30 16:31:36.881854 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending"
2021-03-30 16:31:36.894099 (Thread-1): finished collecting timing info
2021-03-30 16:31:36.894407 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 16:31:36.894844 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending"} */

    
    




with all_values as (

    select distinct
        status as value_field

    from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'completed','shipped','returned','placed','return_pending'
    )
)

select count(*) as validation_errors
from validation_errors



2021-03-30 16:31:38.045563 (Thread-1): finished collecting timing info
2021-03-30 16:31:38.046276 (Thread-1): 16:31:38 | 1 of 1 PASS accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending [PASS in 1.18s]
2021-03-30 16:31:38.046361 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending
2021-03-30 16:31:38.047612 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 16:31:38.047854 (MainThread): 16:31:38 | 
2021-03-30 16:31:38.047916 (MainThread): 16:31:38 | Finished running 1 test in 1.43s.
2021-03-30 16:31:38.047964 (MainThread): Connection 'master' was properly closed.
2021-03-30 16:31:38.048003 (MainThread): Connection 'test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending' was properly closed.
2021-03-30 16:31:38.069951 (MainThread): 
2021-03-30 16:31:38.070069 (MainThread): Completed successfully
2021-03-30 16:31:38.070128 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-03-30 16:31:38.997549 (Thread-315): handling poll request
2021-03-30 16:31:38.998032 (Thread-315): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7264b4580>]}
2021-03-30 16:31:39.004093 (Thread-315): sending response (<Response 14973 bytes [200 OK]>) to 10.0.34.79
2021-03-30 16:31:39.662950 (Thread-316): handling status request
2021-03-30 16:31:39.663400 (Thread-316): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72746ee80>]}
2021-03-30 16:31:39.664252 (Thread-316): sending response (<Response 448 bytes [200 OK]>) to 10.0.18.81
2021-03-30 16:31:47.476543 (Thread-317): handling status request
2021-03-30 16:31:47.477028 (Thread-317): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72746e970>]}
2021-03-30 16:31:47.477959 (Thread-317): sending response (<Response 448 bytes [200 OK]>) to 10.0.3.45
2021-03-30 16:31:47.572356 (Thread-318): handling status request
2021-03-30 16:31:47.572786 (Thread-318): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72666b910>]}
2021-03-30 16:31:47.573611 (Thread-318): sending response (<Response 448 bytes [200 OK]>) to 10.0.33.160
2021-03-30 16:31:48.005100 (Thread-319): handling cli_args request
2021-03-30 16:31:48.005531 (Thread-319): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7268011f0>]}
2021-03-30 16:31:48.849758 (Thread-319): sending response (<Response 138 bytes [200 OK]>) to 10.0.33.160
2021-03-30 16:31:48.902820 (MainThread): Partial parsing not enabled
2021-03-30 16:31:48.904064 (MainThread): Parsing macros/adapters.sql
2021-03-30 16:31:48.924580 (MainThread): Parsing macros/etc.sql
2021-03-30 16:31:48.926010 (MainThread): Parsing macros/catalog.sql
2021-03-30 16:31:48.966425 (MainThread): Parsing macros/materializations/copy.sql
2021-03-30 16:31:48.970937 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 16:31:48.980788 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 16:31:48.993461 (MainThread): Parsing macros/materializations/seed.sql
2021-03-30 16:31:48.996210 (MainThread): Parsing macros/materializations/snapshot.sql
2021-03-30 16:31:48.998091 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 16:31:49.001655 (MainThread): Parsing macros/core.sql
2021-03-30 16:31:49.005332 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 16:31:49.014402 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 16:31:49.028530 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 16:31:49.030382 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 16:31:49.046585 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 16:31:49.074815 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 16:31:49.079783 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 16:31:49.086125 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 16:31:49.106868 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 16:31:49.113516 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 16:31:49.115400 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 16:31:49.121451 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 16:31:49.123111 (MainThread): Parsing macros/etc/query.sql
2021-03-30 16:31:49.124214 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 16:31:49.133044 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 16:31:49.134089 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 16:31:49.135791 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 16:31:49.137796 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 16:31:49.139351 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 16:31:49.142047 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 16:31:49.143969 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 16:31:49.145776 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 16:31:49.193831 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-30 16:31:49.193946 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '578569c8-fe3c-4525-9243-4a48fcf8a61f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cae8e8850>]}
2021-03-30 16:31:49.196924 (MainThread): Partial parsing not enabled
2021-03-30 16:31:49.247566 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 16:31:49.264855 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-03-30 16:31:49.272050 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-03-30 16:31:49.279219 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 16:31:49.289909 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-03-30 16:31:49.448849 (Thread-320): handling poll request
2021-03-30 16:31:49.449305 (Thread-320): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7262d2820>]}
2021-03-30 16:31:49.453974 (Thread-320): sending response (<Response 12278 bytes [200 OK]>) to 10.0.1.181
2021-03-30 16:31:49.548201 (MainThread): Found 5 models, 3 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:31:49.548939 (MainThread): 
2021-03-30 16:31:49.549236 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 16:31:49.558691 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome_maxm".
2021-03-30 16:31:49.558886 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-03-30 16:31:49.746947 (MainThread): 16:31:49 | Concurrency: 1 threads (target='default')
2021-03-30 16:31:49.747126 (MainThread): 16:31:49 | 
2021-03-30 16:31:49.749084 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-03-30 16:31:49.749257 (Thread-1): 16:31:49 | 1 of 2 START test not_null_stg_customers_customer_id................. [RUN]
2021-03-30 16:31:49.749494 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2021-03-30 16:31:49.749578 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2021-03-30 16:31:49.769158 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2021-03-30 16:31:49.781384 (Thread-1): finished collecting timing info
2021-03-30 16:31:49.781709 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 16:31:49.782105 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
where customer_id is null



2021-03-30 16:31:50.830043 (Thread-1): finished collecting timing info
2021-03-30 16:31:50.830816 (Thread-1): 16:31:50 | 1 of 2 PASS not_null_stg_customers_customer_id....................... [PASS in 1.08s]
2021-03-30 16:31:50.830910 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-03-30 16:31:50.831006 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2021-03-30 16:31:50.831089 (Thread-1): 16:31:50 | 2 of 2 START test unique_stg_customers_customer_id................... [RUN]
2021-03-30 16:31:50.831251 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2021-03-30 16:31:50.831319 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2021-03-30 16:31:50.840242 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2021-03-30 16:31:50.855591 (Thread-1): finished collecting timing info
2021-03-30 16:31:50.855841 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 16:31:50.856240 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2021-03-30 16:31:51.096714 (Thread-321): handling poll request
2021-03-30 16:31:51.097140 (Thread-321): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727445ac0>]}
2021-03-30 16:31:51.100065 (Thread-321): sending response (<Response 11439 bytes [200 OK]>) to 10.0.34.79
2021-03-30 16:31:52.684402 (Thread-322): handling poll request
2021-03-30 16:31:52.685140 (Thread-322): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727445af0>]}
2021-03-30 16:31:52.686059 (Thread-322): sending response (<Response 311 bytes [200 OK]>) to 10.0.22.23
2021-03-30 16:31:53.111449 (Thread-1): finished collecting timing info
2021-03-30 16:31:53.112009 (Thread-1): 16:31:53 | 2 of 2 PASS unique_stg_customers_customer_id......................... [PASS in 2.28s]
2021-03-30 16:31:53.112095 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2021-03-30 16:31:53.113421 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 16:31:53.113704 (MainThread): 16:31:53 | 
2021-03-30 16:31:53.113772 (MainThread): 16:31:53 | Finished running 2 tests in 3.56s.
2021-03-30 16:31:53.113819 (MainThread): Connection 'master' was properly closed.
2021-03-30 16:31:53.113859 (MainThread): Connection 'test.jaffle_shop.unique_stg_customers_customer_id' was properly closed.
2021-03-30 16:31:53.147473 (MainThread): 
2021-03-30 16:31:53.147595 (MainThread): Completed successfully
2021-03-30 16:31:53.147656 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-03-30 16:31:54.183251 (Thread-323): handling poll request
2021-03-30 16:31:54.183700 (Thread-323): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727445cd0>]}
2021-03-30 16:31:54.190457 (Thread-323): sending response (<Response 9326 bytes [200 OK]>) to 10.0.33.81
2021-03-30 16:31:54.738555 (Thread-324): handling status request
2021-03-30 16:31:54.739066 (Thread-324): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726813b50>]}
2021-03-30 16:31:54.740115 (Thread-324): sending response (<Response 448 bytes [200 OK]>) to 10.0.18.81
2021-03-30 16:32:37.660145 (Thread-325): Got an acceptable cached parse result
2021-03-30 16:32:38.024344 (Thread-326): handling status request
2021-03-30 16:32:38.024774 (Thread-326): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7263c4e50>]}
2021-03-30 16:32:38.025578 (Thread-326): sending response (<Response 448 bytes [200 OK]>) to 10.0.5.204
2021-03-30 16:32:40.217183 (Thread-327): Got an acceptable cached parse result
2021-03-30 16:32:40.652866 (Thread-328): handling status request
2021-03-30 16:32:40.653336 (Thread-328): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7261ff8b0>]}
2021-03-30 16:32:40.654226 (Thread-328): sending response (<Response 448 bytes [200 OK]>) to 10.0.22.40
2021-03-30 16:33:12.383933 (Thread-329): Got an acceptable cached parse result
2021-03-30 16:33:12.768133 (Thread-330): handling status request
2021-03-30 16:33:12.768569 (Thread-330): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72675b4c0>]}
2021-03-30 16:33:12.769405 (Thread-330): sending response (<Response 448 bytes [200 OK]>) to 10.0.5.204
2021-03-30 16:33:40.358607 (Thread-331): Got an acceptable cached parse result
2021-03-30 16:33:40.420877 (Thread-331): Acquiring new bigquery connection "test.jaffle_shop.assert_positive_total_for_payments".
2021-03-30 16:33:40.786958 (Thread-332): handling status request
2021-03-30 16:33:40.787411 (Thread-332): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726276e20>]}
2021-03-30 16:33:40.788337 (Thread-332): sending response (<Response 770 bytes [200 OK]>) to 10.0.33.160
2021-03-30 16:33:44.617008 (MainThread): Connection 'test.jaffle_shop.assert_positive_total_for_payments' was properly closed.
2021-03-30 16:33:44.667168 (Thread-333): Got an acceptable cached parse result
2021-03-30 16:33:44.723623 (Thread-333): Acquiring new bigquery connection "test.jaffle_shop.assert_positive_total_for_payments".
2021-03-30 16:33:45.076105 (Thread-334): handling status request
2021-03-30 16:33:45.076542 (Thread-334): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725e3b6a0>]}
2021-03-30 16:33:45.077468 (Thread-334): sending response (<Response 770 bytes [200 OK]>) to 10.0.1.181
2021-03-30 16:33:55.699432 (Thread-335): handling status request
2021-03-30 16:33:55.699878 (Thread-335): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72675bbb0>]}
2021-03-30 16:33:55.700801 (Thread-335): sending response (<Response 770 bytes [200 OK]>) to 10.0.2.124
2021-03-30 16:33:55.706537 (Thread-336): handling status request
2021-03-30 16:33:55.706839 (Thread-336): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725e3bc10>]}
2021-03-30 16:33:55.733169 (Thread-336): sending response (<Response 770 bytes [200 OK]>) to 10.0.18.81
2021-03-30 16:33:56.258518 (Thread-337): handling cli_args request
2021-03-30 16:33:56.258940 (Thread-337): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725c61640>]}
2021-03-30 16:33:56.268263 (Thread-337): Connection 'test.jaffle_shop.assert_positive_total_for_payments' was properly closed.
2021-03-30 16:33:57.096671 (Thread-337): sending response (<Response 138 bytes [200 OK]>) to 10.0.26.97
2021-03-30 16:33:57.149337 (MainThread): Partial parsing not enabled
2021-03-30 16:33:57.150570 (MainThread): Parsing macros/adapters.sql
2021-03-30 16:33:57.198546 (MainThread): Parsing macros/etc.sql
2021-03-30 16:33:57.199951 (MainThread): Parsing macros/catalog.sql
2021-03-30 16:33:57.205914 (MainThread): Parsing macros/materializations/copy.sql
2021-03-30 16:33:57.210265 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 16:33:57.220049 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 16:33:57.232333 (MainThread): Parsing macros/materializations/seed.sql
2021-03-30 16:33:57.235111 (MainThread): Parsing macros/materializations/snapshot.sql
2021-03-30 16:33:57.236938 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 16:33:57.240393 (MainThread): Parsing macros/core.sql
2021-03-30 16:33:57.243994 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 16:33:57.252817 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 16:33:57.266765 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 16:33:57.268569 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 16:33:57.285066 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 16:33:57.312803 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 16:33:57.317725 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 16:33:57.323908 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 16:33:57.344140 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 16:33:57.350724 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 16:33:57.352564 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 16:33:57.358478 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 16:33:57.360129 (MainThread): Parsing macros/etc/query.sql
2021-03-30 16:33:57.361220 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 16:33:57.369896 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 16:33:57.370878 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 16:33:57.372552 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 16:33:57.374569 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 16:33:57.376148 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 16:33:57.378844 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 16:33:57.380740 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 16:33:57.382546 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 16:33:57.429882 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-30 16:33:57.429986 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b7aa4f72-5bc4-4d6c-903c-c74be14353b4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effc0973b50>]}
2021-03-30 16:33:57.432978 (MainThread): Partial parsing not enabled
2021-03-30 16:33:57.483360 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 16:33:57.500997 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-03-30 16:33:57.508377 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-03-30 16:33:57.515717 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 16:33:57.526879 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-03-30 16:33:57.546508 (Thread-338): handling poll request
2021-03-30 16:33:57.546931 (Thread-338): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725ff2340>]}
2021-03-30 16:33:57.551541 (Thread-338): sending response (<Response 12268 bytes [200 OK]>) to 10.0.1.181
2021-03-30 16:33:57.547038 (MainThread): Acquiring new bigquery connection "test.jaffle_shop.assert_positive_total_for_payments".
2021-03-30 16:33:57.796411 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:33:57.797218 (MainThread): 
2021-03-30 16:33:57.797495 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 16:33:57.808207 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome_maxm".
2021-03-30 16:33:57.808317 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-03-30 16:33:57.992879 (MainThread): 16:33:57 | Concurrency: 1 threads (target='default')
2021-03-30 16:33:57.993010 (MainThread): 16:33:57 | 
2021-03-30 16:33:57.995160 (Thread-1): Began running node test.jaffle_shop.assert_positive_total_for_payments
2021-03-30 16:33:57.995340 (Thread-1): 16:33:57 | 1 of 1 START test assert_positive_total_for_payments................. [RUN]
2021-03-30 16:33:57.995563 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.assert_positive_total_for_payments".
2021-03-30 16:33:57.995642 (Thread-1): Compiling test.jaffle_shop.assert_positive_total_for_payments
2021-03-30 16:33:58.012402 (Thread-1): Writing injected SQL for node "test.jaffle_shop.assert_positive_total_for_payments"
2021-03-30 16:33:58.034297 (Thread-1): finished collecting timing info
2021-03-30 16:33:58.034572 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 16:33:58.034931 (Thread-1): On test.jaffle_shop.assert_positive_total_for_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.assert_positive_total_for_payments"} */

with dbt__CTE__INTERNAL_test as (
-- Refunds have a negative amount, so the total amount should always be >= 0.
-- Therefore return records where this isn't true to make the test fail.
select
    order_id,
    sum(amount) as total_amount
from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
group by 1
having not(total_amount >= 0)
)select count(*) from dbt__CTE__INTERNAL_test
2021-03-30 16:33:59.080771 (Thread-339): handling poll request
2021-03-30 16:33:59.081210 (Thread-339): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725b58700>]}
2021-03-30 16:33:59.083399 (Thread-339): sending response (<Response 6734 bytes [200 OK]>) to 10.0.15.161
2021-03-30 16:33:59.093389 (Thread-1): finished collecting timing info
2021-03-30 16:33:59.093975 (Thread-1): 16:33:59 | 1 of 1 PASS assert_positive_total_for_payments....................... [PASS in 1.10s]
2021-03-30 16:33:59.094057 (Thread-1): Finished running node test.jaffle_shop.assert_positive_total_for_payments
2021-03-30 16:33:59.095453 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 16:33:59.095690 (MainThread): 16:33:59 | 
2021-03-30 16:33:59.095752 (MainThread): 16:33:59 | Finished running 1 test in 1.30s.
2021-03-30 16:33:59.095804 (MainThread): Connection 'master' was properly closed.
2021-03-30 16:33:59.095846 (MainThread): Connection 'test.jaffle_shop.assert_positive_total_for_payments' was properly closed.
2021-03-30 16:33:59.118956 (MainThread): 
2021-03-30 16:33:59.119089 (MainThread): Completed successfully
2021-03-30 16:33:59.119149 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-03-30 16:34:00.547793 (Thread-340): handling poll request
2021-03-30 16:34:00.548235 (Thread-340): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725c61730>]}
2021-03-30 16:34:00.553133 (Thread-340): sending response (<Response 7277 bytes [200 OK]>) to 10.0.3.45
2021-03-30 16:34:01.051366 (Thread-341): handling status request
2021-03-30 16:34:01.051798 (Thread-341): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7274c9bb0>]}
2021-03-30 16:34:01.052743 (Thread-341): sending response (<Response 770 bytes [200 OK]>) to 10.0.27.42
2021-03-30 16:36:31.780286 (Thread-342): Got an acceptable cached parse result
2021-03-30 16:36:31.999231 (Thread-342): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 16:36:31.999571 (Thread-342): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 16:36:32.170108 (Thread-343): handling status request
2021-03-30 16:36:32.170537 (Thread-343): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725d45dc0>]}
2021-03-30 16:36:32.171520 (Thread-343): sending response (<Response 1215 bytes [200 OK]>) to 10.0.22.23
2021-03-30 16:36:40.395060 (Thread-344): handling status request
2021-03-30 16:36:40.395583 (Thread-345): handling status request
2021-03-30 16:36:40.396048 (Thread-344): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726061a00>]}
2021-03-30 16:36:40.397298 (Thread-344): sending response (<Response 1215 bytes [200 OK]>) to 10.0.34.79
2021-03-30 16:36:40.397461 (Thread-345): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725b46af0>]}
2021-03-30 16:36:40.398750 (Thread-345): sending response (<Response 1215 bytes [200 OK]>) to 10.0.37.31
2021-03-30 16:36:40.905918 (Thread-346): handling cli_args request
2021-03-30 16:36:40.906347 (Thread-346): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725b3f400>]}
2021-03-30 16:36:41.778770 (Thread-346): sending response (<Response 138 bytes [200 OK]>) to 10.0.3.45
2021-03-30 16:36:41.808791 (MainThread): Partial parsing not enabled
2021-03-30 16:36:41.810026 (MainThread): Parsing macros/adapters.sql
2021-03-30 16:36:41.860794 (MainThread): Parsing macros/etc.sql
2021-03-30 16:36:41.862234 (MainThread): Parsing macros/catalog.sql
2021-03-30 16:36:41.868154 (MainThread): Parsing macros/materializations/copy.sql
2021-03-30 16:36:41.872542 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 16:36:41.882291 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 16:36:41.895017 (MainThread): Parsing macros/materializations/seed.sql
2021-03-30 16:36:41.897729 (MainThread): Parsing macros/materializations/snapshot.sql
2021-03-30 16:36:41.899585 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 16:36:41.903101 (MainThread): Parsing macros/core.sql
2021-03-30 16:36:41.906694 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 16:36:41.915588 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 16:36:41.929347 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 16:36:41.931187 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 16:36:41.947844 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 16:36:41.975693 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 16:36:41.980674 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 16:36:41.986864 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 16:36:42.006993 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 16:36:42.013531 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 16:36:42.015409 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 16:36:42.021345 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 16:36:42.022994 (MainThread): Parsing macros/etc/query.sql
2021-03-30 16:36:42.024099 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 16:36:42.032745 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 16:36:42.033765 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 16:36:42.035437 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 16:36:42.037412 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 16:36:42.038980 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 16:36:42.041633 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 16:36:42.043596 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 16:36:42.045366 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 16:36:42.093587 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-30 16:36:42.093719 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e7c8e9cd-bb64-4033-aa8f-008e4860cb55', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b47206400>]}
2021-03-30 16:36:42.096525 (MainThread): Partial parsing not enabled
2021-03-30 16:36:42.146081 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 16:36:42.162686 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-03-30 16:36:42.169715 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-03-30 16:36:42.176764 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 16:36:42.187492 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-03-30 16:36:42.207078 (MainThread): Acquiring new bigquery connection "test.jaffle_shop.assert_positive_total_for_payments".
2021-03-30 16:36:42.403428 (Thread-347): handling poll request
2021-03-30 16:36:42.403889 (Thread-347): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725b5efd0>]}
2021-03-30 16:36:42.408479 (Thread-347): sending response (<Response 12600 bytes [200 OK]>) to 10.0.33.160
2021-03-30 16:36:42.419250 (MainThread): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 16:36:42.419559 (MainThread): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 16:36:42.503250 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:36:42.503644 (MainThread): The selector 'customer_id' does not match any nodes and will be ignored
2021-03-30 16:36:42.504016 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-03-30 16:36:43.899416 (Thread-348): handling poll request
2021-03-30 16:36:43.899844 (Thread-348): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725b5e520>]}
2021-03-30 16:36:43.901263 (Thread-348): sending response (<Response 2148 bytes [200 OK]>) to 10.0.27.28
2021-03-30 16:36:44.564319 (Thread-349): handling status request
2021-03-30 16:36:44.564751 (Thread-349): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725b5e100>]}
2021-03-30 16:36:44.565803 (Thread-349): sending response (<Response 1215 bytes [200 OK]>) to 10.0.22.23
2021-03-30 16:50:35.706040 (Thread-350): Got an acceptable cached parse result
2021-03-30 16:50:36.057765 (Thread-350): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 16:50:36.058148 (Thread-350): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 16:50:36.107925 (Thread-351): handling status request
2021-03-30 16:50:36.108305 (Thread-351): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72668c3a0>]}
2021-03-30 16:50:36.109273 (Thread-351): sending response (<Response 1215 bytes [200 OK]>) to 10.0.5.204
2021-03-30 16:51:01.694656 (Thread-352): Got an acceptable cached parse result
2021-03-30 16:51:01.877224 (Thread-352): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 16:51:01.877648 (Thread-352): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 16:51:02.075518 (Thread-353): handling status request
2021-03-30 16:51:02.075967 (Thread-353): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7263b6a60>]}
2021-03-30 16:51:02.076994 (Thread-353): sending response (<Response 1215 bytes [200 OK]>) to 10.0.22.40
2021-03-30 16:52:09.311830 (Thread-354): Got an acceptable cached parse result
2021-03-30 16:52:09.528261 (Thread-354): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 16:52:09.528637 (Thread-354): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 16:52:09.764708 (Thread-355): handling status request
2021-03-30 16:52:09.765435 (Thread-355): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267568b0>]}
2021-03-30 16:52:09.766944 (Thread-355): sending response (<Response 1215 bytes [200 OK]>) to 10.0.2.124
2021-03-30 16:53:12.984688 (Thread-356): Got an acceptable cached parse result
2021-03-30 16:53:13.198825 (Thread-356): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 16:53:13.199148 (Thread-356): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 16:53:13.396197 (Thread-357): handling status request
2021-03-30 16:53:13.396620 (Thread-357): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7273553d0>]}
2021-03-30 16:53:13.397611 (Thread-357): sending response (<Response 1215 bytes [200 OK]>) to 10.0.7.248
2021-03-30 16:54:38.847360 (Thread-358): Got an acceptable cached parse result
2021-03-30 16:54:39.182533 (Thread-358): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 16:54:39.182928 (Thread-358): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 16:54:39.226509 (Thread-359): handling status request
2021-03-30 16:54:39.226891 (Thread-359): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267d1430>]}
2021-03-30 16:54:39.227849 (Thread-359): sending response (<Response 1215 bytes [200 OK]>) to 10.0.27.42
2021-03-30 16:55:06.504052 (Thread-360): Got an acceptable cached parse result
2021-03-30 16:55:06.676799 (Thread-360): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 16:55:06.677174 (Thread-360): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 16:55:06.922530 (Thread-361): handling status request
2021-03-30 16:55:06.922959 (Thread-361): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7273f77c0>]}
2021-03-30 16:55:06.923970 (Thread-361): sending response (<Response 1215 bytes [200 OK]>) to 10.0.34.79
2021-03-30 16:55:46.024996 (Thread-362): Got an acceptable cached parse result
2021-03-30 16:55:46.452153 (Thread-363): handling status request
2021-03-30 16:55:46.452809 (Thread-363): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725d89190>]}
2021-03-30 16:55:46.454152 (Thread-363): sending response (<Response 999 bytes [200 OK]>) to 10.0.27.28
2021-03-30 16:55:57.027782 (Thread-364): Got an acceptable cached parse result
2021-03-30 16:55:57.452835 (Thread-365): handling status request
2021-03-30 16:55:57.453286 (Thread-365): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725b51280>]}
2021-03-30 16:55:57.454190 (Thread-365): sending response (<Response 998 bytes [200 OK]>) to 10.0.33.160
2021-03-30 16:56:35.012646 (Thread-366): Got an acceptable cached parse result
2021-03-30 16:56:35.382319 (Thread-366): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 16:56:35.382690 (Thread-366): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 16:56:35.514866 (Thread-367): handling status request
2021-03-30 16:56:35.515300 (Thread-367): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725c0f9a0>]}
2021-03-30 16:56:35.516302 (Thread-367): sending response (<Response 1215 bytes [200 OK]>) to 10.0.26.97
2021-03-30 16:57:19.508173 (Thread-368): handling status request
2021-03-30 16:57:19.508618 (Thread-368): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725e810a0>]}
2021-03-30 16:57:19.509602 (Thread-368): sending response (<Response 1215 bytes [200 OK]>) to 10.0.26.97
2021-03-30 16:57:19.604720 (Thread-369): handling status request
2021-03-30 16:57:19.605158 (Thread-369): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725e81b50>]}
2021-03-30 16:57:19.606169 (Thread-369): sending response (<Response 1215 bytes [200 OK]>) to 10.0.26.97
2021-03-30 16:57:20.318036 (Thread-370): handling docs.generate request
2021-03-30 16:57:20.318465 (Thread-370): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725e81220>]}
2021-03-30 16:57:21.210579 (Thread-370): sending response (<Response 138 bytes [200 OK]>) to 10.0.27.42
2021-03-30 16:57:21.281749 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2021-03-30 16:57:21.282953 (MainThread): 
2021-03-30 16:57:21.283290 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 16:57:21.298412 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome_maxm".
2021-03-30 16:57:21.298538 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 16:57:21.544739 (MainThread): 16:57:21 | Concurrency: 1 threads (target='default')
2021-03-30 16:57:21.544867 (MainThread): 16:57:21 | 
2021-03-30 16:57:21.546909 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-03-30 16:57:21.547096 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-03-30 16:57:21.547170 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-03-30 16:57:21.569517 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-03-30 16:57:21.589137 (Thread-1): finished collecting timing info
2021-03-30 16:57:21.589423 (Thread-1): finished collecting timing info
2021-03-30 16:57:21.589623 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-03-30 16:57:21.589741 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-03-30 16:57:21.589831 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-03-30 16:57:21.589893 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-03-30 16:57:21.595436 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-03-30 16:57:21.614932 (Thread-1): finished collecting timing info
2021-03-30 16:57:21.615196 (Thread-1): finished collecting timing info
2021-03-30 16:57:21.615390 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-03-30 16:57:21.615479 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-03-30 16:57:21.615564 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 16:57:21.615623 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-03-30 16:57:21.621598 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-03-30 16:57:21.640631 (Thread-1): finished collecting timing info
2021-03-30 16:57:21.640884 (Thread-1): finished collecting timing info
2021-03-30 16:57:21.641076 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-03-30 16:57:21.641165 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending
2021-03-30 16:57:21.641256 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending".
2021-03-30 16:57:21.641320 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending
2021-03-30 16:57:21.672482 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending"
2021-03-30 16:57:21.697627 (Thread-1): finished collecting timing info
2021-03-30 16:57:21.697943 (Thread-1): finished collecting timing info
2021-03-30 16:57:21.698144 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending
2021-03-30 16:57:21.698241 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-03-30 16:57:21.698335 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-03-30 16:57:21.698397 (Thread-1): Compiling model.jaffle_shop.fct_orders
2021-03-30 16:57:21.706529 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-03-30 16:57:21.724895 (Thread-1): finished collecting timing info
2021-03-30 16:57:21.725149 (Thread-1): finished collecting timing info
2021-03-30 16:57:21.725343 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-03-30 16:57:21.725437 (Thread-1): Began running node test.jaffle_shop.assert_positive_total_for_payments
2021-03-30 16:57:21.725527 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.assert_positive_total_for_payments".
2021-03-30 16:57:21.725588 (Thread-1): Compiling test.jaffle_shop.assert_positive_total_for_payments
2021-03-30 16:57:21.738588 (Thread-1): Writing injected SQL for node "test.jaffle_shop.assert_positive_total_for_payments"
2021-03-30 16:57:21.758584 (Thread-1): finished collecting timing info
2021-03-30 16:57:21.758887 (Thread-1): finished collecting timing info
2021-03-30 16:57:21.759093 (Thread-1): Finished running node test.jaffle_shop.assert_positive_total_for_payments
2021-03-30 16:57:21.759190 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-03-30 16:57:21.759284 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 16:57:21.759346 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-03-30 16:57:21.768541 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-03-30 16:57:21.793892 (Thread-1): finished collecting timing info
2021-03-30 16:57:21.794195 (Thread-1): finished collecting timing info
2021-03-30 16:57:21.794419 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-03-30 16:57:21.794533 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-03-30 16:57:21.794628 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2021-03-30 16:57:21.794694 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2021-03-30 16:57:21.806658 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2021-03-30 16:57:21.819402 (Thread-1): finished collecting timing info
2021-03-30 16:57:21.819645 (Thread-1): finished collecting timing info
2021-03-30 16:57:21.819836 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-03-30 16:57:21.819927 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2021-03-30 16:57:21.820011 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2021-03-30 16:57:21.820070 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2021-03-30 16:57:21.831705 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2021-03-30 16:57:21.834856 (Thread-371): handling poll request
2021-03-30 16:57:21.835286 (Thread-371): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7261483d0>]}
2021-03-30 16:57:21.843155 (Thread-371): sending response (<Response 29965 bytes [200 OK]>) to 10.0.27.28
2021-03-30 16:57:21.844416 (Thread-1): finished collecting timing info
2021-03-30 16:57:21.844658 (Thread-1): finished collecting timing info
2021-03-30 16:57:21.844851 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2021-03-30 16:57:21.845917 (MainThread): Connection 'master' was properly closed.
2021-03-30 16:57:21.846009 (MainThread): Connection 'test.jaffle_shop.unique_stg_customers_customer_id' was properly closed.
2021-03-30 16:57:21.905226 (MainThread): 16:57:21 | Done.
2021-03-30 16:57:21.992204 (MainThread): Acquiring new bigquery connection "generate_catalog".
2021-03-30 16:57:21.992350 (MainThread): 16:57:21 | Building catalog
2021-03-30 16:57:22.007928 (MainThread): Opening a new connection, currently in state init
2021-03-30 16:57:22.200448 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "finl-1067321-eds-thunderdome.information_schema".
2021-03-30 16:57:22.215940 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-03-30 16:57:22.216379 (ThreadPoolExecutor-1_0): On finl-1067321-eds-thunderdome.information_schema: 
    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `finl-1067321-eds-thunderdome`.`maxm`.__TABLES__
        where (upper(dataset_id) = upper('maxm'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `finl-1067321-eds-thunderdome`.`maxm`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `finl-1067321-eds-thunderdome`.`maxm`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-03-30 16:57:23.337097 (Thread-372): handling poll request
2021-03-30 16:57:23.337519 (Thread-372): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725c0e8e0>]}
2021-03-30 16:57:23.339451 (Thread-372): sending response (<Response 11330 bytes [200 OK]>) to 10.0.37.31
2021-03-30 16:57:24.823256 (Thread-373): handling poll request
2021-03-30 16:57:24.823704 (Thread-373): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725cdbb20>]}
2021-03-30 16:57:24.824587 (Thread-373): sending response (<Response 303 bytes [200 OK]>) to 10.0.15.161
2021-03-30 16:57:25.074952 (MainThread): 16:57:25 | Catalog written to /usr/src/develop/user-18991/environment-23989/repository-19333/target/catalog.json
2021-03-30 16:57:26.411952 (Thread-374): handling poll request
2021-03-30 16:57:26.412407 (Thread-374): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725d85ee0>]}
2021-03-30 16:57:26.415564 (Thread-374): sending response (<Response 4893 bytes [200 OK]>) to 10.0.27.28
2021-03-30 16:57:26.862420 (Thread-375): handling status request
2021-03-30 16:57:26.862861 (Thread-375): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725d8ab20>]}
2021-03-30 16:57:26.863901 (Thread-375): sending response (<Response 1215 bytes [200 OK]>) to 10.0.26.97
2021-03-30 17:04:31.595538 (Thread-376): Got an acceptable cached parse result
2021-03-30 17:04:31.817556 (Thread-376): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 17:04:31.818016 (Thread-376): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 17:04:31.990493 (Thread-377): handling status request
2021-03-30 17:04:31.990922 (Thread-377): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7260a3220>]}
2021-03-30 17:04:32.020571 (Thread-377): sending response (<Response 1215 bytes [200 OK]>) to 10.0.15.161
2021-03-30 17:04:57.282380 (Thread-378): Got an acceptable cached parse result
2021-03-30 17:04:57.496240 (Thread-378): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 17:04:57.496725 (Thread-378): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 17:04:57.802074 (Thread-379): handling status request
2021-03-30 17:04:57.802571 (Thread-379): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7274b6e20>]}
2021-03-30 17:04:57.803573 (Thread-379): sending response (<Response 1215 bytes [200 OK]>) to 10.0.18.81
2021-03-30 17:05:19.244875 (Thread-380): Got an acceptable cached parse result
2021-03-30 17:05:19.463104 (Thread-380): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 17:05:19.463512 (Thread-380): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 17:05:19.746629 (Thread-381): handling status request
2021-03-30 17:05:19.747180 (Thread-381): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7260a3040>]}
2021-03-30 17:05:19.748532 (Thread-381): sending response (<Response 1215 bytes [200 OK]>) to 10.0.33.81
2021-03-30 17:05:48.509248 (Thread-382): handling status request
2021-03-30 17:05:48.509695 (Thread-382): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7260a3c10>]}
2021-03-30 17:05:48.510726 (Thread-382): sending response (<Response 1215 bytes [200 OK]>) to 10.0.34.79
2021-03-30 17:05:48.961151 (Thread-383): handling compile_sql request
2021-03-30 17:05:48.961592 (Thread-383): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7261b7100>]}
2021-03-30 17:05:49.856807 (Thread-383): sending response (<Response 138 bytes [200 OK]>) to 10.0.3.45
2021-03-30 17:05:49.874056 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 17:05:49.928441 (MainThread): dbt runtime exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/task_handler.py", line 94, in task_exec
    result = self.task.handle_request()
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 162, in handle_request
    node = self._get_exec_node()
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 123, in _get_exec_node
    add_new_refs(
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 46, in add_new_refs
    process_node(config, manifest, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/manifest.py", line 728, in process_node
    _process_sources_for_node(
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/manifest.py", line 689, in _process_sources_for_node
    invalid_source_fail_unless_test(
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/manifest.py", line 406, in invalid_source_fail_unless_test
    source_target_not_found(
  File "/usr/local/lib/python3.8/dist-packages/dbt/exceptions.py", line 569, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/usr/local/lib/python3.8/dist-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in rpc request (from remote system)
  Rpc 'rpc.jaffle_shop.request' (from remote system) depends on a source named 'jaffle_shop.customers' which was not found
2021-03-30 17:05:50.397135 (Thread-384): handling poll request
2021-03-30 17:05:50.397615 (Thread-384): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7260a3220>]}
2021-03-30 17:05:50.398951 (Thread-384): sending response (<Response 2873 bytes [200 OK]>) to 10.0.34.79
2021-03-30 17:06:07.625980 (Thread-385): Got an acceptable cached parse result
2021-03-30 17:06:07.681416 (Thread-385): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 17:06:07.858280 (Thread-385): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 17:06:07.858681 (Thread-385): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 17:06:08.068833 (Thread-386): handling status request
2021-03-30 17:06:08.069268 (Thread-386): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727ff69d0>]}
2021-03-30 17:06:08.070532 (Thread-386): sending response (<Response 1517 bytes [200 OK]>) to 10.0.15.161
2021-03-30 17:06:09.060932 (Thread-387): handling status request
2021-03-30 17:06:09.061395 (Thread-387): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725b5a3a0>]}
2021-03-30 17:06:09.062579 (Thread-387): sending response (<Response 1517 bytes [200 OK]>) to 10.0.34.79
2021-03-30 17:06:09.555394 (Thread-388): handling compile_sql request
2021-03-30 17:06:09.555821 (Thread-388): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725b5aa60>]}
2021-03-30 17:06:09.557091 (Thread-388): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-03-30 17:06:10.560502 (Thread-388): sending response (<Response 138 bytes [200 OK]>) to 10.0.34.79
2021-03-30 17:06:10.579361 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 17:06:10.636832 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 2 sources
2021-03-30 17:06:10.637359 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 17:06:10.637471 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 17:06:10.654036 (Thread-1): finished collecting timing info
2021-03-30 17:06:10.654288 (Thread-1): finished collecting timing info
2021-03-30 17:06:11.248687 (Thread-389): handling poll request
2021-03-30 17:06:11.249213 (Thread-389): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725b5a550>]}
2021-03-30 17:06:11.255362 (Thread-389): sending response (<Response 4737 bytes [200 OK]>) to 10.0.2.124
2021-03-30 17:06:30.191246 (Thread-390): Got an acceptable cached parse result
2021-03-30 17:06:30.234813 (Thread-390): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-03-30 17:06:30.429419 (Thread-390): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 17:06:30.429803 (Thread-390): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 17:06:30.465266 (Thread-391): handling status request
2021-03-30 17:06:30.480403 (Thread-391): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725c0f3d0>]}
2021-03-30 17:06:30.482208 (Thread-391): sending response (<Response 1514 bytes [200 OK]>) to 10.0.1.181
2021-03-30 17:06:32.941449 (Thread-392): handling status request
2021-03-30 17:06:32.941978 (Thread-392): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725898850>]}
2021-03-30 17:06:32.943041 (Thread-392): sending response (<Response 1514 bytes [200 OK]>) to 10.0.27.42
2021-03-30 17:06:33.480483 (Thread-393): handling compile_sql request
2021-03-30 17:06:33.480902 (Thread-393): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725953e20>]}
2021-03-30 17:06:33.482149 (Thread-393): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-03-30 17:06:34.406339 (Thread-393): sending response (<Response 138 bytes [200 OK]>) to 10.0.34.79
2021-03-30 17:06:34.424195 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 17:06:34.479732 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 2 sources
2021-03-30 17:06:34.480219 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 17:06:34.480327 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 17:06:34.495826 (Thread-1): finished collecting timing info
2021-03-30 17:06:34.496070 (Thread-1): finished collecting timing info
2021-03-30 17:06:34.843756 (Thread-394): handling poll request
2021-03-30 17:06:34.844247 (Thread-394): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725835d60>]}
2021-03-30 17:06:34.849492 (Thread-394): sending response (<Response 4823 bytes [200 OK]>) to 10.0.15.161
2021-03-30 17:06:39.203519 (Thread-395): handling status request
2021-03-30 17:06:39.203956 (Thread-395): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267d05e0>]}
2021-03-30 17:06:39.205125 (Thread-395): sending response (<Response 1514 bytes [200 OK]>) to 10.0.2.124
2021-03-30 17:06:39.757844 (Thread-396): handling run_sql request
2021-03-30 17:06:39.758270 (Thread-396): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7258c5a30>]}
2021-03-30 17:06:40.632532 (Thread-396): sending response (<Response 138 bytes [200 OK]>) to 10.0.15.161
2021-03-30 17:06:40.649188 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 17:06:40.699778 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 2 sources
2021-03-30 17:06:40.700256 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-03-30 17:06:40.700363 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-30 17:06:40.716106 (Thread-1): finished collecting timing info
2021-03-30 17:06:40.716370 (Thread-1): Opening a new connection, currently in state init
2021-03-30 17:06:40.716776 (Thread-1): On rpc.jaffle_shop.request: select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from `finl-1067321-eds-thunderdome`.`maxm`.`orders`
limit 500
/* limit added automatically by dbt cloud */
2021-03-30 17:06:41.191823 (Thread-397): handling poll request
2021-03-30 17:06:41.192327 (Thread-397): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267a43a0>]}
2021-03-30 17:06:41.194507 (Thread-397): sending response (<Response 2747 bytes [200 OK]>) to 10.0.33.160
2021-03-30 17:06:42.167954 (Thread-1): finished collecting timing info
2021-03-30 17:06:42.708772 (Thread-398): handling poll request
2021-03-30 17:06:42.709204 (Thread-398): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725c0f8b0>]}
2021-03-30 17:06:42.713445 (Thread-398): sending response (<Response 7286 bytes [200 OK]>) to 10.0.34.79
2021-03-30 17:09:23.365944 (Thread-399): Got an acceptable cached parse result
2021-03-30 17:09:23.589350 (Thread-399): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 17:09:23.590388 (Thread-399): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 17:09:24.040621 (Thread-400): handling status request
2021-03-30 17:09:24.041055 (Thread-400): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727ff6f10>]}
2021-03-30 17:09:24.042143 (Thread-400): sending response (<Response 1215 bytes [200 OK]>) to 10.0.2.124
2021-03-30 17:09:55.382222 (Thread-401): Got an acceptable cached parse result
2021-03-30 17:09:55.613642 (Thread-401): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 17:09:55.614050 (Thread-401): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 17:09:55.767438 (Thread-402): handling status request
2021-03-30 17:09:55.767930 (Thread-402): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727541250>]}
2021-03-30 17:09:55.768920 (Thread-402): sending response (<Response 1215 bytes [200 OK]>) to 10.0.22.23
2021-03-30 17:10:04.581016 (Thread-403): Got an acceptable cached parse result
2021-03-30 17:10:04.996352 (Thread-403): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 17:10:04.996691 (Thread-403): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 17:10:05.091171 (Thread-404): handling status request
2021-03-30 17:10:05.091599 (Thread-404): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72633a190>]}
2021-03-30 17:10:05.092580 (Thread-404): sending response (<Response 1215 bytes [200 OK]>) to 10.0.33.160
2021-03-30 17:10:38.655726 (Thread-405): Got an acceptable cached parse result
2021-03-30 17:10:38.890956 (Thread-405): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 17:10:38.891303 (Thread-405): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 17:10:39.065386 (Thread-406): handling status request
2021-03-30 17:10:39.065870 (Thread-406): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267d1fd0>]}
2021-03-30 17:10:39.066906 (Thread-406): sending response (<Response 1215 bytes [200 OK]>) to 10.0.27.28
2021-03-30 17:10:41.440973 (Thread-407): handling status request
2021-03-30 17:10:41.441408 (Thread-407): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727374bb0>]}
2021-03-30 17:10:41.442455 (Thread-407): sending response (<Response 1215 bytes [200 OK]>) to 10.0.22.23
2021-03-30 17:10:41.492146 (Thread-408): handling status request
2021-03-30 17:10:41.492667 (Thread-408): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267d1dc0>]}
2021-03-30 17:10:41.494139 (Thread-408): sending response (<Response 1215 bytes [200 OK]>) to 10.0.42.64
2021-03-30 17:10:41.891501 (Thread-409): handling docs.generate request
2021-03-30 17:10:41.891950 (Thread-409): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267d1b80>]}
2021-03-30 17:10:42.757086 (Thread-409): sending response (<Response 138 bytes [200 OK]>) to 10.0.3.45
2021-03-30 17:10:42.794599 (MainThread): Found 5 models, 8 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 2 sources
2021-03-30 17:10:42.796048 (MainThread): 
2021-03-30 17:10:42.796379 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 17:10:42.857928 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome_maxm".
2021-03-30 17:10:42.858058 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 17:10:43.075549 (MainThread): 17:10:43 | Concurrency: 1 threads (target='default')
2021-03-30 17:10:43.075713 (MainThread): 17:10:43 | 
2021-03-30 17:10:43.077923 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-03-30 17:10:43.078100 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-03-30 17:10:43.078180 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-03-30 17:10:43.105024 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-03-30 17:10:43.124786 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.125121 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.125336 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-03-30 17:10:43.125435 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-03-30 17:10:43.125525 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-03-30 17:10:43.125595 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-03-30 17:10:43.131676 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-03-30 17:10:43.152889 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.153180 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.153381 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-03-30 17:10:43.153477 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-03-30 17:10:43.153566 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 17:10:43.153624 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-03-30 17:10:43.162951 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-03-30 17:10:43.182457 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.182761 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.182970 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-03-30 17:10:43.183072 (Thread-1): Began running node test.jaffle_shop.source_not_null_maxm_customers_id
2021-03-30 17:10:43.183204 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.source_not_null_maxm_customers_id".
2021-03-30 17:10:43.183273 (Thread-1): Compiling test.jaffle_shop.source_not_null_maxm_customers_id
2021-03-30 17:10:43.208822 (Thread-1): Writing injected SQL for node "test.jaffle_shop.source_not_null_maxm_customers_id"
2021-03-30 17:10:43.234370 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.234689 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.234894 (Thread-1): Finished running node test.jaffle_shop.source_not_null_maxm_customers_id
2021-03-30 17:10:43.234995 (Thread-1): Began running node test.jaffle_shop.source_not_null_maxm_orders_id
2021-03-30 17:10:43.235085 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.source_not_null_maxm_orders_id".
2021-03-30 17:10:43.235148 (Thread-1): Compiling test.jaffle_shop.source_not_null_maxm_orders_id
2021-03-30 17:10:43.244332 (Thread-1): Writing injected SQL for node "test.jaffle_shop.source_not_null_maxm_orders_id"
2021-03-30 17:10:43.257710 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.257978 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.258179 (Thread-1): Finished running node test.jaffle_shop.source_not_null_maxm_orders_id
2021-03-30 17:10:43.258277 (Thread-1): Began running node test.jaffle_shop.source_unique_maxm_customers_id
2021-03-30 17:10:43.258365 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.source_unique_maxm_customers_id".
2021-03-30 17:10:43.258427 (Thread-1): Compiling test.jaffle_shop.source_unique_maxm_customers_id
2021-03-30 17:10:43.270628 (Thread-1): Writing injected SQL for node "test.jaffle_shop.source_unique_maxm_customers_id"
2021-03-30 17:10:43.283300 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.283597 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.283800 (Thread-1): Finished running node test.jaffle_shop.source_unique_maxm_customers_id
2021-03-30 17:10:43.283900 (Thread-1): Began running node test.jaffle_shop.source_unique_maxm_orders_id
2021-03-30 17:10:43.283988 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.source_unique_maxm_orders_id".
2021-03-30 17:10:43.284050 (Thread-1): Compiling test.jaffle_shop.source_unique_maxm_orders_id
2021-03-30 17:10:43.293206 (Thread-1): Writing injected SQL for node "test.jaffle_shop.source_unique_maxm_orders_id"
2021-03-30 17:10:43.306024 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.306316 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.306521 (Thread-1): Finished running node test.jaffle_shop.source_unique_maxm_orders_id
2021-03-30 17:10:43.306622 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending
2021-03-30 17:10:43.306713 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending".
2021-03-30 17:10:43.306775 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending
2021-03-30 17:10:43.322932 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending"
2021-03-30 17:10:43.336636 (Thread-410): handling poll request
2021-03-30 17:10:43.337089 (Thread-410): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7263eabb0>]}
2021-03-30 17:10:43.345410 (Thread-410): sending response (<Response 26881 bytes [200 OK]>) to 10.0.37.31
2021-03-30 17:10:43.339269 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.339575 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.339783 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__placed__return_pending
2021-03-30 17:10:43.339884 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-03-30 17:10:43.339976 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-03-30 17:10:43.340037 (Thread-1): Compiling model.jaffle_shop.fct_orders
2021-03-30 17:10:43.348384 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-03-30 17:10:43.367758 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.368108 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.368320 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-03-30 17:10:43.368421 (Thread-1): Began running node test.jaffle_shop.assert_positive_total_for_payments
2021-03-30 17:10:43.368511 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.assert_positive_total_for_payments".
2021-03-30 17:10:43.368577 (Thread-1): Compiling test.jaffle_shop.assert_positive_total_for_payments
2021-03-30 17:10:43.384864 (Thread-1): Writing injected SQL for node "test.jaffle_shop.assert_positive_total_for_payments"
2021-03-30 17:10:43.404036 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.404388 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.404737 (Thread-1): Finished running node test.jaffle_shop.assert_positive_total_for_payments
2021-03-30 17:10:43.404914 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-03-30 17:10:43.405074 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 17:10:43.405186 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-03-30 17:10:43.419341 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-03-30 17:10:43.438603 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.438941 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.439151 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-03-30 17:10:43.439256 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-03-30 17:10:43.439348 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2021-03-30 17:10:43.439410 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2021-03-30 17:10:43.451195 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2021-03-30 17:10:43.469974 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.470426 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.470746 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-03-30 17:10:43.470898 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2021-03-30 17:10:43.471033 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2021-03-30 17:10:43.471130 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2021-03-30 17:10:43.485296 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2021-03-30 17:10:43.504906 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.505321 (Thread-1): finished collecting timing info
2021-03-30 17:10:43.505632 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2021-03-30 17:10:43.506807 (MainThread): Connection 'master' was properly closed.
2021-03-30 17:10:43.506918 (MainThread): Connection 'test.jaffle_shop.unique_stg_customers_customer_id' was properly closed.
2021-03-30 17:10:43.564332 (MainThread): 17:10:43 | Done.
2021-03-30 17:10:43.638475 (MainThread): Acquiring new bigquery connection "generate_catalog".
2021-03-30 17:10:43.638623 (MainThread): 17:10:43 | Building catalog
2021-03-30 17:10:43.664452 (MainThread): Opening a new connection, currently in state init
2021-03-30 17:10:43.855552 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "finl-1067321-eds-thunderdome.information_schema".
2021-03-30 17:10:43.871461 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-03-30 17:10:43.871908 (ThreadPoolExecutor-1_0): On finl-1067321-eds-thunderdome.information_schema: 
    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `finl-1067321-eds-thunderdome`.`maxm`.__TABLES__
        where (upper(dataset_id) = upper('maxm'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `finl-1067321-eds-thunderdome`.`maxm`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `finl-1067321-eds-thunderdome`.`maxm`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-03-30 17:10:44.879875 (Thread-411): handling poll request
2021-03-30 17:10:44.880423 (Thread-411): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267d1cd0>]}
2021-03-30 17:10:44.885772 (Thread-411): sending response (<Response 27568 bytes [200 OK]>) to 10.0.1.181
2021-03-30 17:10:46.453859 (Thread-412): handling poll request
2021-03-30 17:10:46.454288 (Thread-412): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725e66ee0>]}
2021-03-30 17:10:46.455168 (Thread-412): sending response (<Response 303 bytes [200 OK]>) to 10.0.37.31
2021-03-30 17:10:46.676984 (MainThread): 17:10:46 | Catalog written to /usr/src/develop/user-18991/environment-23989/repository-19333/target/catalog.json
2021-03-30 17:10:47.907348 (Thread-413): handling poll request
2021-03-30 17:10:47.907788 (Thread-413): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7267d18e0>]}
2021-03-30 17:10:47.911597 (Thread-413): sending response (<Response 6879 bytes [200 OK]>) to 10.0.22.23
2021-03-30 17:10:48.434259 (Thread-414): handling status request
2021-03-30 17:10:48.434692 (Thread-414): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727200a90>]}
2021-03-30 17:10:48.435683 (Thread-414): sending response (<Response 1215 bytes [200 OK]>) to 10.0.38.35
2021-03-30 17:15:24.629582 (Thread-415): Got an acceptable cached parse result
2021-03-30 17:15:24.908361 (Thread-415): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 17:15:24.908968 (Thread-415): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 17:15:25.061061 (Thread-416): handling status request
2021-03-30 17:15:25.061536 (Thread-416): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72598ee80>]}
2021-03-30 17:15:25.093487 (Thread-416): sending response (<Response 1215 bytes [200 OK]>) to 10.0.27.42
2021-03-30 17:23:38.324259 (Thread-417): handling status request
2021-03-30 17:23:38.326455 (Thread-417): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72598e1c0>]}
2021-03-30 17:23:38.327428 (Thread-417): sending response (<Response 1215 bytes [200 OK]>) to 10.0.42.64
2021-03-30 17:23:38.329357 (Thread-418): handling status request
2021-03-30 17:23:38.329648 (Thread-418): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72598edf0>]}
2021-03-30 17:23:38.330476 (Thread-418): sending response (<Response 1215 bytes [200 OK]>) to 10.0.42.64
2021-03-30 17:23:38.839187 (Thread-419): handling cli_args request
2021-03-30 17:23:38.839672 (Thread-419): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725d01a90>]}
2021-03-30 17:23:38.851391 (Thread-419): sending response (<Response 369 bytes [200 OK]>) to 10.0.18.81
2021-03-30 17:23:41.403336 (Thread-420): handling status request
2021-03-30 17:23:41.403913 (Thread-420): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725dd8310>]}
2021-03-30 17:23:41.405172 (Thread-420): sending response (<Response 1215 bytes [200 OK]>) to 10.0.37.31
2021-03-30 17:23:50.038496 (Thread-421): Got an acceptable cached parse result
2021-03-30 17:23:50.427712 (Thread-422): handling status request
2021-03-30 17:23:50.427939 (Thread-421): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 17:23:50.428319 (Thread-422): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb73733a550>]}
2021-03-30 17:23:50.428672 (Thread-421): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 17:23:50.429398 (Thread-422): sending response (<Response 185 bytes [200 OK]>) to 10.0.3.45
2021-03-30 17:23:52.462012 (Thread-423): handling status request
2021-03-30 17:23:52.462445 (Thread-423): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb73729d8e0>]}
2021-03-30 17:23:52.463580 (Thread-423): sending response (<Response 1215 bytes [200 OK]>) to 10.0.33.160
2021-03-30 17:24:26.810550 (Thread-424): handling status request
2021-03-30 17:24:26.810992 (Thread-424): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7259cf940>]}
2021-03-30 17:24:26.811983 (Thread-424): sending response (<Response 1215 bytes [200 OK]>) to 10.0.18.81
2021-03-30 17:24:26.815534 (Thread-425): handling status request
2021-03-30 17:24:26.815831 (Thread-425): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725cdeb80>]}
2021-03-30 17:24:26.816656 (Thread-425): sending response (<Response 1215 bytes [200 OK]>) to 10.0.22.23
2021-03-30 17:24:27.244624 (Thread-426): handling cli_args request
2021-03-30 17:24:27.245065 (Thread-426): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725bc4c10>]}
2021-03-30 17:24:28.103395 (Thread-426): sending response (<Response 138 bytes [200 OK]>) to 10.0.5.204
2021-03-30 17:24:28.185968 (MainThread): Partial parsing not enabled
2021-03-30 17:24:28.187201 (MainThread): Parsing macros/adapters.sql
2021-03-30 17:24:28.206709 (MainThread): Parsing macros/etc.sql
2021-03-30 17:24:28.208031 (MainThread): Parsing macros/catalog.sql
2021-03-30 17:24:28.213937 (MainThread): Parsing macros/materializations/copy.sql
2021-03-30 17:24:28.218262 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 17:24:28.228045 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 17:24:28.240447 (MainThread): Parsing macros/materializations/seed.sql
2021-03-30 17:24:28.243228 (MainThread): Parsing macros/materializations/snapshot.sql
2021-03-30 17:24:28.245060 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 17:24:28.248814 (MainThread): Parsing macros/core.sql
2021-03-30 17:24:28.252399 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 17:24:28.261204 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 17:24:28.274994 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 17:24:28.276781 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 17:24:28.292839 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 17:24:28.320484 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 17:24:28.325366 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 17:24:28.331465 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 17:24:28.351388 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 17:24:28.358084 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 17:24:28.359974 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 17:24:28.366073 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 17:24:28.367718 (MainThread): Parsing macros/etc/query.sql
2021-03-30 17:24:28.368821 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 17:24:28.377512 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 17:24:28.378507 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 17:24:28.380158 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 17:24:28.382130 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 17:24:28.383661 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 17:24:28.386369 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 17:24:28.388255 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 17:24:28.390027 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 17:24:28.437318 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-30 17:24:28.437452 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bcdc55ed-73ad-44c1-92a9-aae6e2556a2e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83598779d0>]}
2021-03-30 17:24:28.440400 (MainThread): Partial parsing not enabled
2021-03-30 17:24:28.491984 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 17:24:28.512301 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-03-30 17:24:28.523192 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-03-30 17:24:28.531845 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 17:24:28.547319 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-03-30 17:24:28.569960 (MainThread): Acquiring new bigquery connection "test.jaffle_shop.assert_positive_total_for_payments".
2021-03-30 17:24:28.581370 (Thread-427): handling poll request
2021-03-30 17:24:28.581949 (Thread-427): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725897ca0>]}
2021-03-30 17:24:28.587498 (Thread-427): sending response (<Response 12606 bytes [200 OK]>) to 10.0.5.204
2021-03-30 17:24:28.853343 (MainThread): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 17:24:28.853620 (MainThread): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 17:24:28.934386 (MainThread): Found 5 models, 8 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 2 sources
2021-03-30 17:24:28.935201 (MainThread): 
2021-03-30 17:24:28.935454 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 17:24:28.952430 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome_maxm".
2021-03-30 17:24:28.952559 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 17:24:29.168481 (MainThread): 17:24:29 | Concurrency: 1 threads (target='default')
2021-03-30 17:24:29.168611 (MainThread): 17:24:29 | 
2021-03-30 17:24:29.170586 (Thread-1): Began running node source.jaffle_shop.maxm.orders
2021-03-30 17:24:29.170744 (Thread-1): 17:24:29 | 1 of 1 START freshness of maxm.orders................................ [RUN]
2021-03-30 17:24:29.170960 (Thread-1): Acquiring new bigquery connection "source.jaffle_shop.maxm.orders".
2021-03-30 17:24:29.171040 (Thread-1): finished collecting timing info
2021-03-30 17:24:29.172411 (Thread-1): Acquiring new bigquery connection "source.jaffle_shop.maxm.orders".
2021-03-30 17:24:29.184981 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 17:24:29.185496 (Thread-1): On source.jaffle_shop.maxm.orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "source.jaffle_shop.maxm.orders"} */
select
      max(_etl_loaded_at) as max_loaded_at,
      CURRENT_TIMESTAMP() as snapshotted_at
    from `finl-1067321-eds-thunderdome`.`maxm`.`orders`
    
  
2021-03-30 17:24:29.647488 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: _etl_loaded_at at [3:11]')
2021-03-30 17:24:30.105179 (Thread-428): handling poll request
2021-03-30 17:24:30.105653 (Thread-428): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725ce2d00>]}
2021-03-30 17:24:30.107956 (Thread-428): sending response (<Response 6589 bytes [200 OK]>) to 10.0.42.64
2021-03-30 17:24:30.878532 (Thread-1): Unhandled error while running:
macro collect_freshness
2021-03-30 17:24:30.878662 (Thread-1): Database Error in source orders (models/staging/jaffle_shop/src_jaffle_shop.yml)
  Unrecognized name: _etl_loaded_at at [3:11]
2021-03-30 17:24:30.878940 (Thread-1): finished collecting timing info
2021-03-30 17:24:30.879322 (Thread-1): Database Error in source orders (models/staging/jaffle_shop/src_jaffle_shop.yml)
  Unrecognized name: _etl_loaded_at at [3:11]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 103, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 266, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 428, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 130, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Unrecognized name: _etl_loaded_at at [3:11]

(job ID: e5288c7b-daba-4d55-bdcf-904c5a4cbe88)

                                                         -----Query Job SQL Follows-----                                                         

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "source.jaffle_shop.maxm.orders"} */
   2:select
   3:      max(_etl_loaded_at) as max_loaded_at,
   4:      CURRENT_TIMESTAMP() as snapshotted_at
   5:    from `finl-1067321-eds-thunderdome`.`maxm`.`orders`
   6:    
   7:  
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/freshness.py", line 84, in execute
    freshness = self.adapter.calculate_freshness(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 1068, in calculate_freshness
    table = self.execute_macro(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 984, in execute_macro
    result = macro_function(**kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 25, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 275, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 268, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 442, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 107, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 95, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in source orders (models/staging/jaffle_shop/src_jaffle_shop.yml)
  Unrecognized name: _etl_loaded_at at [3:11]
2021-03-30 17:24:30.882359 (Thread-1): 17:24:30 | 1 of 1 ERROR freshness of maxm.orders................................ [ERROR in 1.71s]
2021-03-30 17:24:30.882449 (Thread-1): Finished running node source.jaffle_shop.maxm.orders
2021-03-30 17:24:30.883540 (MainThread): Connection 'master' was properly closed.
2021-03-30 17:24:30.883642 (MainThread): Connection 'source.jaffle_shop.maxm.orders' was properly closed.
2021-03-30 17:24:30.897539 (MainThread): 
2021-03-30 17:24:30.897645 (MainThread): Database Error in source orders (models/staging/jaffle_shop/src_jaffle_shop.yml)
2021-03-30 17:24:30.897716 (MainThread):   Unrecognized name: _etl_loaded_at at [3:11]
2021-03-30 17:24:30.897761 (MainThread): 17:24:30 | Done.
2021-03-30 17:24:31.626650 (Thread-429): handling poll request
2021-03-30 17:24:31.627085 (Thread-429): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7258c4610>]}
2021-03-30 17:24:31.631915 (Thread-429): sending response (<Response 12944 bytes [200 OK]>) to 10.0.33.160
2021-03-30 17:24:32.142507 (Thread-430): handling status request
2021-03-30 17:24:32.142954 (Thread-430): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7258c45e0>]}
2021-03-30 17:24:32.143986 (Thread-430): sending response (<Response 1215 bytes [200 OK]>) to 10.0.34.79
2021-03-30 17:26:24.880829 (Thread-431): Got an acceptable cached parse result
2021-03-30 17:26:25.110421 (Thread-431): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 17:26:25.110798 (Thread-431): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 17:26:25.256042 (Thread-432): handling status request
2021-03-30 17:26:25.256483 (Thread-432): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725a9ca60>]}
2021-03-30 17:26:25.257487 (Thread-432): sending response (<Response 1215 bytes [200 OK]>) to 10.0.7.248
2021-03-30 17:27:44.960177 (Thread-433): Got an acceptable cached parse result
2021-03-30 17:27:45.182074 (Thread-433): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 17:27:45.182400 (Thread-433): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 17:27:45.377607 (Thread-434): handling status request
2021-03-30 17:27:45.378126 (Thread-434): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726766d60>]}
2021-03-30 17:27:45.379129 (Thread-434): sending response (<Response 1215 bytes [200 OK]>) to 10.0.38.35
2021-03-30 17:27:57.434340 (Thread-435): Got an acceptable cached parse result
2021-03-30 17:27:57.480959 (Thread-435): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-03-30 17:27:57.667227 (Thread-435): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 17:27:57.667634 (Thread-435): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 17:27:57.803333 (Thread-436): handling status request
2021-03-30 17:27:57.803793 (Thread-436): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725e81a90>]}
2021-03-30 17:27:57.804927 (Thread-436): sending response (<Response 1516 bytes [200 OK]>) to 10.0.27.42
2021-03-30 17:28:29.623337 (MainThread): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-03-30 17:28:29.669037 (Thread-437): Got an acceptable cached parse result
2021-03-30 17:28:29.716621 (Thread-437): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-03-30 17:28:30.081484 (Thread-437): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 17:28:30.081846 (Thread-437): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 17:28:30.125335 (Thread-438): handling status request
2021-03-30 17:28:30.131050 (Thread-438): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725e850a0>]}
2021-03-30 17:28:30.132093 (Thread-438): sending response (<Response 1516 bytes [200 OK]>) to 10.0.15.122
2021-03-30 17:28:46.297526 (Thread-439): handling status request
2021-03-30 17:28:46.297983 (Thread-439): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726774490>]}
2021-03-30 17:28:46.299048 (Thread-439): sending response (<Response 1516 bytes [200 OK]>) to 10.0.29.13
2021-03-30 17:28:46.319360 (Thread-440): handling status request
2021-03-30 17:28:46.319679 (Thread-440): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725991ac0>]}
2021-03-30 17:28:46.320647 (Thread-440): sending response (<Response 1516 bytes [200 OK]>) to 10.0.39.85
2021-03-30 17:28:46.798088 (Thread-441): handling cli_args request
2021-03-30 17:28:46.798510 (Thread-441): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72587e100>]}
2021-03-30 17:28:46.807604 (Thread-441): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-03-30 17:28:47.641157 (Thread-441): sending response (<Response 138 bytes [200 OK]>) to 10.0.3.235
2021-03-30 17:28:47.693858 (MainThread): Partial parsing not enabled
2021-03-30 17:28:47.695140 (MainThread): Parsing macros/adapters.sql
2021-03-30 17:28:47.744301 (MainThread): Parsing macros/etc.sql
2021-03-30 17:28:47.745728 (MainThread): Parsing macros/catalog.sql
2021-03-30 17:28:47.752172 (MainThread): Parsing macros/materializations/copy.sql
2021-03-30 17:28:47.757150 (MainThread): Parsing macros/materializations/table.sql
2021-03-30 17:28:47.768139 (MainThread): Parsing macros/materializations/incremental.sql
2021-03-30 17:28:47.781772 (MainThread): Parsing macros/materializations/seed.sql
2021-03-30 17:28:47.784516 (MainThread): Parsing macros/materializations/snapshot.sql
2021-03-30 17:28:47.786377 (MainThread): Parsing macros/materializations/view.sql
2021-03-30 17:28:47.789866 (MainThread): Parsing macros/core.sql
2021-03-30 17:28:47.793437 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-30 17:28:47.802310 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-30 17:28:47.816074 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 17:28:47.817891 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 17:28:47.834020 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 17:28:47.862760 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 17:28:47.867728 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-30 17:28:47.874109 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-30 17:28:47.894778 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-30 17:28:47.901397 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 17:28:47.903372 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 17:28:47.909364 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-30 17:28:47.911052 (MainThread): Parsing macros/etc/query.sql
2021-03-30 17:28:47.912140 (MainThread): Parsing macros/etc/datetime.sql
2021-03-30 17:28:47.920799 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-30 17:28:47.921807 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-30 17:28:47.923467 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-30 17:28:47.925428 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-30 17:28:47.927004 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 17:28:47.929650 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-30 17:28:47.931586 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-30 17:28:47.933345 (MainThread): Parsing macros/adapters/common.sql
2021-03-30 17:28:47.980357 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-30 17:28:47.980473 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2daaa612-dc7a-4115-9066-08f6100d3eae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b43b5f700>]}
2021-03-30 17:28:47.983242 (MainThread): Partial parsing not enabled
2021-03-30 17:28:48.033317 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 17:28:48.051602 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-03-30 17:28:48.060586 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-03-30 17:28:48.074880 (Thread-442): handling poll request
2021-03-30 17:28:48.069262 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 17:28:48.075496 (Thread-442): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7373763a0>]}
2021-03-30 17:28:48.080330 (Thread-442): sending response (<Response 11959 bytes [200 OK]>) to 10.0.45.50
2021-03-30 17:28:48.079799 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-03-30 17:28:48.099713 (MainThread): Acquiring new bigquery connection "test.jaffle_shop.assert_positive_total_for_payments".
2021-03-30 17:28:48.360011 (MainThread): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 17:28:48.360295 (MainThread): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 17:28:48.439714 (MainThread): Found 5 models, 8 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 3 sources
2021-03-30 17:28:48.440725 (MainThread): 
2021-03-30 17:28:48.441003 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 17:28:48.447022 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome".
2021-03-30 17:28:48.447145 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-30 17:28:48.661229 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_finl-1067321-eds-thunderdome_maxm".
2021-03-30 17:28:48.661369 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-30 17:28:48.859685 (MainThread): 17:28:48 | Concurrency: 1 threads (target='default')
2021-03-30 17:28:48.859896 (MainThread): 17:28:48 | 
2021-03-30 17:28:48.862251 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-03-30 17:28:48.863224 (Thread-1): 17:28:48 | 1 of 5 START view model maxm.stg_orders.............................. [RUN]
2021-03-30 17:28:48.863458 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-03-30 17:28:48.863535 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-03-30 17:28:48.881815 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-03-30 17:28:48.902374 (Thread-1): finished collecting timing info
2021-03-30 17:28:48.932514 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-03-30 17:28:48.950477 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 17:28:48.950930 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from `finl-1067321-eds-thunderdome`.`maxm`.`orders`;


2021-03-30 17:28:49.546689 (Thread-443): handling poll request
2021-03-30 17:28:49.547190 (Thread-443): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7271a38b0>]}
2021-03-30 17:28:49.550142 (Thread-443): sending response (<Response 8230 bytes [200 OK]>) to 10.0.5.179
2021-03-30 17:28:50.137050 (Thread-1): finished collecting timing info
2021-03-30 17:28:50.137632 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2daaa612-dc7a-4115-9066-08f6100d3eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b43804ca0>]}
2021-03-30 17:28:50.138611 (Thread-1): 17:28:50 | 1 of 5 OK created view model maxm.stg_orders......................... [CREATE VIEW in 1.27s]
2021-03-30 17:28:50.138697 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-03-30 17:28:50.138803 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-03-30 17:28:50.139581 (Thread-1): 17:28:50 | 2 of 5 START view model maxm.stg_payments............................ [RUN]
2021-03-30 17:28:50.139782 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-03-30 17:28:50.139854 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-03-30 17:28:50.146905 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-03-30 17:28:50.164753 (Thread-1): finished collecting timing info
2021-03-30 17:28:50.168806 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-03-30 17:28:50.187926 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 17:28:50.188307 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
  OPTIONS()
  as select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,

    -- amount is stored in cents, convert it to dollars
    amount / 100 as amount,
    created as created_at

from `finl-1067321-eds-thunderdome`.`maxm`.`payments`;


2021-03-30 17:28:50.722984 (Thread-1): finished collecting timing info
2021-03-30 17:28:50.723621 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2daaa612-dc7a-4115-9066-08f6100d3eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b437fd8e0>]}
2021-03-30 17:28:50.724619 (Thread-1): 17:28:50 | 2 of 5 OK created view model maxm.stg_payments....................... [CREATE VIEW in 0.58s]
2021-03-30 17:28:50.724710 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-03-30 17:28:50.724818 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-03-30 17:28:50.725617 (Thread-1): 17:28:50 | 3 of 5 START view model maxm.stg_customers........................... [RUN]
2021-03-30 17:28:50.725845 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 17:28:50.725919 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-03-30 17:28:50.734977 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-03-30 17:28:50.752021 (Thread-1): finished collecting timing info
2021-03-30 17:28:50.756275 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-03-30 17:28:50.773874 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 17:28:50.774290 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`
  OPTIONS()
  as select 
    id as customer_id,
    first_name,
    last_name
from `finl-1067321-eds-thunderdome`.`maxm`.`customers`;


2021-03-30 17:28:50.975325 (Thread-444): handling poll request
2021-03-30 17:28:50.975813 (Thread-444): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7373e47c0>]}
2021-03-30 17:28:50.978798 (Thread-444): sending response (<Response 11740 bytes [200 OK]>) to 10.0.30.55
2021-03-30 17:28:51.357400 (Thread-1): finished collecting timing info
2021-03-30 17:28:51.358049 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2daaa612-dc7a-4115-9066-08f6100d3eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b43803490>]}
2021-03-30 17:28:51.359120 (Thread-1): 17:28:51 | 3 of 5 OK created view model maxm.stg_customers...................... [CREATE VIEW in 0.63s]
2021-03-30 17:28:51.359209 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-03-30 17:28:51.359318 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-03-30 17:28:51.360129 (Thread-1): 17:28:51 | 4 of 5 START view model maxm.fct_orders.............................. [RUN]
2021-03-30 17:28:51.360340 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-03-30 17:28:51.360414 (Thread-1): Compiling model.jaffle_shop.fct_orders
2021-03-30 17:28:51.369731 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-03-30 17:28:51.390696 (Thread-1): finished collecting timing info
2021-03-30 17:28:51.395061 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-03-30 17:28:51.412776 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 17:28:51.413154 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`fct_orders`
  OPTIONS()
  as with orders as  (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`
),

payments as (
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final;


2021-03-30 17:28:52.040790 (Thread-1): finished collecting timing info
2021-03-30 17:28:52.041411 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2daaa612-dc7a-4115-9066-08f6100d3eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b410c6fa0>]}
2021-03-30 17:28:52.042570 (Thread-1): 17:28:52 | 4 of 5 OK created view model maxm.fct_orders......................... [CREATE VIEW in 0.68s]
2021-03-30 17:28:52.042660 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-03-30 17:28:52.042768 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-03-30 17:28:52.043741 (Thread-1): 17:28:52 | 5 of 5 START view model maxm.dim_customers........................... [RUN]
2021-03-30 17:28:52.044063 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 17:28:52.044177 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-03-30 17:28:52.055142 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-03-30 17:28:52.075429 (Thread-1): finished collecting timing info
2021-03-30 17:28:52.079671 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-03-30 17:28:52.098220 (Thread-1): Opening a new connection, currently in state closed
2021-03-30 17:28:52.098562 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace view `finl-1067321-eds-thunderdome`.`maxm`.`dim_customers`
  OPTIONS()
  as with customers as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_customers`

),

orders as (

    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_orders`

),

payments as (
    
    select * from `finl-1067321-eds-thunderdome`.`maxm`.`stg_payments`
),

customer_orders as (

    select
        customer_id,
        order_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1,2

),

customer_payments as (
    
    select
        order_id,
        amount
    
    from payments
),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        sum(customer_payments.amount) as lifetime_value

    from customers

    left join customer_orders using (customer_id)
    left join customer_payments on customer_orders.order_id = customer_payments.order_id

    group by 1,2,3,4,5,6
)

select * from final;


2021-03-30 17:28:52.399754 (Thread-445): handling poll request
2021-03-30 17:28:52.400191 (Thread-445): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725985f70>]}
2021-03-30 17:28:52.403342 (Thread-445): sending response (<Response 13226 bytes [200 OK]>) to 10.0.2.229
2021-03-30 17:28:52.792825 (Thread-1): finished collecting timing info
2021-03-30 17:28:52.793460 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2daaa612-dc7a-4115-9066-08f6100d3eae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b41075850>]}
2021-03-30 17:28:52.794600 (Thread-1): 17:28:52 | 5 of 5 OK created view model maxm.dim_customers...................... [CREATE VIEW in 0.75s]
2021-03-30 17:28:52.794688 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-03-30 17:28:52.795889 (MainThread): Acquiring new bigquery connection "master".
2021-03-30 17:28:52.796153 (MainThread): 17:28:52 | 
2021-03-30 17:28:52.796218 (MainThread): 17:28:52 | Finished running 5 view models in 4.36s.
2021-03-30 17:28:52.796266 (MainThread): Connection 'master' was properly closed.
2021-03-30 17:28:52.796314 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-03-30 17:28:52.844248 (MainThread): 
2021-03-30 17:28:52.844363 (MainThread): Completed successfully
2021-03-30 17:28:52.844426 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-03-30 17:28:53.817099 (Thread-446): handling poll request
2021-03-30 17:28:53.817532 (Thread-446): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7257ef7f0>]}
2021-03-30 17:28:53.830986 (Thread-446): sending response (<Response 21409 bytes [200 OK]>) to 10.0.29.13
2021-03-30 17:28:54.254227 (Thread-447): handling status request
2021-03-30 17:28:54.254673 (Thread-447): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb73735c880>]}
2021-03-30 17:28:54.255786 (Thread-447): sending response (<Response 1516 bytes [200 OK]>) to 10.0.31.1
2021-03-30 17:31:47.660254 (Thread-448): handling status request
2021-03-30 17:31:47.662217 (Thread-448): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb73735c790>]}
2021-03-30 17:31:47.663266 (Thread-448): sending response (<Response 1516 bytes [200 OK]>) to 10.0.39.85
2021-03-30 17:31:52.372443 (Thread-449): Parsing macros/adapters.sql
2021-03-30 17:31:52.391489 (Thread-449): Parsing macros/etc.sql
2021-03-30 17:31:52.392803 (Thread-449): Parsing macros/catalog.sql
2021-03-30 17:31:52.398708 (Thread-449): Parsing macros/materializations/copy.sql
2021-03-30 17:31:52.403032 (Thread-449): Parsing macros/materializations/table.sql
2021-03-30 17:31:52.412711 (Thread-449): Parsing macros/materializations/incremental.sql
2021-03-30 17:31:52.425054 (Thread-449): Parsing macros/materializations/seed.sql
2021-03-30 17:31:52.427714 (Thread-449): Parsing macros/materializations/snapshot.sql
2021-03-30 17:31:52.429488 (Thread-449): Parsing macros/materializations/view.sql
2021-03-30 17:31:52.432941 (Thread-449): Parsing macros/core.sql
2021-03-30 17:31:52.436507 (Thread-449): Parsing macros/materializations/helpers.sql
2021-03-30 17:31:52.445313 (Thread-449): Parsing macros/materializations/common/merge.sql
2021-03-30 17:31:52.458967 (Thread-449): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 17:31:52.460737 (Thread-449): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 17:31:52.476891 (Thread-449): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 17:31:52.504844 (Thread-449): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 17:31:52.509787 (Thread-449): Parsing macros/materializations/view/view.sql
2021-03-30 17:31:52.515937 (Thread-449): Parsing macros/materializations/seed/seed.sql
2021-03-30 17:31:52.536123 (Thread-449): Parsing macros/materializations/table/table.sql
2021-03-30 17:31:52.542682 (Thread-449): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 17:31:52.544524 (Thread-449): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 17:31:52.550433 (Thread-449): Parsing macros/etc/is_incremental.sql
2021-03-30 17:31:52.552031 (Thread-449): Parsing macros/etc/query.sql
2021-03-30 17:31:52.553081 (Thread-449): Parsing macros/etc/datetime.sql
2021-03-30 17:31:52.561734 (Thread-449): Parsing macros/etc/get_custom_alias.sql
2021-03-30 17:31:52.562684 (Thread-449): Parsing macros/etc/get_custom_database.sql
2021-03-30 17:31:52.564318 (Thread-449): Parsing macros/etc/get_custom_schema.sql
2021-03-30 17:31:52.566485 (Thread-449): Parsing macros/schema_tests/not_null.sql
2021-03-30 17:31:52.568012 (Thread-449): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 17:31:52.570675 (Thread-449): Parsing macros/schema_tests/relationships.sql
2021-03-30 17:31:52.572540 (Thread-449): Parsing macros/schema_tests/unique.sql
2021-03-30 17:31:52.574275 (Thread-449): Parsing macros/adapters/common.sql
2021-03-30 17:31:52.659512 (Thread-449): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-03-30 17:31:52.669215 (Thread-449): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-03-30 17:31:52.678490 (Thread-449): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-03-30 17:31:52.687644 (Thread-449): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-03-30 17:31:52.698552 (Thread-449): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-03-30 17:31:52.709480 (Thread-449): Acquiring new bigquery connection "test.jaffle_shop.assert_positive_total_for_payments".
2021-03-30 17:31:52.776634 (Thread-450): handling status request
2021-03-30 17:31:52.797411 (Thread-450): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb726020040>]}
2021-03-30 17:31:52.813494 (Thread-450): sending response (<Response 185 bytes [200 OK]>) to 10.0.33.153
2021-03-30 17:31:52.928308 (Thread-449): WARNING: Found documentation for resource "customer_id" which was not found or is disabled
2021-03-30 17:31:52.928669 (Thread-449): [WARNING]: Test 'test.jaffle_shop.relationships_customer_id_customer_id__ref_stg_customers_' (models/staging/jaffle_shop/schema.yml) depends on a node named 'customer_id' which was not found
2021-03-30 17:31:54.742434 (Thread-451): handling status request
2021-03-30 17:31:54.742919 (Thread-451): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7259da820>]}
2021-03-30 17:31:54.747022 (Thread-451): sending response (<Response 11538 bytes [200 OK]>) to 10.0.16.224
2021-03-30 17:32:46.774096 (Thread-452): handling status request
2021-03-30 17:32:46.774736 (Thread-452): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725a03310>]}
2021-03-30 17:32:46.807179 (Thread-452): sending response (<Response 11538 bytes [200 OK]>) to 10.0.16.224
2021-03-30 17:32:55.698754 (Thread-453): handling status request
2021-03-30 17:32:55.699216 (Thread-453): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'edaa66b1-04f3-4a7f-a52f-1baf733a5c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb725a03850>]}
2021-03-30 17:32:55.702961 (Thread-453): sending response (<Response 11538 bytes [200 OK]>) to 10.0.31.51
2021-03-30 17:32:56.923931 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727ff1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb733b0df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727ff62e0>]}
2021-03-30 17:32:56.924360 (MainThread): Flushing usage events
2021-03-30 17:32:56.950400 (MainThread): Connection 'test.jaffle_shop.assert_positive_total_for_payments' was properly closed.
2021-03-30 17:32:56.952503 (MainThread): Runtime Error
  no dbt_project.yml found at expected path /usr/src/develop/user-18991/environment-23989/repository-19333/dbt_project.yml
2021-03-30 17:42:42.381933 (MainThread): Running with dbt=0.18.1
2021-03-30 17:42:42.548987 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-03-30 17:42:42.563749 (MainThread): Tracking: tracking
2021-03-30 17:42:42.563981 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b470f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b5af0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8afdf60a0>]}
2021-03-30 17:42:42.564321 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=14
2021-03-30 17:42:42.565553 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-03-30 17:42:42.570996 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-03-30 17:42:42.584314 (Thread-1): Parsing macros/adapters.sql
2021-03-30 17:42:42.607360 (Thread-1): Parsing macros/etc.sql
2021-03-30 17:42:42.608694 (Thread-1): Parsing macros/catalog.sql
2021-03-30 17:42:42.614897 (Thread-1): Parsing macros/materializations/copy.sql
2021-03-30 17:42:42.619583 (Thread-1): Parsing macros/materializations/table.sql
2021-03-30 17:42:42.629451 (Thread-1): Parsing macros/materializations/incremental.sql
2021-03-30 17:42:42.641887 (Thread-1): Parsing macros/materializations/seed.sql
2021-03-30 17:42:42.644579 (Thread-1): Parsing macros/materializations/snapshot.sql
2021-03-30 17:42:42.646439 (Thread-1): Parsing macros/materializations/view.sql
2021-03-30 17:42:42.649860 (Thread-1): Parsing macros/core.sql
2021-03-30 17:42:42.653326 (Thread-1): Parsing macros/materializations/helpers.sql
2021-03-30 17:42:42.662102 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-03-30 17:42:42.675839 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-30 17:42:42.677859 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-03-30 17:42:42.702371 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-30 17:42:42.752602 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-30 17:42:42.761451 (Thread-1): Parsing macros/materializations/view/view.sql
2021-03-30 17:42:42.771913 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-03-30 17:42:42.798575 (Thread-1): Parsing macros/materializations/table/table.sql
2021-03-30 17:42:42.806182 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-03-30 17:42:42.808025 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-03-30 17:42:42.813822 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-03-30 17:42:42.815518 (Thread-1): Parsing macros/etc/query.sql
2021-03-30 17:42:42.816606 (Thread-1): Parsing macros/etc/datetime.sql
2021-03-30 17:42:42.826777 (Thread-2): handling status request
2021-03-30 17:42:42.827011 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-03-30 17:42:42.827437 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6da20adf-73ce-4cbe-8913-3539d10c8966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8af358be0>]}
2021-03-30 17:42:42.830014 (Thread-2): sending response (<Response 185 bytes [200 OK]>) to 10.0.29.13
2021-03-30 17:42:42.830439 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-03-30 17:42:42.832674 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-03-30 17:42:42.834747 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-03-30 17:42:42.836251 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-03-30 17:42:42.839188 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-03-30 17:42:42.841028 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-03-30 17:42:42.842777 (Thread-1): Parsing macros/adapters/common.sql
2021-03-30 17:42:42.895607 (Thread-1): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-03-30 17:42:42.896027 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6da20adf-73ce-4cbe-8913-3539d10c8966', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8af357a30>]}
2021-03-30 17:42:43.180868 (Thread-1): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.marts.core
- models.jaffle_shop.staging

2021-03-30 17:42:44.723406 (Thread-3): handling status request
2021-03-30 17:42:44.723836 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6da20adf-73ce-4cbe-8913-3539d10c8966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8aeabaee0>]}
2021-03-30 17:42:44.727101 (Thread-3): sending response (<Response 10436 bytes [200 OK]>) to 10.0.34.197
2021-03-30 17:43:04.121210 (Thread-4): handling status request
2021-03-30 17:43:04.121646 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6da20adf-73ce-4cbe-8913-3539d10c8966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8aea9a5e0>]}
2021-03-30 17:43:04.124861 (Thread-4): sending response (<Response 10436 bytes [200 OK]>) to 10.0.31.51
